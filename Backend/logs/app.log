2025-02-13 08:18:58,766 - __main__ - INFO - [app.py:217] - Received SIGINT signal
2025-02-13 08:18:58,771 - __main__ - INFO - [app.py:202] - Initiating graceful shutdown...
2025-02-13 08:19:03,776 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 08:19:03,778 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 08:19:03,778 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 08:19:03,781 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 08:19:03,782 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 08:19:03,782 - __main__ - INFO - [app.py:206] - Graceful shutdown completed
2025-02-13 08:19:03,785 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 08:19:03,786 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 08:19:03,786 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 08:19:03,787 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 08:19:03,787 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 08:19:03,789 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 08:19:03,789 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 08:19:03,790 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 08:19:03,791 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 08:19:03,791 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 08:20:24,814 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-13 08:20:24,814 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-13 08:20:39,422 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-13 08:20:39,423 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:20:39,424 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:21:09,034 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:21:09,034 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:21:25,468 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:21:25,469 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:21:25,471 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-13 08:21:25,471 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:21:25,472 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:21:42,010 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:21:42,011 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:22:01,856 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:22:01,857 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 10.8GB available
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-13 08:22:01,860 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-13 08:23:40,754 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.52MB
2025-02-13 08:23:40,757 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.01s
2025-02-13 08:23:40,762 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-13 08:23:40,763 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 08:23:40,763 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpt54i42qf/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 08:23:47,042 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-13 08:23:47,043 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpt54i42qf/output.wav
2025-02-13 08:23:47,075 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 08:23:47,076 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 08:23:47,076 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.32s, Memory Change: 91.09MB
2025-02-13 08:23:47,076 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.32s
2025-02-13 08:23:49,509 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:23:49,513 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:24:08,938 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:24:08,939 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:24:14,149 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-13 08:24:14,150 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 08:24:14,150 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpksilchvr/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 08:24:20,149 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-13 08:24:20,151 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpksilchvr/output.wav
2025-02-13 08:24:20,199 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 08:24:20,200 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 08:24:20,200 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.05s, Memory Change: 29.12MB
2025-02-13 08:24:20,201 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.05s
2025-02-13 08:24:22,229 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:24:22,230 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:24:36,161 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:24:36,161 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:24:36,171 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request f596317f
2025-02-13 08:24:36,171 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 08:24:36,172 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 08:24:36,174 - services.translation_routes - INFO - [translation_routes.py:97] - Request f596317f: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpuwc11t8g.wav
2025-02-13 08:24:36,176 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-13 08:24:36,176 - services.translation_routes - INFO - [translation_routes.py:112] - Request f596317f: Beginning audio processing with diagnostics
2025-02-13 08:24:36,176 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpuwc11t8g.wav
2025-02-13 08:24:36,176 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:24:36,181 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-13 08:24:36,287 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:24:36,324 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 08:24:36,325 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:24:36,443 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:24:36,566 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:36,567 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:36,604 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:36,605 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:36,646 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:36,647 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:36,682 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:36,683 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:39,373 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: f596317f
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:24:39,374 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 08:24:39,374 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpuwc11t8g.wav
2025-02-13 08:24:39,374 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:24:39,377 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-13 08:24:39,440 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:24:39,463 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 08:24:39,463 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:24:39,573 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:24:39,914 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:39,916 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:39,971 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:39,972 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:39,998 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:39,998 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:40,023 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:24:40,023 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:24:42,457 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:24:42,458 - services.translation_routes - INFO - [translation_routes.py:153] - Request f596317f: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: True
                - Music Confidence: 0.355
                - Feature Scores:
                • Spectral Flatness: 0.175
                • Rhythm Regularity: 0.030
                • Bass Presence: 0.080
                • Temporal Stability: 0.070
                    
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.009
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 3.742
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 08:24:42,459 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.355
                    - Has Background Music Flag: True
                    - Selected Type: speech_only
                        
2025-02-13 08:24:42,459 - services.translation_routes - INFO - [translation_routes.py:165] - Request f596317f: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}, 'speech': {'consistency': 1.0, 'clarity': 3.009134430002693, 'background_noise': 5.0}}}
2025-02-13 08:24:42,459 - services.translation_routes - INFO - [translation_routes.py:167] - Request f596317f: Audio processed successfully
2025-02-13 08:24:42,522 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 08:24:44,766 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?is_from_webapp=1&sender_device=pc&web_id=7470222526028858902
2025-02-13 08:24:44,767 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-13 08:24:44,767 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyjxf341z/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '0978684630249590299'}}}
2025-02-13 08:24:48,885 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-13 08:24:48,888 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyjxf341z/output.wav
2025-02-13 08:24:48,894 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 08:24:48,895 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 08:24:48,895 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.13s, Memory Change: -1291.03MB
2025-02-13 08:24:48,895 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 4.13s
2025-02-13 08:24:50,611 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:24:50,613 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:25:04,868 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:25:04,869 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:25:08,082 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-13 08:25:08,083 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-13 08:25:08,083 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp2o51hvk/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '4434820747711599862'}}}
2025-02-13 08:25:11,485 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-13 08:25:11,487 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp2o51hvk/output.wav
2025-02-13 08:25:11,539 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 08:25:11,540 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 08:25:11,541 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.46s, Memory Change: 64.33MB
2025-02-13 08:25:11,541 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.46s
2025-02-13 08:25:14,312 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 08:25:14,313 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 08:25:25,440 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:25:25,441 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:25:46,700 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:25:46,701 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:25:46,702 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 994e3468
2025-02-13 08:25:46,703 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 08:25:46,703 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 08:25:46,706 - services.translation_routes - INFO - [translation_routes.py:97] - Request 994e3468: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyxizo1tr.wav
2025-02-13 08:25:46,707 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-13 08:25:46,707 - services.translation_routes - INFO - [translation_routes.py:112] - Request 994e3468: Beginning audio processing with diagnostics
2025-02-13 08:25:46,707 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyxizo1tr.wav
2025-02-13 08:25:46,707 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:25:46,711 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-13 08:25:46,790 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:25:46,808 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 08:25:46,808 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:25:46,940 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:25:47,083 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:47,085 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:47,131 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:47,131 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:47,177 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:47,178 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:47,226 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:47,226 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:51,560 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:25:51,561 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 08:25:51,561 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 08:25:51,561 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 08:25:51,561 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 994e3468
2025-02-13 08:25:51,562 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 08:25:51,562 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 08:25:51,562 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:25:51,562 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 08:25:51,562 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyxizo1tr.wav
2025-02-13 08:25:51,563 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:25:51,566 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-13 08:25:51,649 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:25:51,671 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 08:25:51,671 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:25:51,815 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:25:51,955 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:51,956 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:52,000 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:52,001 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:52,048 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:52,048 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:52,096 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:25:52,096 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:25:56,478 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:25:56,480 - services.translation_routes - INFO - [translation_routes.py:153] - Request 994e3468: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: False
                - Music Confidence: 0.209
                - Feature Scores:
                • Spectral Flatness: 0.084
                • Rhythm Regularity: 0.024
                • Bass Presence: 0.020
                • Temporal Stability: 0.081
                    
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.027
                - Background Noise: 4.327
                - Voice Consistency: 1.000
                    
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 14.912
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 08:25:56,480 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.209
                    - Has Background Music Flag: False
                    - Selected Type: speech_only
                        
2025-02-13 08:25:56,480 - services.translation_routes - INFO - [translation_routes.py:165] - Request 994e3468: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}, 'speech': {'consistency': 1.0, 'clarity': 3.027470416722832, 'background_noise': 4.326625974972339}}}
2025-02-13 08:25:56,480 - services.translation_routes - INFO - [translation_routes.py:167] - Request 994e3468: Audio processed successfully
2025-02-13 08:25:56,586 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 08:26:04,974 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:26:04,976 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:26:04,982 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 958bdc38
2025-02-13 08:26:04,983 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 08:26:04,983 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 08:26:04,985 - services.translation_routes - INFO - [translation_routes.py:97] - Request 958bdc38: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqn933qvy.wav
2025-02-13 08:26:04,993 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-13 08:26:04,993 - services.translation_routes - INFO - [translation_routes.py:112] - Request 958bdc38: Beginning audio processing with diagnostics
2025-02-13 08:26:04,993 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqn933qvy.wav
2025-02-13 08:26:04,994 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:26:04,997 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-13 08:26:05,039 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:26:05,055 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 08:26:05,055 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:26:05,083 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:26:05,097 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,098 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,104 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,104 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,111 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,112 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,119 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,120 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,440 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:26:05,441 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 08:26:05,441 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 08:26:05,441 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 08:26:05,441 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 958bdc38
2025-02-13 08:26:05,441 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 08:26:05,442 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 08:26:05,442 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:26:05,444 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 08:26:05,444 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqn933qvy.wav
2025-02-13 08:26:05,445 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:26:05,447 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-13 08:26:05,459 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:26:05,467 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 08:26:05,468 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:26:05,495 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:26:05,511 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,511 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,518 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,519 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,534 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,534 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,543 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:26:05,543 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:26:05,768 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:26:05,768 - services.translation_routes - INFO - [translation_routes.py:153] - Request 958bdc38: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: False
                - Music Confidence: 0.156
                - Feature Scores:
                • Spectral Flatness: 0.038
                • Rhythm Regularity: 0.024
                • Bass Presence: 0.040
                • Temporal Stability: 0.054
                    
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.012
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 7.498
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 08:26:05,768 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.156
                    - Has Background Music Flag: False
                    - Selected Type: speech_only
                        
2025-02-13 08:26:05,768 - services.translation_routes - INFO - [translation_routes.py:165] - Request 958bdc38: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}, 'speech': {'consistency': 1.0, 'clarity': 3.012101101788277, 'background_noise': 5.0}}}
2025-02-13 08:26:05,768 - services.translation_routes - INFO - [translation_routes.py:167] - Request 958bdc38: Audio processed successfully
2025-02-13 08:26:05,788 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 08:26:06,343 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 08:26:06,343 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 08:26:12,926 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-13 08:26:22,752 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-13 08:26:44,086 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-13 08:27:00,535 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 08:27:00,548 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:00,549 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:00,553 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:00,553 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:00,560 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:00,561 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:00,572 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:00,573 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:00,858 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 958bdc38
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.388
- Avg Amplitude: 0.048
- Rms Level: 0.076
- Crest Factor: 5.109
- Zero Crossings: 9376.000
- Silence Percentage: 12.391
- Clipping Points: 0.000
- Dynamic Range: 174.541

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.361
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.018
  - Temporal Flatness: 0.010

- Volume Metrics:
  - Volume Stability: 0.232
  - Volume Range: 219.460
  - Volume Variations: 0.047

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.029747135869668
- Background Noise: 3.043549572156405
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.6100253462791443, 'stability': 2.9525911808013916, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.504
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:27:00,859 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 08:27:00,860 - services.translation_routes - INFO - [translation_routes.py:307] - Request 958bdc38: Audio output processed successfully
2025-02-13 08:27:00,863 - services.translation_routes - INFO - [translation_routes.py:362] - Request 958bdc38: Response prepared successfully
2025-02-13 08:27:00,864 - services.translation_routes - INFO - [translation_routes.py:375] - Request 958bdc38 completed in 55.88s
2025-02-13 08:27:00,865 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 55.89s, Memory Change: 1774.61MB
2025-02-13 08:27:00,865 - __main__ - INFO - [app.py:278] - Request to /translate took 130.25s
2025-02-13 08:27:07,694 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 08:27:07,695 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 08:27:07,699 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 62395846
2025-02-13 08:27:07,700 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 08:27:07,700 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 08:27:07,704 - services.translation_routes - INFO - [translation_routes.py:97] - Request 62395846: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi_bhciud.wav
2025-02-13 08:27:07,705 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-13 08:27:07,705 - services.translation_routes - INFO - [translation_routes.py:112] - Request 62395846: Beginning audio processing with diagnostics
2025-02-13 08:27:07,705 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi_bhciud.wav
2025-02-13 08:27:07,705 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:27:07,711 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-13 08:27:07,804 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:27:07,830 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 08:27:07,830 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:27:07,964 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:27:08,121 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:08,121 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:08,170 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:08,171 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:08,215 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:08,215 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:08,264 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:08,264 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:09,722 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: [Musique épique, chanteuse et comédienne qui a fait de l'humour dans le monde entier en faisant du bruit d'un coup de poing sur son visage et ses doigts.]
2025-02-13 08:27:12,069 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:27:12,070 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 08:27:12,070 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 62395846
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:27:12,071 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 08:27:12,071 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi_bhciud.wav
2025-02-13 08:27:12,073 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 08:27:12,083 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-13 08:27:12,263 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 08:27:12,297 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 08:27:12,297 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 08:27:12,452 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 08:27:12,629 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:12,637 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:12,679 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:12,679 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:12,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:12,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:12,793 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:27:12,794 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:27:16,720 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:27:16,722 - services.translation_routes - INFO - [translation_routes.py:153] - Request 62395846: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: True
                - Music Confidence: 0.406
                - Feature Scores:
                • Spectral Flatness: 0.165
                • Rhythm Regularity: 0.027
                • Bass Presence: 0.145
                • Temporal Stability: 0.069
                    
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.009
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 2.072
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:57] - Content Type Decision: speech_only (High speech prominence)
2025-02-13 08:27:16,722 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.406
                    - Has Background Music Flag: True
                    - Selected Type: speech_only
                        
2025-02-13 08:27:16,722 - services.translation_routes - INFO - [translation_routes.py:165] - Request 62395846: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}, 'speech': {'consistency': 1.0, 'clarity': 3.008577188259245, 'background_noise': 5.0}}}
2025-02-13 08:27:16,722 - services.translation_routes - INFO - [translation_routes.py:167] - Request 62395846: Audio processed successfully
2025-02-13 08:27:16,853 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 08:27:26,539 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no hurricane willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-13 08:28:42,447 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 08:28:42,494 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:28:42,499 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:28:42,508 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:28:42,508 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:28:42,516 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:28:42,517 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:28:42,528 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:28:42,529 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:28:42,727 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:28:42,728 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 08:28:42,728 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: f596317f
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.544
- Avg Amplitude: 0.058
- Rms Level: 0.091
- Crest Factor: 5.971
- Zero Crossings: 10511.000
- Silence Percentage: 16.908
- Clipping Points: 0.000
- Dynamic Range: 390.990

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.254
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.293
  - Volume Range: 657.336
  - Volume Variations: 0.053

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0305184955429953
- Background Noise: 3.3883381561070225
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8141968250274658, 'stability': 3.2647011280059814, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.07702525705099106, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.583
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 08:28:42,729 - services.translation_routes - INFO - [translation_routes.py:307] - Request f596317f: Audio output processed successfully
2025-02-13 08:28:42,736 - services.translation_routes - INFO - [translation_routes.py:362] - Request f596317f: Response prepared successfully
2025-02-13 08:28:42,737 - services.translation_routes - INFO - [translation_routes.py:375] - Request f596317f completed in 246.57s
2025-02-13 08:28:42,739 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 246.57s, Memory Change: 2347.62MB
2025-02-13 08:28:42,739 - __main__ - INFO - [app.py:278] - Request to /translate took 293.23s
2025-02-13 08:29:03,027 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: hop along my little friends up with you windows toms going on ahead candles for the king down the west since the sun soon you will be broken when the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no horry willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-13 08:29:25,054 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: This photo doesn't make sense. There's a plane that takes you up in the air and it feels like the passengers are floating. My goal was to throw them all into the air when we were at the peak of the pharaoh, weightless and I would be floating around in the center of my work. We couldn't believe it. It's one of those things where I can describe it as much as I want, but until you experience it, there's nothing like it. That's why I felt captured the epitome of this project. A photo that on paper makes no fucking sense and shouldn't be possible.
2025-02-13 08:30:22,366 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: C'est une sorte de réalité irréaliste que j'ai capturé l'épitome de ce projet et c'est pourquoi cette photo qui sur papier fait pas de putain de sens et ne devrait pas être possible est 99 originaux.
2025-02-13 08:31:03,142 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 08:31:03,189 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:03,189 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:03,205 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:03,205 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:03,223 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:03,224 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:03,239 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:03,240 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:03,766 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 994e3468
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.634
- Avg Amplitude: 0.069
- Rms Level: 0.099
- Crest Factor: 6.379
- Zero Crossings: 32460.000
- Silence Percentage: 5.833
- Clipping Points: 0.000
- Dynamic Range: 74.039

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.203
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.448
  - Volume Range: 239.571
  - Volume Variations: 0.048

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0311644664549093
- Background Noise: 3.551744523512575
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.813215970993042, 'stability': 3.3210277557373047, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.06777185946702957, 'consistency': 0.0, 'distinction': 0.10342594981193542}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.516
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 08:31:03,767 - services.translation_routes - INFO - [translation_routes.py:307] - Request 994e3468: Audio output processed successfully
2025-02-13 08:31:03,777 - services.translation_routes - INFO - [translation_routes.py:362] - Request 994e3468: Response prepared successfully
2025-02-13 08:31:03,778 - services.translation_routes - INFO - [translation_routes.py:375] - Request 994e3468 completed in 317.08s
2025-02-13 08:31:03,780 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 317.08s, Memory Change: 959.83MB
2025-02-13 08:31:03,780 - __main__ - INFO - [app.py:278] - Request to /translate took 401.55s
2025-02-13 08:31:43,801 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 08:31:43,816 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:43,816 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:43,821 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:43,821 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:43,827 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:43,827 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:43,831 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 08:31:43,831 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 08:31:44,049 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 62395846
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.725
- Avg Amplitude: 0.056
- Rms Level: 0.092
- Crest Factor: 7.840
- Zero Crossings: 19712.000
- Silence Percentage: 12.698
- Clipping Points: 0.000
- Dynamic Range: 221.103

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.020
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.295
  - Volume Range: 449.250
  - Volume Variations: 0.053

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.023583453986775
- Background Noise: 4.136162112002128
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8653329610824585, 'stability': 3.430530548095703, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.0911245048046112}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.490
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 08:31:44,049 - services.translation_routes - INFO - [translation_routes.py:307] - Request 62395846: Audio output processed successfully
2025-02-13 08:31:44,053 - services.translation_routes - INFO - [translation_routes.py:362] - Request 62395846: Response prepared successfully
2025-02-13 08:31:44,054 - services.translation_routes - INFO - [translation_routes.py:375] - Request 62395846 completed in 276.35s
2025-02-13 08:31:44,055 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 276.36s, Memory Change: -3935.50MB
2025-02-13 08:31:44,055 - __main__ - INFO - [app.py:278] - Request to /translate took 389.74s
2025-02-13 09:27:27,054 - __main__ - INFO - [app.py:217] - Received SIGINT signal
2025-02-13 09:27:27,057 - __main__ - INFO - [app.py:202] - Initiating graceful shutdown...
2025-02-13 09:27:32,066 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 09:27:32,068 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 09:27:32,069 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 09:27:32,071 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 09:27:32,072 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 09:27:32,073 - __main__ - INFO - [app.py:206] - Graceful shutdown completed
2025-02-13 09:27:32,075 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 09:27:32,076 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 09:27:32,076 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 09:27:32,077 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 09:27:32,077 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 09:27:32,078 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-13 09:27:32,078 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-13 09:27:32,078 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-13 09:27:32,079 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 09:27:32,080 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-13 09:28:03,133 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-13 09:28:03,133 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-13 09:28:17,108 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-13 09:28:17,108 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:28:17,110 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:28:38,070 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:28:38,070 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:28:57,841 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:28:57,841 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:28:57,844 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-13 09:28:57,845 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:28:57,845 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:29:11,559 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:29:11,559 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:29:27,762 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:29:27,762 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 13.3GB available
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-13 09:29:27,766 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-13 09:30:41,389 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.22MB
2025-02-13 09:30:41,389 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-13 09:30:41,391 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-13 09:30:41,391 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 09:30:41,392 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpvv99e09j/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 09:30:47,554 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-13 09:30:47,556 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpvv99e09j/output.wav
2025-02-13 09:30:47,587 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 09:30:47,588 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 09:30:47,588 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.20s, Memory Change: 30.52MB
2025-02-13 09:30:47,588 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.20s
2025-02-13 09:30:48,789 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:30:48,791 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:30:59,703 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-13 09:30:59,703 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 09:30:59,704 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpfqo1q_r2/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 09:31:04,684 - services.audio_link_routes - ERROR - [audio_link_routes.py:175] - Download error for youtube: [0;31mERROR:[0m unable to download video data: HTTP Error 403: Forbidden
2025-02-13 09:31:04,685 - services.audio_link_routes - ERROR - [audio_link_routes.py:182] - youtube processing error: Unable to access this youtube content. Please check the URL and try again.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3492, in process_info
    success, real_download = self.dl(temp_filename, info_dict)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3212, in dl
    return fd.download(name, new_info, subtitle)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/common.py", line 464, in download
    ret = self.real_download(filename, info_dict)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/http.py", line 367, in real_download
    establish_connection()
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/http.py", line 118, in establish_connection
    ctx.data = self.ydl.urlopen(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 4175, in urlopen
    return self._request_director.send(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 117, in send
    response = handler.send(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_helper.py", line 208, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 340, in send
    return self._send(request)
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_requests.py", line 365, in _send
    raise HTTPError(res, redirect_loop=max_redirects_exceeded)
yt_dlp.networking.exceptions.HTTPError: HTTP Error 403: Forbidden

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 132, in handle_video_platform_url
    ydl.download([url])
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3618, in download
    self.__download_wrapper(self.extract_info)(
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3591, in wrapper
    res = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1793, in __extract_info
    return self.process_ie_result(ie_result, download, extra_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1852, in process_ie_result
    ie_result = self.process_video_result(ie_result, download=download)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3024, in process_video_result
    self.process_info(new_info)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 177, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3501, in process_info
    self.report_error(f'unable to download video data: {err}')
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m unable to download video data: HTTP Error 403: Forbidden

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 179, in handle_video_platform_url
    raise Exception(f"Unable to access this {platform} content. Please check the URL and try again.")
Exception: Unable to access this youtube content. Please check the URL and try again.
2025-02-13 09:31:04,690 - services.audio_link_routes - ERROR - [audio_link_routes.py:250] - Processing error: Unable to access this youtube content. Please check the URL and try again.
2025-02-13 09:31:04,691 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.99s, Memory Change: 41.66MB
2025-02-13 09:31:04,692 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 4.99s
2025-02-13 09:31:06,724 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:31:06,725 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:31:22,829 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:31:22,830 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:31:22,835 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 41bbe55b
2025-02-13 09:31:22,835 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 09:31:22,835 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 09:31:22,840 - services.translation_routes - INFO - [translation_routes.py:97] - Request 41bbe55b: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8by9e8k7.wav
2025-02-13 09:31:22,841 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-13 09:31:22,841 - services.translation_routes - INFO - [translation_routes.py:112] - Request 41bbe55b: Beginning audio processing with diagnostics
2025-02-13 09:31:22,841 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8by9e8k7.wav
2025-02-13 09:31:22,841 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:31:22,848 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-13 09:31:22,898 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:31:22,914 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 09:31:22,914 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:31:22,983 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:31:23,082 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:23,083 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:23,108 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:23,109 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:23,130 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:23,131 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:23,152 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:23,153 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:25,180 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 41bbe55b
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:31:25,180 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 09:31:25,181 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8by9e8k7.wav
2025-02-13 09:31:25,181 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:31:25,183 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-13 09:31:25,226 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:31:25,238 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 09:31:25,238 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:31:25,299 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:31:25,383 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:25,384 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:25,406 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:25,407 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:25,424 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:25,425 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:25,441 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:31:25,441 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:31:27,428 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:31:27,429 - services.translation_routes - INFO - [translation_routes.py:153] - Request 41bbe55b: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}, 'speech_vs_music': {'speech_prominence': 3.7421514162612395, 'speech_band_energy': 2.2290898016308347e-07, 'music_band_energy': 5.9467065938179076e-08}}
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: True
                - Music Confidence: 0.355
                - Feature Scores:
                • Spectral Flatness: 0.175
                • Rhythm Regularity: 0.030
                • Bass Presence: 0.080
                • Temporal Stability: 0.070
                    
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.009
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 3.742
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 09:31:27,430 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.355
                    - Has Background Music Flag: True
                    - Selected Type: speech_only
                        
2025-02-13 09:31:27,430 - services.translation_routes - INFO - [translation_routes.py:165] - Request 41bbe55b: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}, 'speech': {'consistency': 1.0, 'clarity': 3.009134430002693, 'background_noise': 5.0}}}
2025-02-13 09:31:27,430 - services.translation_routes - INFO - [translation_routes.py:167] - Request 41bbe55b: Audio processed successfully
2025-02-13 09:31:27,474 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 09:31:27,697 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-13 09:31:27,698 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 09:31:27,698 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpw0w7d9yz/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 09:31:33,222 - services.audio_link_routes - ERROR - [audio_link_routes.py:175] - Download error for youtube: [0;31mERROR:[0m unable to download video data: HTTP Error 403: Forbidden
2025-02-13 09:31:33,223 - services.audio_link_routes - ERROR - [audio_link_routes.py:182] - youtube processing error: Unable to access this youtube content. Please check the URL and try again.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3492, in process_info
    success, real_download = self.dl(temp_filename, info_dict)
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3212, in dl
    return fd.download(name, new_info, subtitle)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/common.py", line 464, in download
    ret = self.real_download(filename, info_dict)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/http.py", line 367, in real_download
    establish_connection()
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/downloader/http.py", line 118, in establish_connection
    ctx.data = self.ydl.urlopen(request)
               ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 4175, in urlopen
    return self._request_director.send(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 117, in send
    response = handler.send(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_helper.py", line 208, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 340, in send
    return self._send(request)
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_requests.py", line 365, in _send
    raise HTTPError(res, redirect_loop=max_redirects_exceeded)
yt_dlp.networking.exceptions.HTTPError: HTTP Error 403: Forbidden

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 132, in handle_video_platform_url
    ydl.download([url])
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3618, in download
    self.__download_wrapper(self.extract_info)(
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3591, in wrapper
    res = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1793, in __extract_info
    return self.process_ie_result(ie_result, download, extra_info)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1852, in process_ie_result
    ie_result = self.process_video_result(ie_result, download=download)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3024, in process_video_result
    self.process_info(new_info)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 177, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3501, in process_info
    self.report_error(f'unable to download video data: {err}')
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m unable to download video data: HTTP Error 403: Forbidden

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 179, in handle_video_platform_url
    raise Exception(f"Unable to access this {platform} content. Please check the URL and try again.")
Exception: Unable to access this youtube content. Please check the URL and try again.
2025-02-13 09:31:33,224 - services.audio_link_routes - ERROR - [audio_link_routes.py:250] - Processing error: Unable to access this youtube content. Please check the URL and try again.
2025-02-13 09:31:33,226 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 5.53s, Memory Change: 2450.45MB
2025-02-13 09:31:33,226 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 5.53s
2025-02-13 09:31:41,688 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-13 09:31:41,690 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-13 09:31:41,690 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmptj3bb0d0/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-13 09:31:47,827 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-13 09:31:47,829 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmptj3bb0d0/output.wav
2025-02-13 09:31:47,872 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 09:31:47,873 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 09:31:47,873 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.18s, Memory Change: 933.81MB
2025-02-13 09:31:47,873 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.19s
2025-02-13 09:31:50,793 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:31:50,794 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:32:10,821 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?is_from_webapp=1&sender_device=pc&web_id=7470222526028858902
2025-02-13 09:32:10,822 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-13 09:32:10,822 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpn6_d6sx6/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '9992090904557043544'}}}
2025-02-13 09:32:14,672 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:32:14,672 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:32:14,731 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-13 09:32:14,799 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpn6_d6sx6/output.wav
2025-02-13 09:32:14,814 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 09:32:14,815 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 09:32:14,816 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.00s, Memory Change: 59.30MB
2025-02-13 09:32:14,816 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 4.00s
2025-02-13 09:32:15,822 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:32:15,823 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:32:26,555 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-13 09:32:26,556 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-13 09:32:26,556 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1o5adlft/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '4295345071734338318'}}}
2025-02-13 09:32:28,137 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-13 09:32:30,029 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-13 09:32:30,032 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1o5adlft/output.wav
2025-02-13 09:32:30,089 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-13 09:32:30,091 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-13 09:32:30,092 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.54s, Memory Change: 1131.70MB
2025-02-13 09:32:30,092 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.54s
2025-02-13 09:32:33,857 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-13 09:32:33,859 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-13 09:32:49,844 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:32:49,845 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:32:49,849 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 66de7653
2025-02-13 09:32:49,850 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 09:32:49,850 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 09:32:49,856 - services.translation_routes - INFO - [translation_routes.py:97] - Request 66de7653: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpjkyniwfk.wav
2025-02-13 09:32:49,857 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-13 09:32:49,857 - services.translation_routes - INFO - [translation_routes.py:112] - Request 66de7653: Beginning audio processing with diagnostics
2025-02-13 09:32:49,858 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpjkyniwfk.wav
2025-02-13 09:32:49,858 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:32:49,868 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-13 09:32:49,970 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:32:49,996 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 09:32:49,996 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:32:50,158 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:32:50,310 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:50,311 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:50,370 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:50,370 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:50,427 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:50,428 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:50,492 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:50,493 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:54,740 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:32:54,740 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 09:32:54,741 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 09:32:54,741 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 09:32:54,741 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 66de7653
2025-02-13 09:32:54,741 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 09:32:54,741 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 09:32:54,742 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:32:54,742 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 09:32:54,742 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpjkyniwfk.wav
2025-02-13 09:32:54,742 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:32:54,746 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-13 09:32:54,832 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:32:54,853 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 09:32:54,853 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:32:55,006 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:32:55,073 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:32:55,073 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:32:55,394 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:55,395 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:55,449 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:55,450 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:55,502 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:55,503 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:55,555 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:32:55,555 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:32:59,841 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:32:59,842 - services.translation_routes - INFO - [translation_routes.py:153] - Request 66de7653: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}, 'speech_vs_music': {'speech_prominence': 14.912097505433316, 'speech_band_energy': 3.6031412946613273e-06, 'music_band_energy': 2.415253845811094e-07}}
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: False
                - Music Confidence: 0.209
                - Feature Scores:
                • Spectral Flatness: 0.084
                • Rhythm Regularity: 0.024
                • Bass Presence: 0.020
                • Temporal Stability: 0.081
                    
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.027
                - Background Noise: 4.327
                - Voice Consistency: 1.000
                    
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 14.912
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 09:32:59,842 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.209
                    - Has Background Music Flag: False
                    - Selected Type: speech_only
                        
2025-02-13 09:32:59,842 - services.translation_routes - INFO - [translation_routes.py:165] - Request 66de7653: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}, 'speech': {'consistency': 1.0, 'clarity': 3.027470416722832, 'background_noise': 4.326625974972339}}}
2025-02-13 09:32:59,842 - services.translation_routes - INFO - [translation_routes.py:167] - Request 66de7653: Audio processed successfully
2025-02-13 09:32:59,933 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 09:33:26,382 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: [Musique épique, chanteuse et comédienne qui a fait de l'humour dans le monde entier en faisant du bruit d'un coup de poing sur son visage et ses doigts.]
2025-02-13 09:33:37,520 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-13 09:33:37,526 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-13 09:34:00,139 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:34:00,143 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:34:00,150 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 358560fe
2025-02-13 09:34:00,152 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 09:34:00,152 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 09:34:00,154 - services.translation_routes - INFO - [translation_routes.py:97] - Request 358560fe: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu7a71etd.wav
2025-02-13 09:34:00,159 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-13 09:34:00,159 - services.translation_routes - INFO - [translation_routes.py:112] - Request 358560fe: Beginning audio processing with diagnostics
2025-02-13 09:34:00,159 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu7a71etd.wav
2025-02-13 09:34:00,159 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:34:00,163 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-13 09:34:00,189 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:34:00,204 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 09:34:00,204 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:34:00,225 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:34:00,258 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,262 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,268 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,268 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,275 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,275 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,281 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,282 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,556 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:34:00,558 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 09:34:00,558 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 09:34:00,558 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 09:34:00,559 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 358560fe
2025-02-13 09:34:00,559 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 09:34:00,559 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 09:34:00,559 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:34:00,559 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 09:34:00,559 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu7a71etd.wav
2025-02-13 09:34:00,560 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:34:00,561 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-13 09:34:00,571 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:34:00,576 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 09:34:00,576 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:34:00,588 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:34:00,601 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,601 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,607 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,607 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,616 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,616 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,623 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:00,623 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:00,822 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:34:00,823 - services.translation_routes - INFO - [translation_routes.py:153] - Request 358560fe: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: False
                - Music Confidence: 0.156
                - Feature Scores:
                • Spectral Flatness: 0.038
                • Rhythm Regularity: 0.024
                • Bass Presence: 0.040
                • Temporal Stability: 0.054
                    
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.012
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 7.498
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:63] - Content Type Decision: speech_only (Low music confidence)
2025-02-13 09:34:00,823 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.156
                    - Has Background Music Flag: False
                    - Selected Type: speech_only
                        
2025-02-13 09:34:00,823 - services.translation_routes - INFO - [translation_routes.py:165] - Request 358560fe: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}, 'speech': {'consistency': 1.0, 'clarity': 3.012101101788277, 'background_noise': 5.0}}}
2025-02-13 09:34:00,823 - services.translation_routes - INFO - [translation_routes.py:167] - Request 358560fe: Audio processed successfully
2025-02-13 09:34:00,854 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 09:34:13,047 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-13 09:34:24,960 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-13 09:34:24,960 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-13 09:34:24,962 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 4baed141
2025-02-13 09:34:24,962 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-13 09:34:24,963 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-13 09:34:24,968 - services.translation_routes - INFO - [translation_routes.py:97] - Request 4baed141: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8g58qsm3.wav
2025-02-13 09:34:24,969 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-13 09:34:24,969 - services.translation_routes - INFO - [translation_routes.py:112] - Request 4baed141: Beginning audio processing with diagnostics
2025-02-13 09:34:24,969 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8g58qsm3.wav
2025-02-13 09:34:24,970 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:34:24,979 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-13 09:34:25,087 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:34:25,113 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 09:34:25,114 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:34:25,307 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:34:25,468 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:25,469 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:25,524 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:25,524 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:25,577 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:25,578 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:25,634 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:25,635 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:29,138 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:34:29,138 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-13 09:34:29,138 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 4baed141
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:34:29,139 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-13 09:34:29,139 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8g58qsm3.wav
2025-02-13 09:34:29,140 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-13 09:34:29,146 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-13 09:34:29,262 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-13 09:34:29,285 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 09:34:29,285 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-13 09:34:29,441 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-13 09:34:29,598 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:29,599 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:29,673 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:29,675 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:29,715 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-13 09:34:29,901 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:29,902 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:29,957 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:29,958 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:31,105 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no hurricane willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-13 09:34:33,404 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:34:33,405 - services.translation_routes - INFO - [translation_routes.py:153] - Request 4baed141: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}, 'speech_vs_music': {'speech_prominence': 2.0717908827188602, 'speech_band_energy': 4.658984948946454e-07, 'music_band_energy': 2.2477718175650807e-07}}
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:26] - 
                Music Detection:
                - Has Background Music: True
                - Music Confidence: 0.406
                - Feature Scores:
                • Spectral Flatness: 0.165
                • Rhythm Regularity: 0.027
                • Bass Presence: 0.145
                • Temporal Stability: 0.069
                    
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:39] - 
                Audio Quality Metrics:
                - Audio Clarity: 3.009
                - Background Noise: 5.000
                - Voice Consistency: 1.000
                    
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:49] -     Speech vs Music Analysis:
                - Speech Prominence: 2.072
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:57] - Content Type Decision: speech_only (High speech prominence)
2025-02-13 09:34:33,405 - services.translation_strategy - INFO - [translation_strategy.py:66] -  Decision Factors:
                    - Music Confidence Threshold: 0.4
                    - Current Music Confidence: 0.406
                    - Has Background Music Flag: True
                    - Selected Type: speech_only
                        
2025-02-13 09:34:33,405 - services.translation_routes - INFO - [translation_routes.py:165] - Request 4baed141: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}, 'speech': {'consistency': 1.0, 'clarity': 3.008577188259245, 'background_noise': 5.0}}}
2025-02-13 09:34:33,405 - services.translation_routes - INFO - [translation_routes.py:167] - Request 4baed141: Audio processed successfully
2025-02-13 09:34:33,488 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-13 09:34:33,998 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 09:34:34,008 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:34,009 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:34,016 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:34,016 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:34,020 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:34,021 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:34,025 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:34:34,025 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:34:34,130 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 41bbe55b
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.458
- Avg Amplitude: 0.055
- Rms Level: 0.090
- Crest Factor: 5.073
- Zero Crossings: 3272.000
- Silence Percentage: 24.161
- Clipping Points: 0.000
- Dynamic Range: 931.835

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.366
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.022
  - Temporal Flatness: 0.012

- Volume Metrics:
  - Volume Stability: 0.194
  - Volume Range: 1102.777
  - Volume Variations: 0.057

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.035568274600454
- Background Noise: 3.0291372517789887
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.015808146446943283, 'stability': 0.04553036764264107, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.8300871849060059, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Weak nasal resonance. Stable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.561
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 1.000

Vowel Quality:
  - Quality Score: 0.005
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 09:34:34,131 - services.translation_routes - INFO - [translation_routes.py:307] - Request 41bbe55b: Audio output processed successfully
2025-02-13 09:34:34,135 - services.translation_routes - INFO - [translation_routes.py:362] - Request 41bbe55b: Response prepared successfully
2025-02-13 09:34:34,136 - services.translation_routes - INFO - [translation_routes.py:375] - Request 41bbe55b completed in 191.30s
2025-02-13 09:34:34,138 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 191.30s, Memory Change: 6400.91MB
2025-02-13 09:34:34,143 - __main__ - INFO - [app.py:278] - Request to /translate took 225.35s
2025-02-13 09:35:04,480 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 09:35:04,535 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:35:04,541 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:35:04,550 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:35:04,550 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:35:04,560 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:35:04,561 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:35:04,570 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:35:04,571 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:35:04,879 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:35:04,880 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 09:35:04,881 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 09:35:04,881 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 09:35:04,881 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 358560fe
2025-02-13 09:35:04,881 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 09:35:04,882 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 09:35:04,882 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.611
- Avg Amplitude: 0.053
- Rms Level: 0.087
- Crest Factor: 6.983
- Zero Crossings: 11998.000
- Silence Percentage: 13.303
- Clipping Points: 0.000
- Dynamic Range: 223.617

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.127
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.023
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.201
  - Volume Range: 274.718
  - Volume Variations: 0.055

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.02505005980528
- Background Noise: 3.793196809693062
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7309665083885193, 'stability': 3.378373861312866, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.11483476310968399, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.499
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:35:04,882 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 09:35:04,882 - services.translation_routes - INFO - [translation_routes.py:307] - Request 358560fe: Audio output processed successfully
2025-02-13 09:35:04,893 - services.translation_routes - INFO - [translation_routes.py:362] - Request 358560fe: Response prepared successfully
2025-02-13 09:35:04,894 - services.translation_routes - INFO - [translation_routes.py:375] - Request 358560fe completed in 64.74s
2025-02-13 09:35:04,896 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 64.75s, Memory Change: -2548.14MB
2025-02-13 09:35:04,897 - __main__ - INFO - [app.py:278] - Request to /translate took 169.08s
2025-02-13 09:35:57,790 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: hop along my little friends up with you windows toms going on ahead candles for the king down the west since the sun soon you will be broken when the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no horry willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-13 09:36:15,605 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: This photo doesn't make sense. There's a plane that takes you up in the air and it feels like the passengers are floating. My goal was to throw them all into the air when we were at the peak of the pharaoh, weightless and I would be floating around in the center of my work. We couldn't believe it. It's one of those things where I can describe it as much as I want, but until you experience it, there's nothing like it. That's why I felt captured the epitome of this project. A photo that on paper makes no fucking sense and shouldn't be possible.
2025-02-13 09:37:17,615 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: C'est une sorte de réalité irréaliste que j'ai capturé l'épitome de ce projet et c'est pourquoi cette photo qui sur papier fait pas de putain de sens et ne devrait pas être possible est 99 originaux.
2025-02-13 09:38:15,552 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 09:38:15,620 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:15,625 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:15,634 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:15,634 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:15,647 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:15,647 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:15,657 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:15,657 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:16,162 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 66de7653
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 09:38:16,163 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.810
- Avg Amplitude: 0.070
- Rms Level: 0.101
- Crest Factor: 8.056
- Zero Crossings: 33638.000
- Silence Percentage: 5.533
- Clipping Points: 0.000
- Dynamic Range: 71.868

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.454
  - Volume Range: 340.264
  - Volume Variations: 0.048

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0249525772913617
- Background Noise: 4.222585376953274
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8463017344474792, 'stability': 3.551039695739746, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.08594360202550888}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.529
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:38:16,164 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 09:38:16,164 - services.translation_routes - INFO - [translation_routes.py:307] - Request 66de7653: Audio output processed successfully
2025-02-13 09:38:16,174 - services.translation_routes - INFO - [translation_routes.py:362] - Request 66de7653: Response prepared successfully
2025-02-13 09:38:16,175 - services.translation_routes - INFO - [translation_routes.py:375] - Request 66de7653 completed in 326.33s
2025-02-13 09:38:16,176 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 326.33s, Memory Change: -5129.09MB
2025-02-13 09:38:16,177 - __main__ - INFO - [app.py:278] - Request to /translate took 385.38s
2025-02-13 09:38:44,594 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-13 09:38:44,603 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:44,604 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:44,607 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:44,607 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:44,610 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:44,611 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:44,614 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-13 09:38:44,614 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-13 09:38:44,717 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 4baed141
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.662
- Avg Amplitude: 0.052
- Rms Level: 0.093
- Crest Factor: 7.124
- Zero Crossings: 11053.000
- Silence Percentage: 17.074
- Clipping Points: 0.000
- Dynamic Range: 330.771

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.110
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.025
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.135
  - Volume Range: 369.891
  - Volume Variations: 0.061

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0260792230375038
- Background Noise: 3.849534168897417
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.6950502991676331, 'stability': 2.8295059204101562, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.269389808177948, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.502
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-13 09:38:44,717 - services.translation_routes - INFO - [translation_routes.py:307] - Request 4baed141: Audio output processed successfully
2025-02-13 09:38:44,721 - services.translation_routes - INFO - [translation_routes.py:362] - Request 4baed141: Response prepared successfully
2025-02-13 09:38:44,721 - services.translation_routes - INFO - [translation_routes.py:375] - Request 4baed141 completed in 259.76s
2025-02-13 09:38:44,725 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 259.76s, Memory Change: -6826.97MB
2025-02-13 09:38:44,725 - __main__ - INFO - [app.py:278] - Request to /translate took 370.88s
