2025-02-12 07:22:10,395 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-12 07:22:10,395 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-12 07:22:23,809 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-12 07:22:23,810 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 07:22:23,813 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 07:22:55,481 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 07:22:55,482 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 07:23:13,201 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 07:23:13,201 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 07:23:13,205 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-12 07:23:13,205 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 07:23:13,205 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 07:23:28,602 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 07:23:28,602 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 07:23:47,661 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 07:23:47,661 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 13.7GB available
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-12 07:23:47,664 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-12 07:24:38,205 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.20MB
2025-02-12 07:24:38,207 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 07:24:38,213 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-12 07:24:38,215 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 07:24:38,216 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqamhkeap/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 07:24:41,648 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 07:24:41,650 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqamhkeap/output.wav
2025-02-12 07:24:41,678 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 07:24:41,679 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 07:24:41,679 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.47s, Memory Change: 47.72MB
2025-02-12 07:24:41,679 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.47s
2025-02-12 07:24:46,869 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 07:24:46,871 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 07:25:04,652 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 07:25:04,655 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 07:25:20,955 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 07:25:20,956 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 07:25:20,959 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request cf6539f1
2025-02-12 07:25:20,959 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 07:25:20,959 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 07:25:20,960 - services.translation_routes - INFO - [translation_routes.py:97] - Request cf6539f1: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa5yisaeq.wav
2025-02-12 07:25:20,963 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-12 07:25:20,963 - services.translation_routes - INFO - [translation_routes.py:112] - Request cf6539f1: Beginning audio processing with diagnostics
2025-02-12 07:25:20,963 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa5yisaeq.wav
2025-02-12 07:25:20,963 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 07:25:20,967 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 07:25:21,025 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 07:25:21,047 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 07:25:21,047 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for spa
2025-02-12 07:25:21,047 - services.audio_processor - WARNING - [audio_processor.py:354] - No specific parameters for spa, using defaults
2025-02-12 07:25:21,115 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 07:25:21,210 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:21,213 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:21,230 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:21,231 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:21,248 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:21,248 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:21,266 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:21,267 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:23,250 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:161] - Spanish timing analysis failed: 'SpanishAnalyzer' object has no attribute '_find_syllable_boundaries'
2025-02-12 07:25:23,369 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:218] - Spanish vowel analysis failed: 'SpanishAnalyzer' object has no attribute '_analyze_vowel_formants'
2025-02-12 07:25:23,375 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:249] - Spanish stress analysis failed: 'SpanishAnalyzer' object has no attribute '_find_stress_peaks'
2025-02-12 07:25:23,375 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for spa
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: cf6539f1
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: spa
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: spa

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Phoneme Analysis:
  - Trilled R: {'features': {'modulation_rate': 3412.396290873597, 'strength': 1.4564002752304077}, 'strength': 1.0, 'regularity': 0.0, 'duration': -177.80774116675843, 'overall_quality': 0.5}
  - Interdental Theta: {'energy': 1.7171649932861328, 'consistency': -0.39795219898223877, 'spectral_shape': {'centroid': 0.4623025953769684, 'spread': 0.28357934951782227, 'quality': 0.7393616288900375}, 'quality': 0.6861914743979772}
  - Stop Consonants: {'voiceless_stops': {'strength': 1.0, 'precision': 0.9452079426034381, 'quality': 0.972603971301719}, 'voiced_stops': {'voicing': 0.1356859654188156, 'precision': 0.3153348105134042, 'quality': 0.2255103879661099}, 'overall_quality': 0.5990571796339145}

Syllable Timing:

Intonation Patterns:
  - Contour Patterns: {'mean_pitch': 187.02680422921776, 'pitch_variability': 0.333713884112371, 'rise_fall_ratio': 0.8202764976832523, 'quality': 0.666286115905472}
  - Melodic Features: {'range': 1.0, 'movement': 0.8990564683362993, 'quality': 0.9495282341681497}
  - Overall Quality: 0.808

Vowel Clarity:

Stress Patterns:
2025-02-12 07:25:23,376 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 07:25:23,377 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa5yisaeq.wav
2025-02-12 07:25:23,377 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 07:25:23,379 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 07:25:23,420 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 07:25:23,431 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 07:25:23,431 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for spa
2025-02-12 07:25:23,431 - services.audio_processor - WARNING - [audio_processor.py:354] - No specific parameters for spa, using defaults
2025-02-12 07:25:23,494 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 07:25:23,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:23,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:23,600 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:23,600 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:23,618 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:23,618 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:23,636 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:25:23,636 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:25:25,603 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:161] - Spanish timing analysis failed: 'SpanishAnalyzer' object has no attribute '_find_syllable_boundaries'
2025-02-12 07:25:25,722 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:218] - Spanish vowel analysis failed: 'SpanishAnalyzer' object has no attribute '_analyze_vowel_formants'
2025-02-12 07:25:25,727 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:249] - Spanish stress analysis failed: 'SpanishAnalyzer' object has no attribute '_find_stress_peaks'
2025-02-12 07:25:25,728 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for spa
2025-02-12 07:25:25,729 - services.translation_routes - INFO - [translation_routes.py:153] - Request cf6539f1: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:19] - 
=== AUDIO ANALYSIS ===
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:29] - 
Audio Quality:
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:30] - - Audio Clarity: N/A
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:31] - - Background Noise: N/A
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:32] - - Voice Consistency: N/A
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:36] - 
Waveform Characteristics:
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:37] - - Peak Amplitude: 0.949999988079071
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:38] - - RMS Level: 0.06587004661560059
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:39] - - Silence Percentage: 25.136641315949987
2025-02-12 07:25:25,729 - services.translation_strategy - INFO - [translation_strategy.py:61] - 
Just listening to audio characteristics for now...
2025-02-12 07:25:25,730 - services.translation_routes - INFO - [translation_routes.py:165] - Request cf6539f1: Audio characteristics heard: {'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'audio_quality': {'clarity': 'N/A', 'background_noise': 'N/A', 'voice_consistency': 'N/A'}, 'waveform': {'peak_amplitude': 0.949999988079071, 'rms_level': 0.06587004661560059, 'silence_percentage': 25.136641315949987}}}
2025-02-12 07:25:25,730 - services.translation_routes - INFO - [translation_routes.py:167] - Request cf6539f1: Audio processed successfully
2025-02-12 07:25:25,775 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 07:26:05,127 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-12 07:26:48,557 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Alright, I've got to throw you through the jug. The main thing is make sure you're balanced on both feet. Hands up. Elbows in. Lots of people box with their elbows like this. No elbows in because of the body shot. And it really comes like this just straight out as it comes out. It turns straight back to the chin. When it's coming out, make sure your shoulder hits your chin so it protects you. Turn it as it is coming out slightly. So you hit with all four knuckles right here and it comes back and this right hand has to stay there.
2025-02-12 07:27:18,475 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 07:27:18,487 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:27:18,487 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:27:18,491 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:27:18,491 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:27:18,496 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:27:18,496 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:27:18,500 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 07:27:18,500 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 07:27:18,612 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:161] - Spanish timing analysis failed: 'SpanishAnalyzer' object has no attribute '_find_syllable_boundaries'
2025-02-12 07:27:18,621 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:218] - Spanish vowel analysis failed: 'SpanishAnalyzer' object has no attribute '_analyze_vowel_formants'
2025-02-12 07:27:18,622 - services.diagnostics.language_analysis.spanish - ERROR - [spanish.py:249] - Spanish stress analysis failed: 'SpanishAnalyzer' object has no attribute '_find_stress_peaks'
2025-02-12 07:27:18,623 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for spa
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: cf6539f1
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: spa
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: spa

Waveform Analysis:
--------------------
- Peak Amplitude: 0.585
- Avg Amplitude: 0.066
- Rms Level: 0.104
- Crest Factor: 5.599
- Zero Crossings: 6369.000
- Silence Percentage: 16.260
- Clipping Points: 0.000
- Dynamic Range: 577.420

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.300
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.028
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.261
  - Volume Range: 2625.132
  - Volume Variations: 0.062

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.037298405408786
- Background Noise: 3.2397584086932265
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Phoneme Analysis:
  - Trilled R: {'features': {'modulation_rate': 3529.526598340654, 'strength': 1.0765678882598877}, 'strength': 1.0, 'regularity': 0.0, 'duration': -136.02050046103307, 'overall_quality': 0.5}
  - Interdental Theta: {'energy': 0.8466175198554993, 'consistency': -2.4851362705230713, 'spectral_shape': {'centroid': 0.421909898519516, 'spread': 0.21899597346782684, 'quality': 0.751456968486309}, 'quality': -0.2956872607270877}
  - Stop Consonants: {'voiceless_stops': {'strength': 1.0, 'precision': 0.24840820011626563, 'quality': 0.6242041000581329}, 'voiced_stops': {'voicing': 0.23814657330513, 'precision': 0.09488798078823135, 'quality': 0.16651727704668068}, 'overall_quality': 0.3953606885524068}

Syllable Timing:

Intonation Patterns:
  - Contour Patterns: {'mean_pitch': 216.03734240692313, 'pitch_variability': 0.22476895688630633, 'rise_fall_ratio': 0.7142857141399417, 'quality': 0.7752310431240979}
  - Melodic Features: {'range': 1.0, 'movement': 0.42496959987168986, 'quality': 0.7124847999358449}
  - Overall Quality: 0.744

Vowel Clarity:

Stress Patterns:
2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 07:27:18,624 - services.translation_routes - INFO - [translation_routes.py:307] - Request cf6539f1: Audio output processed successfully
2025-02-12 07:27:18,627 - services.translation_routes - INFO - [translation_routes.py:362] - Request cf6539f1: Response prepared successfully
2025-02-12 07:27:18,627 - services.translation_routes - INFO - [translation_routes.py:375] - Request cf6539f1 completed in 117.67s
2025-02-12 07:27:18,630 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 117.67s, Memory Change: 3212.05MB
2025-02-12 07:27:18,630 - __main__ - INFO - [app.py:278] - Request to /translate took 151.76s
2025-02-12 07:39:35,699 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 07:39:35,700 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 07:39:35,702 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053
2025-02-12 07:39:35,702 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 07:39:35,703 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpbs4ufsqu/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2094528318954116761'}}}
2025-02-12 07:39:36,036 - services.audio_link_routes - ERROR - [audio_link_routes.py:175] - Download error for tiktok: [0;31mERROR:[0m [TikTok] 7127311328095522053: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U
2025-02-12 07:39:36,036 - services.audio_link_routes - ERROR - [audio_link_routes.py:182] - tiktok processing error: Unable to access this TikTok content. Please try another video or check the URL.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1772, in __extract_info
    ie_result = ie.extract(url)
                ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 742, in extract
    ie_result = self._real_extract(url)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 894, in _real_extract
    video_data, status = self._extract_web_data_and_status(url, video_id)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 250, in _extract_web_data_and_status
    raise ExtractorError('Unable to extract webpage video data')
yt_dlp.utils.ExtractorError: [TikTok] 7127311328095522053: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 125, in handle_video_platform_url
    info = ydl.extract_info(url, download=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1655, in wrapper
    self.report_error(str(e), e.format_traceback())
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m [TikTok] 7127311328095522053: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 177, in handle_video_platform_url
    raise Exception(f"Unable to access this TikTok content. Please try another video or check the URL.")
Exception: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-12 07:39:36,038 - services.audio_link_routes - ERROR - [audio_link_routes.py:250] - Processing error: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-12 07:39:36,041 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.34s, Memory Change: 4.56MB
2025-02-12 07:39:36,041 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.34s
2025-02-12 08:37:39,077 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-12 08:37:39,077 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-12 08:37:52,245 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-12 08:37:52,245 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 08:37:52,245 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 08:38:14,361 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 08:38:14,362 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 08:38:32,346 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 08:38:32,346 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 08:38:32,349 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-12 08:38:32,349 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 08:38:32,349 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 08:38:51,918 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 08:38:51,919 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 08:39:06,979 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 08:39:06,979 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 14.5GB available
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-12 08:39:06,982 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-12 08:40:41,149 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 08:40:41,150 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 08:40:41,153 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053
2025-02-12 08:40:41,154 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 08:40:41,155 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkhtwa49j/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2284548983856573606'}}}
2025-02-12 08:40:42,797 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 08:40:42,798 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkhtwa49j/output.wav
2025-02-12 08:40:42,803 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 08:40:42,803 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 08:40:42,804 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.65s, Memory Change: 9.64MB
2025-02-12 08:40:42,804 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.65s
2025-02-12 08:40:44,141 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 08:40:44,142 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 08:41:01,917 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 08:41:01,917 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 08:41:24,431 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 08:41:24,431 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 08:41:24,434 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 5c22ce97
2025-02-12 08:41:24,434 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 08:41:24,434 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 08:41:24,435 - services.translation_routes - INFO - [translation_routes.py:97] - Request 5c22ce97: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpr9ks58s6.wav
2025-02-12 08:41:24,435 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-12 08:41:24,435 - services.translation_routes - INFO - [translation_routes.py:112] - Request 5c22ce97: Beginning audio processing with diagnostics
2025-02-12 08:41:24,435 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpr9ks58s6.wav
2025-02-12 08:41:24,435 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 08:41:24,436 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 08:41:24,442 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 08:41:24,445 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 08:41:24,445 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 08:41:24,454 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 08:41:24,466 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,466 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,469 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,469 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,472 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,472 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,476 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,476 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,629 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 08:41:24,629 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 08:41:24,629 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 08:41:24,629 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 08:41:24,630 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 5c22ce97
2025-02-12 08:41:24,630 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 08:41:24,630 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 08:41:24,630 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 08:41:24,630 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 08:41:24,630 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpr9ks58s6.wav
2025-02-12 08:41:24,630 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 08:41:24,631 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 08:41:24,639 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 08:41:24,643 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 08:41:24,643 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 08:41:24,656 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 08:41:24,668 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,668 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,675 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,675 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,681 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,681 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,686 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:24,686 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:24,845 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 08:41:24,845 - services.translation_routes - INFO - [translation_routes.py:153] - Request 5c22ce97: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:19] - 
=== AUDIO ANALYSIS ===
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:29] - 
Audio Quality:
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:30] - - Audio Clarity: N/A
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:31] - - Background Noise: N/A
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:32] - - Voice Consistency: N/A
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:36] - 
Waveform Characteristics:
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:37] - - Peak Amplitude: 0.9499999284744263
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:38] - - RMS Level: 0.07581577450037003
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:39] - - Silence Percentage: 62.741044207317074
2025-02-12 08:41:24,845 - services.translation_strategy - INFO - [translation_strategy.py:61] - 
Just listening to audio characteristics for now...
2025-02-12 08:41:24,845 - services.translation_routes - INFO - [translation_routes.py:165] - Request 5c22ce97: Audio characteristics heard: {'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'audio_quality': {'clarity': 'N/A', 'background_noise': 'N/A', 'voice_consistency': 'N/A'}, 'waveform': {'peak_amplitude': 0.9499999284744263, 'rms_level': 0.07581577450037003, 'silence_percentage': 62.741044207317074}}}
2025-02-12 08:41:24,846 - services.translation_routes - INFO - [translation_routes.py:167] - Request 5c22ce97: Audio processed successfully
2025-02-12 08:41:24,852 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 08:41:30,100 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-12 08:41:36,556 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-12 08:41:43,887 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 08:41:43,897 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:43,897 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:43,901 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:43,901 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:43,905 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:43,905 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:43,908 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 08:41:43,908 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 08:41:44,030 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 5c22ce97
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.405
- Avg Amplitude: 0.050
- Rms Level: 0.081
- Crest Factor: 4.966
- Zero Crossings: 11447.000
- Silence Percentage: 12.487
- Clipping Points: 0.000
- Dynamic Range: 199.361

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.379
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.020
  - Temporal Flatness: 0.012

- Volume Metrics:
  - Volume Stability: 0.221
  - Volume Range: 494.642
  - Volume Variations: 0.050

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.032803180759568
- Background Noise: 2.9865528843701488
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.6857079863548279, 'stability': 3.2134814262390137, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.15083637833595276, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.499
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 08:41:44,030 - services.translation_routes - INFO - [translation_routes.py:307] - Request 5c22ce97: Audio output processed successfully
2025-02-12 08:41:44,033 - services.translation_routes - INFO - [translation_routes.py:362] - Request 5c22ce97: Response prepared successfully
2025-02-12 08:41:44,033 - services.translation_routes - INFO - [translation_routes.py:375] - Request 5c22ce97 completed in 19.60s
2025-02-12 08:41:44,033 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 19.60s, Memory Change: 363.17MB
2025-02-12 08:41:44,033 - __main__ - INFO - [app.py:278] - Request to /translate took 59.89s
2025-02-12 09:21:48,705 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.52MB
2025-02-12 09:21:48,708 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 09:21:48,712 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-12 09:21:48,714 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 09:21:48,715 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp3m97eqcw/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 09:21:52,164 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 09:21:52,166 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp3m97eqcw/output.wav
2025-02-12 09:21:52,195 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 09:21:52,196 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 09:21:52,196 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.49s, Memory Change: 250.86MB
2025-02-12 09:21:52,196 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.49s
2025-02-12 09:21:53,303 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 09:21:53,305 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 09:22:09,567 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 09:22:09,567 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 09:22:25,061 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 09:22:25,062 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 09:22:25,065 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 9f7d1bc3
2025-02-12 09:22:25,065 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 09:22:25,065 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 09:22:25,068 - services.translation_routes - INFO - [translation_routes.py:97] - Request 9f7d1bc3: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmper9wbpwn.wav
2025-02-12 09:22:25,068 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-12 09:22:25,068 - services.translation_routes - INFO - [translation_routes.py:112] - Request 9f7d1bc3: Beginning audio processing with diagnostics
2025-02-12 09:22:25,068 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmper9wbpwn.wav
2025-02-12 09:22:25,068 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:22:25,071 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 09:22:25,111 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:22:25,123 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 09:22:25,123 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:22:25,186 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:22:25,270 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:25,271 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:25,288 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:25,289 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:25,304 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:25,304 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:25,321 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:25,321 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:27,322 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 9f7d1bc3
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:22:27,322 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 09:22:27,322 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmper9wbpwn.wav
2025-02-12 09:22:27,323 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:22:27,325 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 09:22:27,365 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:22:27,375 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 09:22:27,375 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:22:27,440 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:22:27,526 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:27,527 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:27,544 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:27,544 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:27,559 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:27,560 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:27,577 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:22:27,578 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:22:29,506 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:22:29,507 - services.translation_routes - INFO - [translation_routes.py:153] - Request 9f7d1bc3: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 09:22:29,507 - services.translation_strategy - INFO - [translation_strategy.py:19] - 
=== AUDIO ANALYSIS ===
2025-02-12 09:22:29,507 - services.translation_strategy - INFO - [translation_strategy.py:29] - 
Audio Quality:
2025-02-12 09:22:29,507 - services.translation_strategy - INFO - [translation_strategy.py:30] - - Audio Clarity: N/A
2025-02-12 09:22:29,507 - services.translation_strategy - INFO - [translation_strategy.py:31] - - Background Noise: N/A
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:32] - - Voice Consistency: N/A
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:36] - 
Waveform Characteristics:
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:37] - - Peak Amplitude: 0.949999988079071
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:38] - - RMS Level: 0.06587004661560059
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:39] - - Silence Percentage: 25.136641315949987
2025-02-12 09:22:29,508 - services.translation_strategy - INFO - [translation_strategy.py:61] - 
Just listening to audio characteristics for now...
2025-02-12 09:22:29,508 - services.translation_routes - INFO - [translation_routes.py:165] - Request 9f7d1bc3: Audio characteristics heard: {'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'audio_quality': {'clarity': 'N/A', 'background_noise': 'N/A', 'voice_consistency': 'N/A'}, 'waveform': {'peak_amplitude': 0.949999988079071, 'rms_level': 0.06587004661560059, 'silence_percentage': 25.136641315949987}}}
2025-02-12 09:22:29,508 - services.translation_routes - INFO - [translation_routes.py:167] - Request 9f7d1bc3: Audio processed successfully
2025-02-12 09:22:29,553 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 09:23:07,152 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-12 09:23:30,664 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: [Musique épique, chanteuse et comédienne qui a fait de l'humour dans le monde entier en faisant du bruit d'un coup de poing sur son visage et ses doigts.]
2025-02-12 09:23:58,284 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 09:23:58,289 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:23:58,289 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:23:58,292 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:23:58,292 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:23:58,295 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:23:58,295 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:23:58,296 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:23:58,297 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:23:58,335 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 9f7d1bc3
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.438
- Avg Amplitude: 0.051
- Rms Level: 0.089
- Crest Factor: 4.933
- Zero Crossings: 1618.000
- Silence Percentage: 33.181
- Clipping Points: 0.000
- Dynamic Range: 1848.612

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.383
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.021
  - Temporal Flatness: 0.010

- Volume Metrics:
  - Volume Stability: 0.071
  - Volume Range: 2046.369
  - Volume Variations: 0.062

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.036029811839437
- Background Noise: 2.973261087887499
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': nan, 'stability': nan, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 1.0, 'distinction': 1.0}
  - Description: Weak nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.629
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 1.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 09:23:58,335 - services.translation_routes - INFO - [translation_routes.py:307] - Request 9f7d1bc3: Audio output processed successfully
2025-02-12 09:23:58,337 - services.translation_routes - INFO - [translation_routes.py:362] - Request 9f7d1bc3: Response prepared successfully
2025-02-12 09:23:58,338 - services.translation_routes - INFO - [translation_routes.py:375] - Request 9f7d1bc3 completed in 93.27s
2025-02-12 09:23:58,339 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 93.27s, Memory Change: 3025.25MB
2025-02-12 09:23:58,339 - __main__ - INFO - [app.py:278] - Request to /translate took 125.04s
2025-02-12 09:30:49,103 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.50MB
2025-02-12 09:30:49,106 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.01s
2025-02-12 09:30:49,109 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-12 09:30:49,111 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 09:30:49,112 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7cdoutm3/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2899093922328963941'}}}
2025-02-12 09:30:50,655 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 09:30:50,657 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7cdoutm3/output.wav
2025-02-12 09:30:50,698 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 09:30:50,699 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 09:30:50,700 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.59s, Memory Change: 69.50MB
2025-02-12 09:30:50,700 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.59s
2025-02-12 09:30:53,491 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 09:30:53,493 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 09:31:12,682 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 09:31:12,683 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 09:31:31,934 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 09:31:31,935 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 09:31:31,939 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request fdede233
2025-02-12 09:31:31,939 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 09:31:31,939 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 09:31:31,942 - services.translation_routes - INFO - [translation_routes.py:97] - Request fdede233: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpd4tg6brr.wav
2025-02-12 09:31:31,942 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-12 09:31:31,942 - services.translation_routes - INFO - [translation_routes.py:112] - Request fdede233: Beginning audio processing with diagnostics
2025-02-12 09:31:31,942 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpd4tg6brr.wav
2025-02-12 09:31:31,942 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:31:31,945 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 09:31:32,006 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:31:32,023 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 09:31:32,023 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:31:32,116 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:31:32,234 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:32,235 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:32,264 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:32,264 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:32,287 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:32,288 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:32,310 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:32,310 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:34,822 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: fdede233
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:31:34,823 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 09:31:34,823 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpd4tg6brr.wav
2025-02-12 09:31:34,823 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:31:34,826 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 09:31:34,936 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:31:34,954 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 09:31:34,954 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:31:35,053 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:31:35,175 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:35,176 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:35,202 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:35,202 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:35,229 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:35,229 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:35,254 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:31:35,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:31:37,747 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:31:37,748 - services.translation_routes - INFO - [translation_routes.py:153] - Request fdede233: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:19] - 
=== AUDIO ANALYSIS ===
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:29] - 
Audio Quality:
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:30] - - Audio Clarity: N/A
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:31] - - Background Noise: N/A
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:32] - - Voice Consistency: N/A
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:36] - 
Waveform Characteristics:
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:37] - - Peak Amplitude: 0.949999988079071
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:38] - - RMS Level: 0.06382925063371658
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:39] - - Silence Percentage: 25.552556199651644
2025-02-12 09:31:37,748 - services.translation_strategy - INFO - [translation_strategy.py:61] - 
Just listening to audio characteristics for now...
2025-02-12 09:31:37,748 - services.translation_routes - INFO - [translation_routes.py:165] - Request fdede233: Audio characteristics heard: {'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'audio_quality': {'clarity': 'N/A', 'background_noise': 'N/A', 'voice_consistency': 'N/A'}, 'waveform': {'peak_amplitude': 0.949999988079071, 'rms_level': 0.06382925063371658, 'silence_percentage': 25.552556199651644}}}
2025-02-12 09:31:37,748 - services.translation_routes - INFO - [translation_routes.py:167] - Request fdede233: Audio processed successfully
2025-02-12 09:31:37,811 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 09:32:24,843 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-12 09:32:24,845 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 09:32:24,845 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp9bvyqmp/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 09:32:29,622 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 09:32:29,624 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp9bvyqmp/output.wav
2025-02-12 09:32:29,667 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 09:32:29,668 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 09:32:29,668 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.83s, Memory Change: 153.94MB
2025-02-12 09:32:29,669 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 4.83s
2025-02-12 09:32:32,100 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 09:32:32,108 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 09:32:48,542 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: This photo doesn't make sense. There's a plane that takes you up in the air and it feels like the passengers are floating. My goal was to throw them all into the air when we were at the peak of the pharaoh, weightless and I would be floating around in the center of my work. We couldn't believe it. It's one of those things where I can describe it as much as I want, but until you experience it, there's nothing like it. That's why I felt captured the epitome of this project. A photo that on paper makes no fucking sense and shouldn't be possible.
2025-02-12 09:33:03,201 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 09:33:03,201 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 09:33:35,764 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 09:33:35,765 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 09:33:35,781 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 31cc1bda
2025-02-12 09:33:35,781 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 09:33:35,782 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 09:33:35,788 - services.translation_routes - INFO - [translation_routes.py:97] - Request 31cc1bda: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpfe0ih7ch.wav
2025-02-12 09:33:35,793 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-12 09:33:35,793 - services.translation_routes - INFO - [translation_routes.py:112] - Request 31cc1bda: Beginning audio processing with diagnostics
2025-02-12 09:33:35,794 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpfe0ih7ch.wav
2025-02-12 09:33:35,794 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:33:35,807 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 09:33:35,924 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:33:35,963 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 09:33:35,963 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:33:36,095 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:33:36,250 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:36,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:36,298 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:36,299 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:36,340 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:36,340 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:36,382 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:36,382 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:39,772 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 31cc1bda
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:33:39,773 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 09:33:39,773 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpfe0ih7ch.wav
2025-02-12 09:33:39,773 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 09:33:39,777 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 09:33:39,852 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 09:33:39,872 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 09:33:39,872 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 09:33:39,994 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 09:33:40,134 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:40,135 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:40,176 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:40,177 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:40,211 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:40,212 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:40,248 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:33:40,249 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:33:43,651 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:33:43,652 - services.translation_routes - INFO - [translation_routes.py:153] - Request 31cc1bda: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:19] - 
=== AUDIO ANALYSIS ===
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:29] - 
Audio Quality:
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:30] - - Audio Clarity: N/A
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:31] - - Background Noise: N/A
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:32] - - Voice Consistency: N/A
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:36] - 
Waveform Characteristics:
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:37] - - Peak Amplitude: 0.9499999284744263
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:38] - - RMS Level: 0.11422983556985855
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:39] - - Silence Percentage: 23.70153105482304
2025-02-12 09:33:43,652 - services.translation_strategy - INFO - [translation_strategy.py:61] - 
Just listening to audio characteristics for now...
2025-02-12 09:33:43,652 - services.translation_routes - INFO - [translation_routes.py:165] - Request 31cc1bda: Audio characteristics heard: {'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'audio_quality': {'clarity': 'N/A', 'background_noise': 'N/A', 'voice_consistency': 'N/A'}, 'waveform': {'peak_amplitude': 0.9499999284744263, 'rms_level': 0.11422983556985855, 'silence_percentage': 23.70153105482304}}}
2025-02-12 09:33:43,652 - services.translation_routes - INFO - [translation_routes.py:167] - Request 31cc1bda: Audio processed successfully
2025-02-12 09:33:43,757 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 09:34:04,542 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: C'est une sorte de réalité irréaliste que j'ai capturé l'épitome de ce projet et c'est pourquoi cette photo qui sur papier fait pas de putain de sens et ne devrait pas être possible est 99 originaux.
2025-02-12 09:34:54,184 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no hurricane willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 09:36:00,792 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 09:36:00,826 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:36:00,827 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:36:00,834 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:36:00,834 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:36:00,841 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:36:00,841 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:36:00,851 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:36:00,852 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:36:01,006 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:36:01,008 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 09:36:01,008 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 09:36:01,008 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 09:36:01,008 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: fdede233
2025-02-12 09:36:01,009 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 09:36:01,009 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 09:36:01,009 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.724
- Avg Amplitude: 0.063
- Rms Level: 0.097
- Crest Factor: 7.468
- Zero Crossings: 9734.000
- Silence Percentage: 10.267
- Clipping Points: 0.000
- Dynamic Range: 177.640

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.066
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.024
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.321
  - Volume Range: 623.675
  - Volume Variations: 0.055

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.025960622532331
- Background Noise: 3.987361594386015
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7784932255744934, 'stability': 3.268470287322998, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.18699483573436737, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.509
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:36:01,009 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 09:36:01,009 - services.translation_routes - INFO - [translation_routes.py:307] - Request fdede233: Audio output processed successfully
2025-02-12 09:36:01,015 - services.translation_routes - INFO - [translation_routes.py:362] - Request fdede233: Response prepared successfully
2025-02-12 09:36:01,016 - services.translation_routes - INFO - [translation_routes.py:375] - Request fdede233 completed in 269.08s
2025-02-12 09:36:01,018 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 269.08s, Memory Change: -731.86MB
2025-02-12 09:36:01,018 - __main__ - INFO - [app.py:278] - Request to /translate took 307.53s
2025-02-12 09:36:08,821 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: hop along my little friends up with you windows toms going on ahead candles for the king down the west since the sun soon you will be broken when the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no horry willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 09:37:19,426 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 09:37:19,456 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:37:19,457 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:37:19,464 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:37:19,464 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:37:19,473 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:37:19,473 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:37:19,481 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 09:37:19,481 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 09:37:19,910 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 31cc1bda
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.655
- Avg Amplitude: 0.069
- Rms Level: 0.097
- Crest Factor: 6.724
- Zero Crossings: 31858.000
- Silence Percentage: 5.328
- Clipping Points: 0.000
- Dynamic Range: 65.592

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.160
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.478
  - Volume Range: 153.171
  - Volume Variations: 0.045

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.028998212654001
- Background Noise: 3.6894995771552868
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8409481048583984, 'stability': 3.538668632507324, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.07662992924451828, 'consistency': 0.0, 'distinction': 0.08752179890871048}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.534
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 09:37:19,910 - services.translation_routes - INFO - [translation_routes.py:307] - Request 31cc1bda: Audio output processed successfully
2025-02-12 09:37:19,915 - services.translation_routes - INFO - [translation_routes.py:362] - Request 31cc1bda: Response prepared successfully
2025-02-12 09:37:19,916 - services.translation_routes - INFO - [translation_routes.py:375] - Request 31cc1bda completed in 224.14s
2025-02-12 09:37:19,918 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 224.14s, Memory Change: -448.70MB
2025-02-12 09:37:19,918 - __main__ - INFO - [app.py:278] - Request to /translate took 287.82s
2025-02-12 19:43:12,029 - __main__ - INFO - [app.py:217] - Received SIGINT signal
2025-02-12 19:43:12,032 - __main__ - INFO - [app.py:202] - Initiating graceful shutdown...
2025-02-12 19:43:17,037 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 19:43:17,039 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 19:43:17,040 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 19:43:17,046 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 19:43:17,048 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 19:43:17,050 - __main__ - INFO - [app.py:206] - Graceful shutdown completed
2025-02-12 19:43:17,052 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 19:43:17,053 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 19:43:17,053 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 19:43:17,054 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 19:43:17,055 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 19:43:17,056 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 19:43:17,056 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 19:43:17,056 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 19:43:17,056 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 19:43:17,057 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 19:43:39,966 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-12 19:43:39,966 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-12 19:44:07,398 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-12 19:44:07,399 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:44:07,400 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:44:41,301 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:44:41,302 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:44:57,861 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:44:57,862 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:44:57,865 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-12 19:44:57,865 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:44:57,865 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:45:16,937 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:45:16,937 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:45:35,758 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:45:35,759 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:45:35,762 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 11.1GB available
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-12 19:45:35,763 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-12 19:47:48,053 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 19:47:48,054 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 19:47:48,057 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-12 19:47:48,057 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 19:47:48,058 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpvkxjw7k1/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 19:47:54,260 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 19:47:54,262 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpvkxjw7k1/output.wav
2025-02-12 19:47:54,290 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 19:47:54,290 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 19:47:54,291 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.23s, Memory Change: 14.58MB
2025-02-12 19:47:54,291 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.23s
2025-02-12 19:47:59,020 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:47:59,022 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:48:08,677 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-12 19:48:08,678 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 19:48:08,678 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkjiret_1/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 19:48:15,501 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 19:48:15,504 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkjiret_1/output.wav
2025-02-12 19:48:15,551 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 19:48:15,552 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 19:48:15,553 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.88s, Memory Change: 53.02MB
2025-02-12 19:48:15,553 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.88s
2025-02-12 19:48:17,192 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:48:17,193 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:48:18,374 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:48:18,374 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:48:42,558 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:48:42,559 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:48:42,562 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 6d921851
2025-02-12 19:48:42,563 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 19:48:42,563 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 19:48:42,567 - services.translation_routes - INFO - [translation_routes.py:97] - Request 6d921851: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp_83uwghb.wav
2025-02-12 19:48:42,567 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-12 19:48:42,567 - services.translation_routes - INFO - [translation_routes.py:112] - Request 6d921851: Beginning audio processing with diagnostics
2025-02-12 19:48:42,567 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp_83uwghb.wav
2025-02-12 19:48:42,568 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:48:42,570 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 19:48:42,625 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:48:42,650 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 19:48:42,650 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:48:42,744 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:48:42,854 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:42,855 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:42,885 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:42,885 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:42,913 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:42,913 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:42,941 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:42,941 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:45,424 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 6d921851
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 19:48:45,424 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 19:48:45,425 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 19:48:45,425 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 19:48:45,425 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp_83uwghb.wav
2025-02-12 19:48:45,425 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:48:45,428 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 19:48:45,483 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:48:45,498 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 19:48:45,498 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:48:45,592 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:48:45,700 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:45,701 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:45,729 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:45,729 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:45,762 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:45,762 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:45,789 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:48:45,789 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:48:48,259 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:48:48,260 - services.translation_routes - INFO - [translation_routes.py:153] - Request 6d921851: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 19:48:48,260 - services.translation_routes - ERROR - [translation_routes.py:169] - Audio processing error: 'TranslationStrategy' object has no attribute 'select_strategy'
2025-02-12 19:48:48,260 - services.translation_routes - INFO - [translation_routes.py:375] - Request 6d921851 completed in 5.70s
2025-02-12 19:48:48,260 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 5.70s, Memory Change: 112.19MB
2025-02-12 19:48:48,260 - __main__ - INFO - [app.py:278] - Request to /translate took 49.24s
2025-02-12 19:48:50,618 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:48:50,618 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:49:09,801 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?is_from_webapp=1&sender_device=pc&web_id=7470222526028858902
2025-02-12 19:49:09,803 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 19:49:09,803 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpwuubvfon/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '9953722873351516592'}}}
2025-02-12 19:49:12,207 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:49:12,207 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:49:12,212 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 41cd5d86
2025-02-12 19:49:12,212 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 19:49:12,212 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 19:49:12,215 - services.translation_routes - INFO - [translation_routes.py:97] - Request 41cd5d86: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5idhoeqi.wav
2025-02-12 19:49:12,216 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-12 19:49:12,216 - services.translation_routes - INFO - [translation_routes.py:112] - Request 41cd5d86: Beginning audio processing with diagnostics
2025-02-12 19:49:12,216 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5idhoeqi.wav
2025-02-12 19:49:12,216 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:49:12,219 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 19:49:12,274 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:49:12,289 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:49:12,289 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:49:12,373 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:49:12,483 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:12,484 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:12,507 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:12,508 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:12,530 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:12,530 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:12,551 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:12,552 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:13,206 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 19:49:13,221 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpwuubvfon/output.wav
2025-02-12 19:49:13,246 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 19:49:13,277 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 19:49:13,290 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.49s, Memory Change: 128.20MB
2025-02-12 19:49:13,305 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.50s
2025-02-12 19:49:15,503 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 41cd5d86
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 19:49:15,504 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 19:49:15,504 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5idhoeqi.wav
2025-02-12 19:49:15,504 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:49:15,508 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 19:49:15,565 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:49:15,582 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:49:15,582 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:49:15,672 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:49:15,984 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:15,987 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:16,054 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:16,055 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:16,085 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:16,085 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:16,118 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:49:16,119 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:49:18,834 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:49:18,836 - services.translation_routes - INFO - [translation_routes.py:153] - Request 41cd5d86: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:49:18,836 - services.translation_routes - ERROR - [translation_routes.py:169] - Audio processing error: 'TranslationStrategy' object has no attribute 'select_strategy'
2025-02-12 19:49:18,836 - services.translation_routes - INFO - [translation_routes.py:375] - Request 41cd5d86 completed in 6.62s
2025-02-12 19:49:18,837 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 6.62s, Memory Change: 124.42MB
2025-02-12 19:49:18,837 - __main__ - INFO - [app.py:278] - Request to /translate took 61.64s
2025-02-12 19:49:22,793 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:49:22,794 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:49:26,001 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:49:26,003 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:49:56,523 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:49:56,523 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:49:57,662 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:49:57,663 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:50:06,437 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 19:50:06,437 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 19:50:06,439 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-12 19:50:06,439 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 19:50:06,440 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp2b8kxk3f/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '4723013160070392690'}}}
2025-02-12 19:50:09,865 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 19:50:09,867 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp2b8kxk3f/output.wav
2025-02-12 19:50:09,918 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 19:50:09,919 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 19:50:09,920 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.48s, Memory Change: -0.11MB
2025-02-12 19:50:09,920 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.48s
2025-02-12 19:50:12,368 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 19:50:12,369 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 19:50:27,806 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:50:27,806 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:50:27,808 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request ed3a2b2f
2025-02-12 19:50:27,808 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 19:50:27,808 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 19:50:27,809 - services.translation_routes - INFO - [translation_routes.py:97] - Request ed3a2b2f: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpnkqaxjdu.wav
2025-02-12 19:50:27,809 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-12 19:50:27,809 - services.translation_routes - INFO - [translation_routes.py:112] - Request ed3a2b2f: Beginning audio processing with diagnostics
2025-02-12 19:50:27,809 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpnkqaxjdu.wav
2025-02-12 19:50:27,810 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:50:27,810 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 19:50:27,820 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:50:27,826 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 19:50:27,826 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:50:27,847 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:50:27,866 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:27,866 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:27,875 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:27,876 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:27,885 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:27,886 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:27,897 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:27,897 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:28,121 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: ed3a2b2f
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 19:50:28,121 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 19:50:28,122 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 19:50:28,122 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpnkqaxjdu.wav
2025-02-12 19:50:28,122 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:50:28,123 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 19:50:28,133 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:50:28,137 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 19:50:28,137 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:50:28,153 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:50:28,170 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:28,170 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:28,176 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:28,177 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:28,185 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:28,185 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:28,191 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:28,191 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:28,392 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:50:28,393 - services.translation_routes - INFO - [translation_routes.py:153] - Request ed3a2b2f: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 19:50:28,393 - services.translation_routes - ERROR - [translation_routes.py:169] - Audio processing error: 'TranslationStrategy' object has no attribute 'select_strategy'
2025-02-12 19:50:28,393 - services.translation_routes - INFO - [translation_routes.py:375] - Request ed3a2b2f completed in 0.59s
2025-02-12 19:50:28,394 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 0.59s, Memory Change: -0.98MB
2025-02-12 19:50:28,394 - __main__ - INFO - [app.py:278] - Request to /translate took 62.39s
2025-02-12 19:50:32,296 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:50:32,296 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:50:32,304 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request ed78677e
2025-02-12 19:50:32,305 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 19:50:32,305 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 19:50:32,308 - services.translation_routes - INFO - [translation_routes.py:97] - Request ed78677e: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpc_tj4eg7.wav
2025-02-12 19:50:32,309 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-12 19:50:32,309 - services.translation_routes - INFO - [translation_routes.py:112] - Request ed78677e: Beginning audio processing with diagnostics
2025-02-12 19:50:32,309 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpc_tj4eg7.wav
2025-02-12 19:50:32,309 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:50:32,317 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 19:50:32,419 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:50:32,441 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:50:32,441 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:50:32,563 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:50:32,817 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:32,819 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:32,889 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:32,889 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:32,927 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:32,928 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:32,971 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:32,972 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:36,341 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:50:36,342 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 19:50:36,342 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 19:50:36,342 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 19:50:36,345 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: ed78677e
2025-02-12 19:50:36,345 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 19:50:36,345 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 19:50:36,348 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 19:50:36,348 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 19:50:36,348 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpc_tj4eg7.wav
2025-02-12 19:50:36,348 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:50:36,355 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 19:50:36,432 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:50:36,454 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:50:36,454 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:50:36,583 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:50:36,721 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:36,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:36,770 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:36,771 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:36,814 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:36,815 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:36,858 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:50:36,858 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:50:40,195 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:50:40,196 - services.translation_routes - INFO - [translation_routes.py:153] - Request ed78677e: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 19:50:40,196 - services.translation_routes - ERROR - [translation_routes.py:169] - Audio processing error: 'TranslationStrategy' object has no attribute 'select_strategy'
2025-02-12 19:50:40,197 - services.translation_routes - INFO - [translation_routes.py:375] - Request ed78677e completed in 7.89s
2025-02-12 19:50:40,198 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 7.89s, Memory Change: 12.83MB
2025-02-12 19:50:40,198 - __main__ - INFO - [app.py:278] - Request to /translate took 77.41s
2025-02-12 19:50:47,242 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 19:50:47,242 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 19:51:05,203 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 19:51:05,203 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 19:51:05,208 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 116d2d74
2025-02-12 19:51:05,208 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 19:51:05,208 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 19:51:05,210 - services.translation_routes - INFO - [translation_routes.py:97] - Request 116d2d74: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdnfuimt1.wav
2025-02-12 19:51:05,210 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-12 19:51:05,210 - services.translation_routes - INFO - [translation_routes.py:112] - Request 116d2d74: Beginning audio processing with diagnostics
2025-02-12 19:51:05,210 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdnfuimt1.wav
2025-02-12 19:51:05,210 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:51:05,214 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 19:51:05,276 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:51:05,293 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 19:51:05,293 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:51:05,392 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:51:05,517 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:05,518 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:05,545 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:05,545 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:05,571 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:05,571 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:05,600 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:05,600 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:08,143 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 116d2d74
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 19:51:08,144 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 19:51:08,145 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 19:51:08,145 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdnfuimt1.wav
2025-02-12 19:51:08,145 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 19:51:08,149 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 19:51:08,213 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 19:51:08,230 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 19:51:08,230 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 19:51:08,335 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 19:51:08,462 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:08,463 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:08,493 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:08,493 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:08,520 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:08,521 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:08,548 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 19:51:08,548 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 19:51:11,080 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 19:51:11,082 - services.translation_routes - INFO - [translation_routes.py:153] - Request 116d2d74: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 19:51:11,082 - services.translation_routes - ERROR - [translation_routes.py:169] - Audio processing error: 'TranslationStrategy' object has no attribute 'select_strategy'
2025-02-12 19:51:11,082 - services.translation_routes - INFO - [translation_routes.py:375] - Request 116d2d74 completed in 5.87s
2025-02-12 19:51:11,082 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 5.87s, Memory Change: 11.27MB
2025-02-12 19:51:11,082 - __main__ - INFO - [app.py:278] - Request to /translate took 58.72s
2025-02-12 20:05:51,708 - __main__ - INFO - [app.py:217] - Received SIGINT signal
2025-02-12 20:05:51,710 - __main__ - INFO - [app.py:202] - Initiating graceful shutdown...
2025-02-12 20:05:56,713 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:05:56,716 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:05:56,716 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:05:56,717 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:05:56,718 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:05:56,718 - __main__ - INFO - [app.py:206] - Graceful shutdown completed
2025-02-12 20:05:56,719 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:05:56,719 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:05:56,719 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:05:56,720 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:05:56,720 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:05:56,720 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:05:56,721 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:05:56,721 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:05:56,721 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:05:56,722 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:06:42,596 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-12 20:06:42,596 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-12 20:07:17,070 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-12 20:07:17,070 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:07:17,071 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:07:33,289 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:07:33,289 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:07:52,192 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:07:52,193 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:07:52,195 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-12 20:07:52,195 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:07:52,195 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:08:09,894 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:08:09,895 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:08:29,196 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:08:29,196 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-12 20:08:29,199 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 11.4GB available
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-12 20:08:29,200 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-12 20:08:29,201 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-12 20:08:29,201 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-12 20:08:29,201 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-12 20:09:27,955 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 20:09:27,955 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 20:09:27,958 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-12 20:09:27,959 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 20:09:27,959 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpiusq2pr5/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 20:09:36,938 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 20:09:36,940 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpiusq2pr5/output.wav
2025-02-12 20:09:36,969 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:09:36,970 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:09:36,970 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 9.01s, Memory Change: 0.78MB
2025-02-12 20:09:36,970 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 9.01s
2025-02-12 20:09:43,837 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:09:43,839 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:09:48,371 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-12 20:09:48,372 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 20:09:48,372 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu_3xyw0m/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 20:10:00,906 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 20:10:00,908 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu_3xyw0m/output.wav
2025-02-12 20:10:00,954 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:10:00,955 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:10:00,956 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 12.58s, Memory Change: 32.42MB
2025-02-12 20:10:00,956 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 12.59s
2025-02-12 20:10:02,519 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:10:02,520 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:10:07,538 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:10:07,539 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:10:18,468 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?is_from_webapp=1&sender_device=pc&web_id=7470222526028858902
2025-02-12 20:10:18,469 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 20:10:18,470 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpxzb6qhj3/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '9355785179885862320'}}}
2025-02-12 20:10:23,559 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 20:10:23,561 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpxzb6qhj3/output.wav
2025-02-12 20:10:23,566 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:10:23,567 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:10:23,567 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 5.10s, Memory Change: 6.27MB
2025-02-12 20:10:23,568 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 5.10s
2025-02-12 20:10:27,310 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:10:27,312 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:10:33,459 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:10:33,460 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:10:33,462 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 5ca1de41
2025-02-12 20:10:33,462 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:10:33,462 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:10:33,466 - services.translation_routes - INFO - [translation_routes.py:97] - Request 5ca1de41: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k3mbsfk.wav
2025-02-12 20:10:33,466 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-12 20:10:33,466 - services.translation_routes - INFO - [translation_routes.py:112] - Request 5ca1de41: Beginning audio processing with diagnostics
2025-02-12 20:10:33,466 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k3mbsfk.wav
2025-02-12 20:10:33,467 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:10:33,470 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 20:10:33,534 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:10:33,556 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:10:33,559 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:10:33,684 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:10:33,806 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:33,807 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:33,838 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:33,839 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:33,873 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:33,873 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:33,904 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:33,905 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:37,010 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 5ca1de41
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:10:37,011 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:10:37,011 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k3mbsfk.wav
2025-02-12 20:10:37,011 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:10:37,015 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 20:10:37,076 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:10:37,094 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:10:37,094 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:10:37,213 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:10:37,338 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:37,338 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:37,368 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:37,368 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:37,399 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:37,399 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:37,430 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:10:37,430 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:10:40,830 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:10:40,831 - services.translation_routes - INFO - [translation_routes.py:153] - Request 5ca1de41: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:10:40,831 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== AUDIO ANALYSIS ===
2025-02-12 20:10:40,831 - services.translation_strategy - INFO - [translation_strategy.py:48] - Selected strategy based on content type: speech_only
2025-02-12 20:10:40,831 - services.translation_routes - INFO - [translation_routes.py:165] - Request 5ca1de41: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'speech': {'consistency': 1.0}}}
2025-02-12 20:10:40,831 - services.translation_routes - INFO - [translation_routes.py:167] - Request 5ca1de41: Audio processed successfully
2025-02-12 20:10:40,910 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:10:44,409 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-12 20:10:44,409 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 20:10:44,410 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpep1p10et/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '0784396568729496836'}}}
2025-02-12 20:10:46,075 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:10:46,075 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:10:55,026 - services.audio_link_routes - ERROR - [audio_link_routes.py:175] - Download error for tiktok: [0;31mERROR:[0m [TikTok] 7138576512512478510: Unable to download webpage: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')) (caused by TransportError("('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))"))
2025-02-12 20:10:55,027 - services.audio_link_routes - ERROR - [audio_link_routes.py:182] - tiktok processing error: Unable to access this TikTok content. Please try another video or check the URL.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connection.py", line 464, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/requests/adapters.py", line 589, in send
    resp = conn.urlopen(
           ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connectionpool.py", line 843, in urlopen
    retries = retries.increment(
              ^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/util/retry.py", line 449, in increment
    raise reraise(type(error), error, _stacktrace)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/util/util.py", line 38, in reraise
    raise value.with_traceback(tb)
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connectionpool.py", line 789, in urlopen
    response = self._make_request(
               ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connectionpool.py", line 536, in _make_request
    response = conn.getresponse()
               ^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/urllib3/connection.py", line 464, in getresponse
    httplib_response = super().getresponse()
                       ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 1428, in getresponse
    response.begin()
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 331, in begin
    version, status, reason = self._read_status()
                              ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/http/client.py", line 300, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
urllib3.exceptions.ProtocolError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_requests.py", line 328, in _send
    requests_res = session.request(
                   ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/requests/sessions.py", line 589, in request
    resp = self.send(prep, **send_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/requests/sessions.py", line 703, in send
    r = adapter.send(request, **kwargs)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/requests/adapters.py", line 604, in send
    raise ConnectionError(err, request=request)
requests.exceptions.ConnectionError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 898, in _request_webpage
    return self._downloader.urlopen(self._create_request(url_or_request, data, headers, query, extensions))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 4175, in urlopen
    return self._request_director.send(req)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 117, in send
    response = handler.send(request)
               ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_helper.py", line 208, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/common.py", line 340, in send
    return self._send(request)
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/networking/_requests.py", line 352, in _send
    raise TransportError(cause=e) from e
yt_dlp.networking.exceptions.TransportError: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1772, in __extract_info
    ie_result = ie.extract(url)
                ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 742, in extract
    ie_result = self._real_extract(url)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 894, in _real_extract
    video_data, status = self._extract_web_data_and_status(url, video_id)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 222, in _extract_web_data_and_status
    res = self._download_webpage_handle(url, video_id, fatal=fatal, headers={'User-Agent': 'Mozilla/5.0'})
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 962, in _download_webpage_handle
    urlh = self._request_webpage(url_or_request, video_id, note, errnote, fatal, data=data,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 911, in _request_webpage
    raise ExtractorError(errmsg, cause=err)
yt_dlp.utils.ExtractorError: [TikTok] 7138576512512478510: Unable to download webpage: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')) (caused by TransportError("('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 125, in handle_video_platform_url
    info = ydl.extract_info(url, download=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1655, in wrapper
    self.report_error(str(e), e.format_traceback())
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m [TikTok] 7138576512512478510: Unable to download webpage: ('Connection aborted.', RemoteDisconnected('Remote end closed connection without response')) (caused by TransportError("('Connection aborted.', RemoteDisconnected('Remote end closed connection without response'))"))

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 177, in handle_video_platform_url
    raise Exception(f"Unable to access this TikTok content. Please try another video or check the URL.")
Exception: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-12 20:10:55,030 - services.audio_link_routes - ERROR - [audio_link_routes.py:250] - Processing error: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-12 20:10:55,030 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 10.62s, Memory Change: 2352.00MB
2025-02-12 20:10:55,030 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 10.62s
2025-02-12 20:11:02,436 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:11:02,436 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:11:23,920 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:11:23,920 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:11:23,922 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request b0cdf8af
2025-02-12 20:11:23,922 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:11:23,922 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:11:23,926 - services.translation_routes - INFO - [translation_routes.py:97] - Request b0cdf8af: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpql2dhrmv.wav
2025-02-12 20:11:23,927 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-12 20:11:23,927 - services.translation_routes - INFO - [translation_routes.py:112] - Request b0cdf8af: Beginning audio processing with diagnostics
2025-02-12 20:11:23,927 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpql2dhrmv.wav
2025-02-12 20:11:23,927 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:11:23,931 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 20:11:24,012 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:11:24,032 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:11:24,033 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:11:24,172 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:11:24,309 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:24,310 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:24,353 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:24,353 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:24,393 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:24,394 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:24,433 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:24,434 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:28,911 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:11:28,911 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:11:28,911 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: b0cdf8af
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:11:28,912 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:11:28,912 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpql2dhrmv.wav
2025-02-12 20:11:28,912 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:11:28,916 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 20:11:28,999 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:11:29,020 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:11:29,020 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:11:29,160 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:11:29,307 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:29,308 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:29,358 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:29,359 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:29,417 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:29,418 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:29,491 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:29,492 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:33,967 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:11:33,968 - services.translation_routes - INFO - [translation_routes.py:153] - Request b0cdf8af: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:11:33,968 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== AUDIO ANALYSIS ===
2025-02-12 20:11:33,968 - services.translation_strategy - INFO - [translation_strategy.py:48] - Selected strategy based on content type: speech_only
2025-02-12 20:11:33,968 - services.translation_routes - INFO - [translation_routes.py:165] - Request b0cdf8af: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'speech': {'consistency': 1.0}}}
2025-02-12 20:11:33,968 - services.translation_routes - INFO - [translation_routes.py:167] - Request b0cdf8af: Audio processed successfully
2025-02-12 20:11:34,071 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:11:42,340 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 1.48MB
2025-02-12 20:11:42,342 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.01s
2025-02-12 20:11:42,347 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510?lang=en
2025-02-12 20:11:42,348 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 20:11:42,349 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgdrsy8uq/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '8947261265372963620'}}}
2025-02-12 20:11:44,831 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:11:44,832 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:11:44,835 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request fb79f523
2025-02-12 20:11:44,836 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:11:44,836 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:11:44,837 - services.translation_routes - INFO - [translation_routes.py:97] - Request fb79f523: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpzhkmzhnk.wav
2025-02-12 20:11:44,840 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-12 20:11:44,841 - services.translation_routes - INFO - [translation_routes.py:112] - Request fb79f523: Beginning audio processing with diagnostics
2025-02-12 20:11:44,841 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpzhkmzhnk.wav
2025-02-12 20:11:44,841 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:11:44,846 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 20:11:44,868 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:11:44,883 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:11:44,883 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:11:44,902 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:11:44,930 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:44,936 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:44,946 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:44,947 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:44,956 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:44,957 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:44,970 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:44,970 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:45,198 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: fb79f523
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:11:45,198 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:11:45,198 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpzhkmzhnk.wav
2025-02-12 20:11:45,198 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:11:45,199 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 20:11:45,207 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:11:45,210 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:11:45,210 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:11:45,224 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:11:45,236 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:45,237 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:45,242 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:45,242 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:45,249 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:45,249 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:45,271 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:11:45,271 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:11:45,506 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:11:45,506 - services.translation_routes - INFO - [translation_routes.py:153] - Request fb79f523: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:11:45,506 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== AUDIO ANALYSIS ===
2025-02-12 20:11:45,506 - services.translation_strategy - INFO - [translation_strategy.py:48] - Selected strategy based on content type: speech_only
2025-02-12 20:11:45,506 - services.translation_routes - INFO - [translation_routes.py:165] - Request fb79f523: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'speech': {'consistency': 1.0}}}
2025-02-12 20:11:45,506 - services.translation_routes - INFO - [translation_routes.py:167] - Request fb79f523: Audio processed successfully
2025-02-12 20:11:45,526 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:11:46,741 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 20:11:46,743 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgdrsy8uq/output.wav
2025-02-12 20:11:46,796 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:11:46,799 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:11:46,801 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.45s, Memory Change: -3139.25MB
2025-02-12 20:11:46,802 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 4.46s
2025-02-12 20:11:48,200 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:11:48,202 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:11:58,351 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-12 20:12:13,791 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-12 20:12:17,090 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-12 20:12:37,084 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:12:37,085 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:12:40,879 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:12:40,908 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:12:40,909 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:12:40,921 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:12:40,922 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:12:40,932 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:12:40,932 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:12:40,939 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:12:40,940 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:12:41,202 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: fb79f523
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:12:41,204 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.486
- Avg Amplitude: 0.051
- Rms Level: 0.086
- Crest Factor: 5.669
- Zero Crossings: 12968.000
- Silence Percentage: 13.864
- Clipping Points: 0.000
- Dynamic Range: 247.996

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.291
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.022
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.230
  - Volume Range: 359.119
  - Volume Variations: 0.052

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.030218293829171
- Background Noise: 3.267528031229878
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7614728808403015, 'stability': 3.4609193801879883, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.02363424003124237, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.524
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:12:41,205 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:12:41,205 - services.translation_routes - INFO - [translation_routes.py:307] - Request fb79f523: Audio output processed successfully
2025-02-12 20:12:41,210 - services.translation_routes - INFO - [translation_routes.py:362] - Request fb79f523: Response prepared successfully
2025-02-12 20:12:41,211 - services.translation_routes - INFO - [translation_routes.py:375] - Request fb79f523 completed in 56.38s
2025-02-12 20:12:41,212 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 56.38s, Memory Change: 2679.05MB
2025-02-12 20:12:41,213 - __main__ - INFO - [app.py:278] - Request to /translate took 133.90s
2025-02-12 20:12:57,354 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no hurricane willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 20:13:08,449 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: [Musique épique, chanteuse et comédienne qui a fait de l'humour dans le monde entier en faisant du bruit d'un coup de poing sur son visage et ses doigts.]
2025-02-12 20:13:12,508 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:13:12,508 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:13:12,529 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 5ca2acd2
2025-02-12 20:13:12,530 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:13:12,531 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:13:12,536 - services.translation_routes - INFO - [translation_routes.py:97] - Request 5ca2acd2: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmunspaxy.wav
2025-02-12 20:13:12,537 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-12 20:13:12,537 - services.translation_routes - INFO - [translation_routes.py:112] - Request 5ca2acd2: Beginning audio processing with diagnostics
2025-02-12 20:13:12,537 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmunspaxy.wav
2025-02-12 20:13:12,537 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:13:12,545 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 20:13:12,731 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:13:12,777 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:13:12,777 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:13:12,983 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:13:13,163 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:13,164 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:13,242 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:13,243 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:13,305 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:13,305 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:13,383 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:13,384 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:16,910 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:13:16,910 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:13:16,910 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:13:16,910 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:13:16,910 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 5ca2acd2
2025-02-12 20:13:16,911 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:13:16,911 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:13:16,911 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:13:16,911 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:13:16,911 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmunspaxy.wav
2025-02-12 20:13:16,912 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:13:16,919 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 20:13:17,024 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:13:17,047 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:13:17,047 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:13:17,225 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:13:17,402 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:17,402 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:17,453 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:17,454 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:17,504 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:17,504 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:17,550 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:13:17,551 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:13:20,902 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:13:20,903 - services.translation_routes - INFO - [translation_routes.py:153] - Request 5ca2acd2: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:13:20,904 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== AUDIO ANALYSIS ===
2025-02-12 20:13:20,905 - services.translation_strategy - INFO - [translation_strategy.py:48] - Selected strategy based on content type: speech_only
2025-02-12 20:13:20,905 - services.translation_routes - INFO - [translation_routes.py:165] - Request 5ca2acd2: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0}, 'speech': {'consistency': 1.0}}}
2025-02-12 20:13:20,905 - services.translation_routes - INFO - [translation_routes.py:167] - Request 5ca2acd2: Audio processed successfully
2025-02-12 20:13:21,155 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:14:33,020 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:14:33,057 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:14:33,062 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:14:33,067 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:14:33,067 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:14:33,072 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:14:33,072 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:14:33,076 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:14:33,076 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:14:33,228 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:14:33,229 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 5ca1de41
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.491
- Avg Amplitude: 0.048
- Rms Level: 0.084
- Crest Factor: 5.877
- Zero Crossings: 5807.000
- Silence Percentage: 26.909
- Clipping Points: 0.000
- Dynamic Range: 1081.070

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.265
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.020
  - Temporal Flatness: 0.011

- Volume Metrics:
  - Volume Stability: 0.119
  - Volume Range: 1809.274
  - Volume Variations: 0.055

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.028432040456405
- Background Noise: 3.350780007520995
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.5262940526008606, 'stability': 2.6882009506225586, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.6766407489776611, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.547
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 1.000

Vowel Quality:
  - Quality Score: 0.002
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:14:33,230 - services.translation_routes - INFO - [translation_routes.py:307] - Request 5ca1de41: Audio output processed successfully
2025-02-12 20:14:33,238 - services.translation_routes - INFO - [translation_routes.py:362] - Request 5ca1de41: Response prepared successfully
2025-02-12 20:14:33,239 - services.translation_routes - INFO - [translation_routes.py:375] - Request 5ca1de41 completed in 239.78s
2025-02-12 20:14:33,241 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 239.78s, Memory Change: 2280.25MB
2025-02-12 20:14:33,241 - __main__ - INFO - [app.py:278] - Request to /translate took 289.41s
2025-02-12 20:14:39,157 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: hop along my little friends up with you windows toms going on ahead candles for the king down the west since the sun soon you will be broken when the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no horry willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 20:15:17,467 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: This photo doesn't make sense. There's a plane that takes you up in the air and it feels like the passengers are floating. My goal was to throw them all into the air when we were at the peak of the pharaoh, weightless and I would be floating around in the center of my work. We couldn't believe it. It's one of those things where I can describe it as much as I want, but until you experience it, there's nothing like it. That's why I felt captured the epitome of this project. A photo that on paper makes no fucking sense and shouldn't be possible.
2025-02-12 20:16:22,507 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: C'est une sorte de réalité irréaliste que j'ai capturé l'épitome de ce projet et c'est pourquoi cette photo qui sur papier fait pas de putain de sens et ne devrait pas être possible est 99 originaux.
2025-02-12 20:16:42,537 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:16:42,627 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:16:42,632 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:16:42,659 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:16:42,660 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:16:42,689 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:16:42,690 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:16:42,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:16:42,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:16:43,240 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: b0cdf8af
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.722
- Avg Amplitude: 0.071
- Rms Level: 0.103
- Crest Factor: 7.041
- Zero Crossings: 31820.000
- Silence Percentage: 4.841
- Clipping Points: 0.000
- Dynamic Range: 61.966

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.120
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.429
  - Volume Range: 237.150
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.029130313833293
- Background Noise: 3.8165179908666933
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8817693591117859, 'stability': 3.67570161819458, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.1192183643579483, 'consistency': 0.0, 'distinction': 0.08945657312870026}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.524
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:16:43,242 - services.translation_routes - INFO - [translation_routes.py:307] - Request b0cdf8af: Audio output processed successfully
2025-02-12 20:16:43,260 - services.translation_routes - INFO - [translation_routes.py:362] - Request b0cdf8af: Response prepared successfully
2025-02-12 20:16:43,261 - services.translation_routes - INFO - [translation_routes.py:375] - Request b0cdf8af completed in 319.34s
2025-02-12 20:16:43,263 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 319.34s, Memory Change: 2064.50MB
2025-02-12 20:16:43,263 - __main__ - INFO - [app.py:278] - Request to /translate took 400.74s
2025-02-12 20:17:36,428 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:17:36,440 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:17:36,441 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:17:36,443 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:17:36,443 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:17:36,449 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:17:36,450 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:17:36,453 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:17:36,453 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:17:36,614 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 5ca2acd2
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.570
- Avg Amplitude: 0.057
- Rms Level: 0.092
- Crest Factor: 6.223
- Zero Crossings: 13629.000
- Silence Percentage: 13.938
- Clipping Points: 0.000
- Dynamic Range: 255.056

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.222
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.299
  - Volume Range: 497.524
  - Volume Variations: 0.053

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0294464515987425
- Background Noise: 3.4891376229853583
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8165563344955444, 'stability': 3.2650957107543945, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.12756653130054474, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.445
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:17:36,614 - services.translation_routes - INFO - [translation_routes.py:307] - Request 5ca2acd2: Audio output processed successfully
2025-02-12 20:17:36,618 - services.translation_routes - INFO - [translation_routes.py:362] - Request 5ca2acd2: Response prepared successfully
2025-02-12 20:17:36,618 - services.translation_routes - INFO - [translation_routes.py:375] - Request 5ca2acd2 completed in 264.09s
2025-02-12 20:17:36,620 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 264.09s, Memory Change: -1890.73MB
2025-02-12 20:17:36,620 - __main__ - INFO - [app.py:278] - Request to /translate took 348.42s
2025-02-12 20:29:50,171 - __main__ - INFO - [app.py:217] - Received SIGINT signal
2025-02-12 20:29:50,173 - __main__ - INFO - [app.py:202] - Initiating graceful shutdown...
2025-02-12 20:29:55,177 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:29:55,178 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:29:55,179 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:29:55,183 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:29:55,184 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:29:55,184 - __main__ - INFO - [app.py:206] - Graceful shutdown completed
2025-02-12 20:29:55,185 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:29:55,186 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:29:55,186 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:29:55,186 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:29:55,187 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:29:55,188 - __main__ - INFO - [app.py:436] - Application shutting down...
2025-02-12 20:29:55,188 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-12 20:29:55,188 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-12 20:29:55,189 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:29:55,189 - __main__ - INFO - [app.py:450] - Cleanup completed successfully
2025-02-12 20:30:59,947 - __main__ - INFO - [app.py:467] - Metrics server started on port 8000
2025-02-12 20:30:59,948 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-12 20:31:14,125 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-12 20:31:14,125 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:31:14,127 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:31:31,373 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:31:31,374 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:31:51,165 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:31:51,165 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:31:51,167 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-12 20:31:51,167 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:31:51,168 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:32:06,828 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:32:06,828 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:32:27,125 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:32:27,126 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:418] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:491] - ==================================================
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:492] - Starting LinguaSync Backend
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:493] - Starting Flask app on port 5001 using cpu
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:494] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:495] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:496] - Maximum audio length: 300 seconds
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:497] - Sample rate: 16000 Hz
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:501] - System memory: 36.0GB total, 13.1GB available
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:502] - CPU cores: 11
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:510] - Configuration:
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:511] - - Debug mode: False
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:512] - - CORS enabled: True
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:513] - - Rate limiting: 10 requests per minute
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:514] - - Metrics enabled: True (port 8000)
2025-02-12 20:32:27,129 - __main__ - INFO - [app.py:516] - ==================================================
2025-02-12 20:33:16,474 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-12 20:33:16,475 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-12 20:33:16,477 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtube.com/shorts/RFUAVaeEd4I?si=DzwEX49L4Ygty4eu
2025-02-12 20:33:16,477 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 20:33:16,478 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmkq0cjka/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 20:33:23,042 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 20:33:23,044 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmkq0cjka/output.wav
2025-02-12 20:33:23,080 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:33:23,081 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:33:23,081 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.60s, Memory Change: 2.34MB
2025-02-12 20:33:23,081 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.60s
2025-02-12 20:33:24,858 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:33:24,860 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:33:42,681 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:33:42,682 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:33:58,750 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:33:58,751 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:33:58,754 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request bbb90861
2025-02-12 20:33:58,754 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:33:58,754 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:33:58,756 - services.translation_routes - INFO - [translation_routes.py:97] - Request bbb90861: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpm845i4q6.wav
2025-02-12 20:33:58,757 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 52.48 seconds
2025-02-12 20:33:58,757 - services.translation_routes - INFO - [translation_routes.py:112] - Request bbb90861: Beginning audio processing with diagnostics
2025-02-12 20:33:58,757 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpm845i4q6.wav
2025-02-12 20:33:58,757 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:33:58,760 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 20:33:58,806 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:33:58,824 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:33:58,824 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:33:58,887 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:33:58,975 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:33:58,976 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:33:58,991 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:33:58,991 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:33:59,007 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:33:59,007 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:33:59,024 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:33:59,025 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:34:00,425 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://youtu.be/xDYy5qafTXY?si=bPvmOIPxuc7fvs-Z
2025-02-12 20:34:00,427 - services.audio_link_routes - INFO - [audio_link_routes.py:233] - Processing YouTube URL
2025-02-12 20:34:00,430 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp4cxqyr2/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8}
2025-02-12 20:34:01,023 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:34:01,023 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:34:01,023 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:34:01,023 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:34:01,023 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: bbb90861
2025-02-12 20:34:01,024 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:34:01,024 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:34:01,024 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.038
- Rms Level: 0.066
- Crest Factor: 14.422
- Zero Crossings: 335957.000
- Silence Percentage: 25.137
- Clipping Points: 0.000
- Dynamic Range: 9099014.583

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 0.000
  - Temporal Variation: 0.101
  - Temporal Flatness: 0.048

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 25740829.110
  - Volume Variations: 0.040

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.009134430002693
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0607566833496094, 'stability': 1.490928292274475, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.6918656826019287, 'distinction': 0.06730042397975922}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.775
  - Rhythm Quality: 0.812
  - Intonation Quality: 0.738

Vowel Quality:
  - Quality Score: 0.013
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:34:01,024 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:34:01,024 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpm845i4q6.wav
2025-02-12 20:34:01,024 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:34:01,027 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 839634]), Frequency: 16000Hz
2025-02-12 20:34:01,068 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:34:01,080 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:34:01,081 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:34:01,146 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:34:01,234 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:34:01,234 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:34:01,253 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:34:01,253 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:34:01,272 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:34:01,272 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:34:01,291 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:34:01,292 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:34:03,925 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:34:03,927 - services.translation_routes - INFO - [translation_routes.py:153] - Request bbb90861: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3547474247335353, 'feature_scores': {'spectral_flatness': 0.1747071146868413, 'rhythm_regularity': 0.029706601466992662, 'bass_presence': 0.07999731566149255, 'temporal_stability': 0.0703363929182088}}
2025-02-12 20:34:03,927 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-12 20:34:03,927 - services.translation_strategy - INFO - [translation_strategy.py:25] - 
    Music Detection:
    - Has Background Music: False
    - Music Confidence: 0.000
    - Feature Scores:
    • Spectral Flatness: 0.000
    • Rhythm Regularity: 0.000
    • Bass Presence: 0.000
    • Temporal Stability: 0.000
            
2025-02-12 20:34:03,928 - services.translation_strategy - INFO - [translation_strategy.py:38] - 
    Audio Quality Metrics:
    - Audio Clarity: 3.009
    - Background Noise: 5.000
    - Voice Consistency: 1.000
            
2025-02-12 20:34:03,928 - services.translation_strategy - INFO - [translation_strategy.py:51] - Content Type Decision: speech_only (Low music confidence)
2025-02-12 20:34:03,928 - services.translation_strategy - INFO - [translation_strategy.py:54] - 
    Decision Factors:
    - Music Confidence Threshold: 0.4
    - Current Music Confidence: 0.000
    - Has Background Music Flag: False
    - Selected Type: speech_only
            
2025-02-12 20:34:03,928 - services.translation_routes - INFO - [translation_routes.py:165] - Request bbb90861: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0, 'feature_scores': {}}, 'speech': {'consistency': 1.0, 'clarity': 3.009134430002693, 'background_noise': 5.0}}}
2025-02-12 20:34:03,928 - services.translation_routes - INFO - [translation_routes.py:167] - Request bbb90861: Audio processed successfully
2025-02-12 20:34:03,973 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:34:07,163 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded youtube content
2025-02-12 20:34:07,165 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpp4cxqyr2/output.wav
2025-02-12 20:34:07,207 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:34:07,208 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:34:07,209 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 6.78s, Memory Change: 1073.56MB
2025-02-12 20:34:07,209 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 6.78s
2025-02-12 20:34:17,106 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:34:17,107 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:34:34,070 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?is_from_webapp=1&sender_device=pc&web_id=7470222526028858902
2025-02-12 20:34:34,070 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 20:34:34,070 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpetnmegw3/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '0034211154471541367'}}}
2025-02-12 20:34:37,848 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 20:34:37,850 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpetnmegw3/output.wav
2025-02-12 20:34:37,855 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:34:37,856 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:34:37,856 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.79s, Memory Change: 126.05MB
2025-02-12 20:34:37,856 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.79s
2025-02-12 20:34:41,145 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:34:41,146 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:34:46,193 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:34:46,194 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:35:02,648 - services.audio_link_routes - INFO - [audio_link_routes.py:216] - Processing URL: https://www.tiktok.com/@loganpaul/video/7138576512512478510
2025-02-12 20:35:02,650 - services.audio_link_routes - INFO - [audio_link_routes.py:236] - Processing TikTok URL
2025-02-12 20:35:02,650 - services.audio_link_routes - INFO - [audio_link_routes.py:120] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpipnz0ojk/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '4211673511393130213'}}}
2025-02-12 20:35:06,059 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The main thing is to make sure you're balanced on both feet, hands up, elbows in, a lot of people box with their elbows like this, no elbow in, and it really comes out like this as it comes out, it turns straight back to your chin when it's coming out, make sure your shoulder hits your chin, so it protects you, and turn it as it came out, turn it slightly, so you hit it with all four knuckles right here, and this right hand has to stay there.
2025-02-12 20:35:06,217 - services.audio_link_routes - INFO - [audio_link_routes.py:133] - Successfully downloaded tiktok content
2025-02-12 20:35:06,219 - services.audio_link_routes - INFO - [audio_link_routes.py:152] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpipnz0ojk/output.wav
2025-02-12 20:35:06,287 - services.audio_link_routes - INFO - [audio_link_routes.py:164] - Successfully converted audio to WAV
2025-02-12 20:35:06,288 - services.audio_link_routes - INFO - [audio_link_routes.py:242] - Successfully processed audio
2025-02-12 20:35:06,289 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.64s, Memory Change: -132.80MB
2025-02-12 20:35:06,289 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.64s
2025-02-12 20:35:16,093 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:35:16,094 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:35:16,113 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request e34cf630
2025-02-12 20:35:16,113 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:35:16,113 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:35:16,119 - services.translation_routes - INFO - [translation_routes.py:97] - Request e34cf630: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmrdqybtn.wav
2025-02-12 20:35:16,120 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 69.18 seconds
2025-02-12 20:35:16,120 - services.translation_routes - INFO - [translation_routes.py:112] - Request e34cf630: Beginning audio processing with diagnostics
2025-02-12 20:35:16,120 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmrdqybtn.wav
2025-02-12 20:35:16,120 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:35:16,125 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 20:35:16,237 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:35:16,277 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:35:16,278 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:35:16,504 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:35:16,879 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:16,887 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:16,962 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:16,963 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:17,038 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:17,038 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:17,098 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:17,099 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:21,549 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: e34cf630
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.069
- Rms Level: 0.114
- Crest Factor: 8.317
- Zero Crossings: 294432.000
- Silence Percentage: 23.702
- Clipping Points: 0.000
- Dynamic Range: 17318057.992

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.095
  - Temporal Flatness: 0.054

- Volume Metrics:
  - Volume Stability: 0.207
  - Volume Range: 39045333.862
  - Volume Variations: 0.071

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027470416722832
- Background Noise: 4.326625974972339
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8366706967353821, 'stability': 1.8690263032913208, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.5019978880882263, 'consistency': 0.290225088596344, 'distinction': 0.2739231586456299}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.406
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.234
  - Rhythm Quality: 0.390
  - Intonation Quality: 0.078

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:35:21,549 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:35:21,550 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmrdqybtn.wav
2025-02-12 20:35:21,550 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:35:21,554 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1106919]), Frequency: 16000Hz
2025-02-12 20:35:21,629 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:35:21,648 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:35:21,649 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:35:21,796 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:35:21,939 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:21,939 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:21,983 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:21,984 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:22,040 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:22,041 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:22,099 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:35:22,099 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:35:24,996 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:35:25,027 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:35:26,702 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:35:26,702 - services.translation_routes - INFO - [translation_routes.py:153] - Request e34cf630: Background music analysis: {'has_background_music': False, 'music_confidence': 0.20938998197072828, 'feature_scores': {'spectral_flatness': 0.08400185351212022, 'rhythm_regularity': 0.023911028730305837, 'bass_presence': 0.020109010040956245, 'temporal_stability': 0.08136808968734596}}
2025-02-12 20:35:26,703 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-12 20:35:26,703 - services.translation_strategy - INFO - [translation_strategy.py:25] - 
    Music Detection:
    - Has Background Music: False
    - Music Confidence: 0.000
    - Feature Scores:
    • Spectral Flatness: 0.000
    • Rhythm Regularity: 0.000
    • Bass Presence: 0.000
    • Temporal Stability: 0.000
            
2025-02-12 20:35:26,703 - services.translation_strategy - INFO - [translation_strategy.py:38] - 
    Audio Quality Metrics:
    - Audio Clarity: 3.027
    - Background Noise: 4.327
    - Voice Consistency: 1.000
            
2025-02-12 20:35:26,703 - services.translation_strategy - INFO - [translation_strategy.py:51] - Content Type Decision: speech_only (Low music confidence)
2025-02-12 20:35:26,703 - services.translation_strategy - INFO - [translation_strategy.py:54] - 
    Decision Factors:
    - Music Confidence Threshold: 0.4
    - Current Music Confidence: 0.000
    - Has Background Music Flag: False
    - Selected Type: speech_only
            
2025-02-12 20:35:26,703 - services.translation_routes - INFO - [translation_routes.py:165] - Request e34cf630: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0, 'feature_scores': {}}, 'speech': {'consistency': 1.0, 'clarity': 3.027470416722832, 'background_noise': 4.326625974972339}}}
2025-02-12 20:35:26,703 - services.translation_routes - INFO - [translation_routes.py:167] - Request e34cf630: Audio processed successfully
2025-02-12 20:35:26,788 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:35:44,469 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-12 20:35:44,471 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-12 20:35:56,056 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: [Musique épique, chanteuse et comédienne qui a fait de l'humour dans le monde entier en faisant du bruit d'un coup de poing sur son visage et ses doigts.]
2025-02-12 20:36:20,252 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:36:20,254 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:36:20,265 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 9102e327
2025-02-12 20:36:20,266 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:36:20,266 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:36:20,268 - services.translation_routes - INFO - [translation_routes.py:97] - Request 9102e327: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgq7q358d.wav
2025-02-12 20:36:20,273 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-12 20:36:20,273 - services.translation_routes - INFO - [translation_routes.py:112] - Request 9102e327: Beginning audio processing with diagnostics
2025-02-12 20:36:20,273 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgq7q358d.wav
2025-02-12 20:36:20,273 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:36:20,276 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 20:36:20,294 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:36:20,306 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:36:20,307 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:36:20,347 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:36:20,387 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,395 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,415 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,415 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,423 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,423 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,432 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,433 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,732 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:36:20,734 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:36:20,734 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:36:20,734 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:36:20,735 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 9102e327
2025-02-12 20:36:20,735 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:36:20,735 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:36:20,735 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:36:20,735 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:36:20,735 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgq7q358d.wav
2025-02-12 20:36:20,736 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:36:20,737 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-12 20:36:20,745 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:36:20,749 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:36:20,749 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:36:20,771 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:36:20,803 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,804 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,816 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,817 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,831 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,831 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:20,840 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:36:20,840 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:36:21,029 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:36:21,029 - services.translation_routes - INFO - [translation_routes.py:153] - Request 9102e327: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}}
2025-02-12 20:36:21,029 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-12 20:36:21,030 - services.translation_strategy - INFO - [translation_strategy.py:25] - 
    Music Detection:
    - Has Background Music: False
    - Music Confidence: 0.000
    - Feature Scores:
    • Spectral Flatness: 0.000
    • Rhythm Regularity: 0.000
    • Bass Presence: 0.000
    • Temporal Stability: 0.000
            
2025-02-12 20:36:21,030 - services.translation_strategy - INFO - [translation_strategy.py:38] - 
    Audio Quality Metrics:
    - Audio Clarity: 3.012
    - Background Noise: 5.000
    - Voice Consistency: 1.000
            
2025-02-12 20:36:21,030 - services.translation_strategy - INFO - [translation_strategy.py:51] - Content Type Decision: speech_only (Low music confidence)
2025-02-12 20:36:21,030 - services.translation_strategy - INFO - [translation_strategy.py:54] - 
    Decision Factors:
    - Music Confidence Threshold: 0.4
    - Current Music Confidence: 0.000
    - Has Background Music Flag: False
    - Selected Type: speech_only
            
2025-02-12 20:36:21,030 - services.translation_routes - INFO - [translation_routes.py:165] - Request 9102e327: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0, 'feature_scores': {}}, 'speech': {'consistency': 1.0, 'clarity': 3.012101101788277, 'background_noise': 5.0}}}
2025-02-12 20:36:21,030 - services.translation_routes - INFO - [translation_routes.py:167] - Request 9102e327: Audio processed successfully
2025-02-12 20:36:21,054 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:36:33,625 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-12 20:36:33,626 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-12 20:36:35,024 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-12 20:36:51,920 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-12 20:36:52,773 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no hurricane willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 20:37:14,631 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:37:14,648 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:14,649 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:14,653 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:14,654 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:14,659 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:14,660 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:14,667 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:14,667 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:14,778 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: bbb90861
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.609
- Avg Amplitude: 0.048
- Rms Level: 0.082
- Crest Factor: 7.390
- Zero Crossings: 5277.000
- Silence Percentage: 21.908
- Clipping Points: 0.000
- Dynamic Range: 568.736

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.076
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.222
  - Volume Range: 641.067
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0223095777227047
- Background Noise: 3.956042662456356
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.518236517906189, 'stability': 2.228264808654785, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.8836628198623657, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.576
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.040
  - Rhythm Quality: 0.000
  - Intonation Quality: 1.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:37:14,779 - services.translation_routes - INFO - [translation_routes.py:307] - Request bbb90861: Audio output processed successfully
2025-02-12 20:37:14,785 - services.translation_routes - INFO - [translation_routes.py:362] - Request bbb90861: Response prepared successfully
2025-02-12 20:37:14,787 - services.translation_routes - INFO - [translation_routes.py:375] - Request bbb90861 completed in 196.03s
2025-02-12 20:37:14,788 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 196.03s, Memory Change: 1830.77MB
2025-02-12 20:37:14,788 - __main__ - INFO - [app.py:278] - Request to /translate took 229.93s
2025-02-12 20:37:16,673 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:37:16,686 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:16,686 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:16,693 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:16,693 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:16,700 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:16,701 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:16,708 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:16,709 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:16,866 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:37:16,866 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:37:16,866 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:37:16,866 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 9102e327
2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.516
- Avg Amplitude: 0.049
- Rms Level: 0.082
- Crest Factor: 6.294
- Zero Crossings: 13044.000
- Silence Percentage: 13.935
- Clipping Points: 0.000
- Dynamic Range: 235.953

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.213
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.023
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.231
  - Volume Range: 344.976
  - Volume Variations: 0.050

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0260597303933654
- Background Noise: 3.5177126415846898
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7092999815940857, 'stability': 3.142971992492676, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.10657326877117157, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.516
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:37:16,867 - services.translation_routes - INFO - [translation_routes.py:307] - Request 9102e327: Audio output processed successfully
2025-02-12 20:37:16,869 - services.translation_routes - INFO - [translation_routes.py:362] - Request 9102e327: Response prepared successfully
2025-02-12 20:37:16,871 - services.translation_routes - INFO - [translation_routes.py:375] - Request 9102e327 completed in 56.61s
2025-02-12 20:37:16,871 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 56.61s, Memory Change: 4084.17MB
2025-02-12 20:37:16,871 - __main__ - INFO - [app.py:278] - Request to /translate took 155.73s
2025-02-12 20:37:23,223 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-12 20:37:23,223 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-12 20:37:23,245 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 481cde04
2025-02-12 20:37:23,246 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-12 20:37:23,247 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-12 20:37:23,254 - services.translation_routes - INFO - [translation_routes.py:97] - Request 481cde04: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdynx9w4q.wav
2025-02-12 20:37:23,255 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 73.49 seconds
2025-02-12 20:37:23,255 - services.translation_routes - INFO - [translation_routes.py:112] - Request 481cde04: Beginning audio processing with diagnostics
2025-02-12 20:37:23,256 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdynx9w4q.wav
2025-02-12 20:37:23,256 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:37:23,273 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 20:37:23,360 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:37:23,385 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:37:23,385 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:37:23,514 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:37:23,691 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:23,692 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:23,746 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:23,747 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:23,785 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:23,786 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:23,825 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:23,825 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:26,690 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 481cde04
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.035
- Rms Level: 0.064
- Crest Factor: 14.883
- Zero Crossings: 397415.000
- Silence Percentage: 25.553
- Clipping Points: 0.000
- Dynamic Range: 8430051.767

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.083
  - Temporal Flatness: 0.038

- Volume Metrics:
  - Volume Stability: 0.155
  - Volume Range: 27185562.253
  - Volume Variations: 0.041

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.008577188259245
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.5588304996490479, 'stability': 2.4418985843658447, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5834342241287231, 'distinction': 0.13374167680740356}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.559
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.713
  - Rhythm Quality: 0.702
  - Intonation Quality: 0.724

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:37:26,690 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-12 20:37:26,690 - services.audio_processor - INFO - [audio_processor.py:269] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdynx9w4q.wav
2025-02-12 20:37:26,690 - services.audio_processor - INFO - [audio_processor.py:271] - Audio info - Sample rate: 16000, Channels: 1
2025-02-12 20:37:26,695 - services.audio_processor - INFO - [audio_processor.py:280] - Original audio shape: torch.Size([1, 1175881]), Frequency: 16000Hz
2025-02-12 20:37:26,767 - services.audio_processor - INFO - [audio_processor.py:438] - Base audio processing successful, proceeding with enhancement
2025-02-12 20:37:26,787 - services.audio_processor - INFO - [audio_processor.py:446] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:37:26,788 - services.audio_processor - INFO - [audio_processor.py:449] - Applying speech-optimized spectral enhancement for fra
2025-02-12 20:37:26,908 - services.audio_processor - INFO - [audio_processor.py:459] - Analyzing audio quality...
2025-02-12 20:37:27,085 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:27,086 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:27,125 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:27,125 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:27,166 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:27,166 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:27,203 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:37:27,203 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:37:30,071 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:37:30,073 - services.translation_routes - INFO - [translation_routes.py:153] - Request 481cde04: Background music analysis: {'has_background_music': True, 'music_confidence': 0.4059628791204464, 'feature_scores': {'spectral_flatness': 0.1651322301984485, 'rhythm_regularity': 0.026939843068875327, 'bass_presence': 0.144706807566402, 'temporal_stability': 0.0691839982867205}}
2025-02-12 20:37:30,073 - services.translation_strategy - INFO - [translation_strategy.py:17] - 
=== DETAILED AUDIO ANALYSIS ===
2025-02-12 20:37:30,073 - services.translation_strategy - INFO - [translation_strategy.py:25] - 
    Music Detection:
    - Has Background Music: False
    - Music Confidence: 0.000
    - Feature Scores:
    • Spectral Flatness: 0.000
    • Rhythm Regularity: 0.000
    • Bass Presence: 0.000
    • Temporal Stability: 0.000
            
2025-02-12 20:37:30,073 - services.translation_strategy - INFO - [translation_strategy.py:38] - 
    Audio Quality Metrics:
    - Audio Clarity: 3.009
    - Background Noise: 5.000
    - Voice Consistency: 1.000
            
2025-02-12 20:37:30,073 - services.translation_strategy - INFO - [translation_strategy.py:51] - Content Type Decision: speech_only (Low music confidence)
2025-02-12 20:37:30,073 - services.translation_strategy - INFO - [translation_strategy.py:54] - 
    Decision Factors:
    - Music Confidence Threshold: 0.4
    - Current Music Confidence: 0.000
    - Has Background Music Flag: False
    - Selected Type: speech_only
            
2025-02-12 20:37:30,073 - services.translation_routes - INFO - [translation_routes.py:165] - Request 481cde04: Audio characteristics heard: {'content_type': 'speech_only', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.0, 'feature_scores': {}}, 'speech': {'consistency': 1.0, 'clarity': 3.008577188259245, 'background_noise': 5.0}}}
2025-02-12 20:37:30,073 - services.translation_routes - INFO - [translation_routes.py:167] - Request 481cde04: Audio processed successfully
2025-02-12 20:37:30,159 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-12 20:38:14,226 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: hop along my little friends up with you windows toms going on ahead candles for the king down the west since the sun soon you will be broken when the night shadows fall then the door will open out of the window paints light will twinkle yellow fear no all the black heed no horry willow fear neither root nor bow tom goes on before you hey now mary do we'll be waiting for you
2025-02-12 20:39:14,259 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: This photo doesn't make sense. There's a plane that takes you up in the air and it feels like the passengers are floating. My goal was to throw them all into the air when we were at the peak of the pharaoh, weightless and I would be floating around in the center of my work. We couldn't believe it. It's one of those things where I can describe it as much as I want, but until you experience it, there's nothing like it. That's why I felt captured the epitome of this project. A photo that on paper makes no fucking sense and shouldn't be possible.
2025-02-12 20:40:11,808 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:40:11,875 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:40:11,880 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:40:11,898 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:40:11,898 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:40:11,909 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:40:11,909 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:40:11,923 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:40:11,924 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:40:12,431 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: e34cf630
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.626
- Avg Amplitude: 0.069
- Rms Level: 0.099
- Crest Factor: 6.307
- Zero Crossings: 30482.000
- Silence Percentage: 5.838
- Clipping Points: 0.000
- Dynamic Range: 75.481

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.212
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.455
  - Volume Range: 257.790
  - Volume Variations: 0.048

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.031458383312468
- Background Noise: 3.522693980338069
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8064621090888977, 'stability': 3.3954358100891113, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.1031906008720398}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.534
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:40:12,433 - services.translation_routes - INFO - [translation_routes.py:307] - Request e34cf630: Audio output processed successfully
2025-02-12 20:40:12,442 - services.translation_routes - INFO - [translation_routes.py:362] - Request e34cf630: Response prepared successfully
2025-02-12 20:40:12,443 - services.translation_routes - INFO - [translation_routes.py:375] - Request e34cf630 completed in 296.33s
2025-02-12 20:40:12,446 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 296.33s, Memory Change: -3043.77MB
2025-02-12 20:40:12,447 - __main__ - INFO - [app.py:278] - Request to /translate took 355.34s
2025-02-12 20:40:15,906 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: C'est une sorte de réalité irréaliste que j'ai capturé l'épitome de ce projet et c'est pourquoi cette photo qui sur papier fait pas de putain de sens et ne devrait pas être possible est 99 originaux.
2025-02-12 20:41:22,903 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-12 20:41:22,919 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:41:22,920 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:41:22,924 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:41:22,924 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:41:22,929 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:41:22,929 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:41:22,934 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-12 20:41:22,935 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-12 20:41:23,158 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 481cde04
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.751
- Avg Amplitude: 0.060
- Rms Level: 0.099
- Crest Factor: 7.578
- Zero Crossings: 18572.000
- Silence Percentage: 14.740
- Clipping Points: 0.000
- Dynamic Range: 308.337

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.053
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.235
  - Volume Range: 905.950
  - Volume Variations: 0.060

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0261393678138955
- Background Noise: 4.031317414804144
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.9494515657424927, 'stability': 3.792532444000244, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.21919751167297363}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.511
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-12 20:41:23,158 - services.translation_routes - INFO - [translation_routes.py:307] - Request 481cde04: Audio output processed successfully
2025-02-12 20:41:23,163 - services.translation_routes - INFO - [translation_routes.py:362] - Request 481cde04: Response prepared successfully
2025-02-12 20:41:23,163 - services.translation_routes - INFO - [translation_routes.py:375] - Request 481cde04 completed in 239.92s
2025-02-12 20:41:23,166 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 239.92s, Memory Change: -4832.94MB
2025-02-12 20:41:23,166 - __main__ - INFO - [app.py:278] - Request to /translate took 338.70s
