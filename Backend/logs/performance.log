2025-02-18 19:32:27,977 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 0d94d87d
2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.708
- Avg Amplitude: 0.057
- Rms Level: 0.090
- Crest Factor: 7.820
- Zero Crossings: 34533.000
- Silence Percentage: 11.006
- Clipping Points: 0.000
- Dynamic Range: 175.145

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.022
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.024
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.277
  - Volume Range: 2134.720
  - Volume Variations: 0.053

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0231415262991805
- Background Noise: 4.128199983335148
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.6917094588279724, 'stability': 3.1294496059417725, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.11399541050195694}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.505
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.002
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 19:32:27,978 - services.translation_routes - INFO - [translation_routes.py:307] - Request 0d94d87d: Audio output processed successfully
2025-02-18 19:32:27,983 - services.translation_routes - INFO - [translation_routes.py:362] - Request 0d94d87d: Response prepared successfully
2025-02-18 19:32:27,983 - services.translation_routes - INFO - [translation_routes.py:375] - Request 0d94d87d completed in 98.72s
2025-02-18 19:32:27,986 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 98.72s, Memory Change: 1166.20MB
2025-02-18 19:32:27,986 - __main__ - INFO - [app.py:278] - Request to /translate took 133.37s
2025-02-18 19:34:32,682 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 19:34:32,684 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 19:34:32,690 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://youtu.be/jNQXAC9IVRw?si=nRWejda1kfIJUO8z
2025-02-18 19:34:32,691 - services.audio_link_routes - INFO - [audio_link_routes.py:243] - Processing YouTube URL
2025-02-18 19:34:32,691 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpynztapys/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True}
2025-02-18 19:34:33,528 - services.audio_link_routes - ERROR - [audio_link_routes.py:185] - Download error for youtube: [0;31mERROR:[0m [youtube] jNQXAC9IVRw: Sign in to confirm you’re not a bot. Use --cookies-from-browser or --cookies for the authentication. See  https://github.com/yt-dlp/yt-dlp/wiki/FAQ#how-do-i-pass-cookies-to-yt-dlp  for how to manually pass cookies. Also see  https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies  for tips on effectively exporting YouTube cookies
2025-02-18 19:34:33,529 - services.audio_link_routes - ERROR - [audio_link_routes.py:192] - youtube processing error: Unable to access this youtube content. Please check the URL and try again.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1772, in __extract_info
    ie_result = ie.extract(url)
                ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 742, in extract
    ie_result = self._real_extract(url)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/youtube.py", line 4587, in _real_extract
    self.raise_no_formats(reason, expected=True)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 1276, in raise_no_formats
    raise ExtractorError(msg, expected=expected, video_id=video_id)
yt_dlp.utils.ExtractorError: [youtube] jNQXAC9IVRw: Sign in to confirm you’re not a bot. Use --cookies-from-browser or --cookies for the authentication. See  https://github.com/yt-dlp/yt-dlp/wiki/FAQ#how-do-i-pass-cookies-to-yt-dlp  for how to manually pass cookies. Also see  https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies  for tips on effectively exporting YouTube cookies

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 135, in handle_video_platform_url
    info = ydl.extract_info(url, download=False)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1655, in wrapper
    self.report_error(str(e), e.format_traceback())
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m [youtube] jNQXAC9IVRw: Sign in to confirm you’re not a bot. Use --cookies-from-browser or --cookies for the authentication. See  https://github.com/yt-dlp/yt-dlp/wiki/FAQ#how-do-i-pass-cookies-to-yt-dlp  for how to manually pass cookies. Also see  https://github.com/yt-dlp/yt-dlp/wiki/Extractors#exporting-youtube-cookies  for tips on effectively exporting YouTube cookies

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 189, in handle_video_platform_url
    raise Exception(f"Unable to access this {platform} content. Please check the URL and try again.")
Exception: Unable to access this youtube content. Please check the URL and try again.
2025-02-18 19:34:33,531 - services.audio_link_routes - ERROR - [audio_link_routes.py:260] - Processing error: Unable to access this youtube content. Please check the URL and try again.
2025-02-18 19:34:33,532 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.84s, Memory Change: 0.69MB
2025-02-18 19:34:33,533 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.84s
2025-02-18 20:01:39,416 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 20:01:39,416 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 20:01:39,419 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 20:01:39,420 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 20:01:39,420 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmppyzktq4p/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2728801745613313852'}}}
2025-02-18 20:01:41,549 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 20:01:41,550 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmppyzktq4p/output.wav
2025-02-18 20:01:41,573 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 20:01:41,574 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 20:01:41,574 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.16s, Memory Change: 7.50MB
2025-02-18 20:01:41,574 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 2.16s
2025-02-18 20:01:47,233 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 20:01:47,236 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 20:02:07,847 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 20:02:07,848 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 20:02:27,067 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 20:02:27,068 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 20:02:27,071 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 46e0fbc7
2025-02-18 20:02:27,071 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 20:02:27,071 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 20:02:27,072 - services.translation_routes - INFO - [translation_routes.py:97] - Request 46e0fbc7: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcpcqo2aj.wav
2025-02-18 20:02:27,072 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 20:02:27,072 - services.translation_routes - INFO - [translation_routes.py:112] - Request 46e0fbc7: Beginning audio processing with diagnostics
2025-02-18 20:02:27,072 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcpcqo2aj.wav
2025-02-18 20:02:27,073 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:02:27,077 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:02:27,112 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:02:27,129 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:02:27,129 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:02:27,204 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:02:27,278 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:27,278 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:27,297 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:27,298 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:27,316 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:27,317 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:27,334 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:27,334 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:28,458 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 46e0fbc7
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:02:28,458 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 20:02:28,458 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcpcqo2aj.wav
2025-02-18 20:02:28,458 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:02:28,461 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:02:28,498 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:02:28,525 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:02:28,525 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:02:28,601 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:02:28,676 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:28,677 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:28,700 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:28,701 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:28,725 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:28,725 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:28,745 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:02:28,745 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:02:29,875 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:02:29,876 - services.translation_routes - INFO - [translation_routes.py:153] - Request 46e0fbc7: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:02:29,876 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 20:02:29,876 - services.translation_routes - INFO - [translation_routes.py:165] - Request 46e0fbc7: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 20:02:29,876 - services.translation_routes - INFO - [translation_routes.py:167] - Request 46e0fbc7: Audio processed successfully
2025-02-18 20:02:29,911 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 20:02:58,861 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 20:03:32,278 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 20:04:08,203 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 20:04:08,232 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:04:08,232 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:04:08,242 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:04:08,242 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:04:08,251 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:04:08,252 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:04:08,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:736] - Spectral slope calculation failed: SVD did not converge in Linear Least Squares
2025-02-18 20:04:08,260 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:04:08,261 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:04:08,646 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 46e0fbc7
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 20:04:08,646 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.679
- Avg Amplitude: 0.064
- Rms Level: 0.101
- Crest Factor: 6.707
- Zero Crossings: 33738.000
- Silence Percentage: 10.219
- Clipping Points: 0.000
- Dynamic Range: 176.871

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.162
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.028
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.270
  - Volume Range: 233.461
  - Volume Variations: 0.060

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.030191591411083
- Background Noise: 3.682763343002846
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.927223265171051, 'stability': 3.5805282592773438, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.005352376960217953}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.514
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:04:08,647 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 20:04:08,647 - services.translation_routes - INFO - [translation_routes.py:307] - Request 46e0fbc7: Audio output processed successfully
2025-02-18 20:04:08,652 - services.translation_routes - INFO - [translation_routes.py:362] - Request 46e0fbc7: Response prepared successfully
2025-02-18 20:04:08,652 - services.translation_routes - INFO - [translation_routes.py:375] - Request 46e0fbc7 completed in 101.58s
2025-02-18 20:04:08,654 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 101.58s, Memory Change: 513.41MB
2025-02-18 20:04:08,654 - __main__ - INFO - [app.py:278] - Request to /translate took 141.42s
2025-02-18 20:21:16,563 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 20:21:16,563 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 20:21:16,568 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 20:21:16,568 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 20:21:16,569 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdpn8mw15/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '8308083350127101091'}}}
2025-02-18 20:21:19,326 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 20:21:19,327 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdpn8mw15/output.wav
2025-02-18 20:21:19,351 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 20:21:19,351 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 20:21:19,351 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.79s, Memory Change: -128.14MB
2025-02-18 20:21:19,352 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 2.79s
2025-02-18 20:21:22,996 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 20:21:22,999 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 20:21:43,034 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 20:21:43,034 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 20:22:04,540 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 20:22:04,540 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 20:22:04,548 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 70078d98
2025-02-18 20:22:04,549 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 20:22:04,549 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 20:22:04,550 - services.translation_routes - INFO - [translation_routes.py:97] - Request 70078d98: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdgzm6wi1.wav
2025-02-18 20:22:04,550 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 20:22:04,550 - services.translation_routes - INFO - [translation_routes.py:112] - Request 70078d98: Beginning audio processing with diagnostics
2025-02-18 20:22:04,550 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdgzm6wi1.wav
2025-02-18 20:22:04,550 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:22:04,553 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:22:04,584 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:22:04,595 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:22:04,596 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:22:04,641 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:22:04,706 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:04,707 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:04,721 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:04,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:04,737 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:04,737 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:04,752 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:04,752 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:05,806 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 70078d98
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:22:05,806 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 20:22:05,806 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdgzm6wi1.wav
2025-02-18 20:22:05,807 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:22:05,809 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:22:05,840 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:22:05,853 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:22:05,854 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:22:05,898 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:22:05,961 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:05,961 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:05,976 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:05,976 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:05,993 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:05,994 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:06,009 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:22:06,009 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:22:07,047 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:22:07,050 - services.translation_routes - INFO - [translation_routes.py:153] - Request 70078d98: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:22:07,051 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 20:22:07,051 - services.translation_routes - INFO - [translation_routes.py:165] - Request 70078d98: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 20:22:07,051 - services.translation_routes - INFO - [translation_routes.py:167] - Request 70078d98: Audio processed successfully
2025-02-18 20:22:07,083 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 20:22:35,828 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 20:23:08,915 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 20:23:43,677 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 20:23:43,702 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:23:43,702 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:23:43,713 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:23:43,713 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:23:43,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:23:43,722 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:23:43,728 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:23:43,729 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:23:44,086 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 70078d98
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 20:23:44,086 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.859
- Avg Amplitude: 0.060
- Rms Level: 0.097
- Crest Factor: 8.865
- Zero Crossings: 28799.000
- Silence Percentage: 12.386
- Clipping Points: 0.000
- Dynamic Range: 226.446

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.246
  - Volume Range: 1130.260
  - Volume Variations: 0.058

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0218673145984294
- Background Noise: 4.5461457045467935
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7572020888328552, 'stability': 3.1865010261535645, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.02274823747575283, 'consistency': 0.0, 'distinction': 0.11775049567222595}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.510
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:23:44,087 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 20:23:44,087 - services.translation_routes - INFO - [translation_routes.py:307] - Request 70078d98: Audio output processed successfully
2025-02-18 20:23:44,092 - services.translation_routes - INFO - [translation_routes.py:362] - Request 70078d98: Response prepared successfully
2025-02-18 20:23:44,092 - services.translation_routes - INFO - [translation_routes.py:375] - Request 70078d98 completed in 99.54s
2025-02-18 20:23:44,096 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 99.55s, Memory Change: 192.97MB
2025-02-18 20:23:44,096 - __main__ - INFO - [app.py:278] - Request to /translate took 141.10s
2025-02-18 20:36:28,611 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 20:36:28,611 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 20:36:28,613 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 20:36:28,615 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 20:36:28,616 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcdn8ci42/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '0064946882272990677'}}}
2025-02-18 20:36:30,530 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 20:36:30,531 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcdn8ci42/output.wav
2025-02-18 20:36:30,557 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 20:36:30,558 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 20:36:30,559 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.95s, Memory Change: 2.31MB
2025-02-18 20:36:30,559 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.95s
2025-02-18 20:36:32,711 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 20:36:32,713 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 20:36:53,318 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 20:36:53,318 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 20:37:14,236 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 20:37:14,236 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 20:37:14,239 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 8e3325d9
2025-02-18 20:37:14,239 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 20:37:14,239 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 20:37:14,240 - services.translation_routes - INFO - [translation_routes.py:97] - Request 8e3325d9: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5issc70s.wav
2025-02-18 20:37:14,240 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 20:37:14,240 - services.translation_routes - INFO - [translation_routes.py:112] - Request 8e3325d9: Beginning audio processing with diagnostics
2025-02-18 20:37:14,240 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5issc70s.wav
2025-02-18 20:37:14,241 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:37:14,243 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:37:14,276 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:37:14,287 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:37:14,287 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:37:14,334 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:37:14,401 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:14,401 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:14,423 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:14,423 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:14,438 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:14,439 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:14,454 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:14,454 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:15,510 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 8e3325d9
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:37:15,511 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 20:37:15,511 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp5issc70s.wav
2025-02-18 20:37:15,511 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 20:37:15,513 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 20:37:15,542 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 20:37:15,554 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:37:15,554 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 20:37:15,600 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 20:37:15,666 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:15,666 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:15,678 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:15,679 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:15,693 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:15,693 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:15,709 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:37:15,709 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:37:16,743 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:37:16,747 - services.translation_routes - INFO - [translation_routes.py:153] - Request 8e3325d9: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 20:37:16,747 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 20:37:16,747 - services.translation_routes - INFO - [translation_routes.py:165] - Request 8e3325d9: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 20:37:16,747 - services.translation_routes - INFO - [translation_routes.py:167] - Request 8e3325d9: Audio processed successfully
2025-02-18 20:37:16,782 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 20:37:46,165 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 20:38:18,987 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 20:38:41,790 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 20:38:41,800 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:38:41,802 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:38:41,806 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:38:41,806 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:38:41,810 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:38:41,811 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:38:41,814 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 20:38:41,814 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 20:38:41,982 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 8e3325d9
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.666
- Avg Amplitude: 0.054
- Rms Level: 0.090
- Crest Factor: 7.436
- Zero Crossings: 14654.000
- Silence Percentage: 11.046
- Clipping Points: 0.000
- Dynamic Range: 171.749

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.071
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.025
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.254
  - Volume Range: 191.900
  - Volume Variations: 0.054

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0240832146114904
- Background Noise: 3.974383125143997
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7844852805137634, 'stability': 3.3477325439453125, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.33051344752311707, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.503
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 20:38:41,982 - services.translation_routes - INFO - [translation_routes.py:307] - Request 8e3325d9: Audio output processed successfully
2025-02-18 20:38:41,984 - services.translation_routes - INFO - [translation_routes.py:362] - Request 8e3325d9: Response prepared successfully
2025-02-18 20:38:41,985 - services.translation_routes - INFO - [translation_routes.py:375] - Request 8e3325d9 completed in 87.75s
2025-02-18 20:38:41,986 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 87.75s, Memory Change: 185.95MB
2025-02-18 20:38:41,987 - __main__ - INFO - [app.py:278] - Request to /translate took 129.28s
2025-02-18 21:31:27,703 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 21:31:27,704 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 21:31:27,708 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 21:31:27,709 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 21:31:27,709 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpk7a4i34u/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '3630472271640259511'}}}
2025-02-18 21:31:29,893 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 21:31:29,894 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpk7a4i34u/output.wav
2025-02-18 21:31:29,917 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 21:31:29,918 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 21:31:29,918 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.21s, Memory Change: 23.00MB
2025-02-18 21:31:29,918 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 2.21s
2025-02-18 21:31:32,462 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 21:31:32,464 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 21:31:58,289 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 21:31:58,289 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 21:32:17,857 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 21:32:17,858 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 21:32:17,862 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request b37cdce9
2025-02-18 21:32:17,862 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 21:32:17,863 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 21:32:17,864 - services.translation_routes - INFO - [translation_routes.py:97] - Request b37cdce9: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgx1cv02i.wav
2025-02-18 21:32:17,864 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 21:32:17,865 - services.translation_routes - INFO - [translation_routes.py:112] - Request b37cdce9: Beginning audio processing with diagnostics
2025-02-18 21:32:17,865 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgx1cv02i.wav
2025-02-18 21:32:17,865 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:32:17,867 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:32:17,903 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:32:17,915 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:32:17,915 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:32:17,970 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:32:18,037 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:18,037 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:18,053 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:18,054 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:18,069 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:18,070 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:18,087 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:18,088 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:19,161 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: b37cdce9
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:32:19,161 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 21:32:19,161 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgx1cv02i.wav
2025-02-18 21:32:19,161 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:32:19,163 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:32:19,197 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:32:19,211 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:32:19,211 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:32:19,262 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:32:19,329 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:19,329 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:19,347 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:19,347 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:19,363 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:19,363 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:19,379 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:32:19,379 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:32:20,431 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:32:20,431 - services.translation_routes - INFO - [translation_routes.py:153] - Request b37cdce9: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:32:20,431 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 21:32:20,431 - services.translation_routes - INFO - [translation_routes.py:165] - Request b37cdce9: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 21:32:20,431 - services.translation_routes - INFO - [translation_routes.py:167] - Request b37cdce9: Audio processed successfully
2025-02-18 21:32:20,467 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 21:32:55,212 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 21:33:31,232 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 21:34:03,646 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 21:34:03,676 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:34:03,677 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:34:03,687 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:34:03,687 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:34:03,724 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:34:03,724 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:34:03,768 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:34:03,768 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:34:04,258 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: b37cdce9
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.835
- Avg Amplitude: 0.058
- Rms Level: 0.096
- Crest Factor: 8.694
- Zero Crossings: 28055.000
- Silence Percentage: 12.996
- Clipping Points: 0.000
- Dynamic Range: 226.804

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.025
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.224
  - Volume Range: 431.005
  - Volume Variations: 0.059

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.022091824714262
- Background Noise: 4.477557504701517
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7645606994628906, 'stability': 3.504178762435913, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.09667392820119858}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.491
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.002
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 21:34:04,259 - services.translation_routes - INFO - [translation_routes.py:307] - Request b37cdce9: Audio output processed successfully
2025-02-18 21:34:04,265 - services.translation_routes - INFO - [translation_routes.py:362] - Request b37cdce9: Response prepared successfully
2025-02-18 21:34:04,265 - services.translation_routes - INFO - [translation_routes.py:375] - Request b37cdce9 completed in 106.40s
2025-02-18 21:34:04,266 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 106.40s, Memory Change: 1821.48MB
2025-02-18 21:34:04,266 - __main__ - INFO - [app.py:278] - Request to /translate took 151.80s
2025-02-18 21:50:19,518 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 21:50:19,519 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 21:50:19,521 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 21:50:19,521 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 21:50:19,522 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7tyt65z1/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '5841909954556365937'}}}
2025-02-18 21:50:21,318 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 21:50:21,319 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7tyt65z1/output.wav
2025-02-18 21:50:21,342 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 21:50:21,342 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 21:50:21,343 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.82s, Memory Change: 2.73MB
2025-02-18 21:50:21,343 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.82s
2025-02-18 21:50:24,612 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 21:50:24,613 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 21:50:42,961 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 21:50:42,962 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 21:51:04,328 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 21:51:04,329 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 21:51:04,345 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 3100fae4
2025-02-18 21:51:04,345 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 21:51:04,345 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 21:51:04,347 - services.translation_routes - INFO - [translation_routes.py:97] - Request 3100fae4: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k0e_o5d.wav
2025-02-18 21:51:04,347 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 21:51:04,347 - services.translation_routes - INFO - [translation_routes.py:112] - Request 3100fae4: Beginning audio processing with diagnostics
2025-02-18 21:51:04,347 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k0e_o5d.wav
2025-02-18 21:51:04,347 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:51:04,349 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:51:04,417 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:51:04,441 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:51:04,441 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:51:04,525 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:51:04,654 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:04,654 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:04,673 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:04,674 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:04,692 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:04,692 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:04,710 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:04,710 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:05,843 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 3100fae4
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:51:05,844 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 21:51:05,844 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1k0e_o5d.wav
2025-02-18 21:51:05,845 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:51:05,846 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:51:05,884 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:51:05,896 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:51:05,896 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:51:05,955 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:51:06,033 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:06,033 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:06,055 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:06,056 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:06,084 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:06,084 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:06,106 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:51:06,106 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:51:07,234 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:51:07,235 - services.translation_routes - INFO - [translation_routes.py:153] - Request 3100fae4: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:51:07,235 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 21:51:07,235 - services.translation_routes - INFO - [translation_routes.py:165] - Request 3100fae4: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 21:51:07,235 - services.translation_routes - INFO - [translation_routes.py:167] - Request 3100fae4: Audio processed successfully
2025-02-18 21:51:07,273 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 21:51:36,238 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 21:52:06,303 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 21:52:33,666 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 21:52:33,685 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:52:33,685 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:52:33,688 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:52:33,688 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:52:33,695 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:52:33,695 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:52:33,699 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:52:33,699 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:52:33,972 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 3100fae4
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.832
- Avg Amplitude: 0.066
- Rms Level: 0.103
- Crest Factor: 8.047
- Zero Crossings: 22045.000
- Silence Percentage: 8.727
- Clipping Points: 0.000
- Dynamic Range: 148.186

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.028
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.318
  - Volume Range: 638.502
  - Volume Variations: 0.058

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0257022364839545
- Background Noise: 4.218825089662737
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.9495285153388977, 'stability': 4.059375286102295, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.08544837683439255, 'consistency': 0.0, 'distinction': 0.007275353651493788}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.533
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 21:52:33,973 - services.translation_routes - INFO - [translation_routes.py:307] - Request 3100fae4: Audio output processed successfully
2025-02-18 21:52:33,976 - services.translation_routes - INFO - [translation_routes.py:362] - Request 3100fae4: Response prepared successfully
2025-02-18 21:52:33,977 - services.translation_routes - INFO - [translation_routes.py:375] - Request 3100fae4 completed in 89.63s
2025-02-18 21:52:33,978 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 89.63s, Memory Change: 414.14MB
2025-02-18 21:52:33,978 - __main__ - INFO - [app.py:278] - Request to /translate took 129.37s
2025-02-18 21:56:54,465 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 21:56:54,466 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 21:56:54,468 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 21:56:54,468 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 21:56:54,469 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmppombu3h6/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2578449977921576445'}}}
2025-02-18 21:56:56,439 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 21:56:56,440 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmppombu3h6/output.wav
2025-02-18 21:56:56,464 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 21:56:56,464 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 21:56:56,465 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.00s, Memory Change: -0.16MB
2025-02-18 21:56:56,465 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 2.00s
2025-02-18 21:57:03,971 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 21:57:03,973 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 21:57:26,219 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 21:57:26,220 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 21:57:41,475 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 21:57:41,476 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 21:57:41,483 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request fcc90c17
2025-02-18 21:57:41,483 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 21:57:41,483 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 21:57:41,484 - services.translation_routes - INFO - [translation_routes.py:97] - Request fcc90c17: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpia63ufep.wav
2025-02-18 21:57:41,484 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 21:57:41,484 - services.translation_routes - INFO - [translation_routes.py:112] - Request fcc90c17: Beginning audio processing with diagnostics
2025-02-18 21:57:41,484 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpia63ufep.wav
2025-02-18 21:57:41,484 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:57:41,487 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:57:41,518 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:57:41,531 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:57:41,531 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:57:41,579 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:57:41,648 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:41,648 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:41,665 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:41,665 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:41,681 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:41,681 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:41,697 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:41,697 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:42,723 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: fcc90c17
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:57:42,723 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 21:57:42,723 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpia63ufep.wav
2025-02-18 21:57:42,723 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 21:57:42,726 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 21:57:42,757 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 21:57:42,770 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:57:42,770 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 21:57:42,816 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 21:57:42,883 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:42,883 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:42,898 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:42,898 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:42,914 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:42,915 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:42,931 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:57:42,932 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:57:43,959 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:57:43,961 - services.translation_routes - INFO - [translation_routes.py:153] - Request fcc90c17: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 21:57:43,961 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 21:57:43,961 - services.translation_routes - INFO - [translation_routes.py:165] - Request fcc90c17: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 21:57:43,961 - services.translation_routes - INFO - [translation_routes.py:167] - Request fcc90c17: Audio processed successfully
2025-02-18 21:57:43,994 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 21:58:12,081 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 21:58:44,636 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 21:59:18,719 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 21:59:18,746 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:59:18,747 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:59:18,754 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:59:18,754 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:59:18,764 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:59:18,764 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:59:18,772 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 21:59:18,772 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 21:59:19,193 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: fcc90c17
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.617
- Avg Amplitude: 0.059
- Rms Level: 0.091
- Crest Factor: 6.757
- Zero Crossings: 33641.000
- Silence Percentage: 9.952
- Clipping Points: 0.000
- Dynamic Range: 158.447

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.155
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.320
  - Volume Range: 219.533
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.027039943352292
- Background Noise: 3.7026398292440836
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7877236604690552, 'stability': 3.337291717529297, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.04319039732217789, 'consistency': 0.0, 'distinction': 0.06196100637316704}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.542
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 21:59:19,193 - services.translation_routes - INFO - [translation_routes.py:307] - Request fcc90c17: Audio output processed successfully
2025-02-18 21:59:19,199 - services.translation_routes - INFO - [translation_routes.py:362] - Request fcc90c17: Response prepared successfully
2025-02-18 21:59:19,199 - services.translation_routes - INFO - [translation_routes.py:375] - Request fcc90c17 completed in 97.72s
2025-02-18 21:59:19,202 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 97.72s, Memory Change: 188.98MB
2025-02-18 21:59:19,202 - __main__ - INFO - [app.py:278] - Request to /translate took 135.23s
2025-02-18 22:13:01,028 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-18 22:13:01,028 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-18 22:13:01,032 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-18 22:13:01,033 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-18 22:13:01,034 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp20p23rzx/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '1664460095073817347'}}}
2025-02-18 22:13:02,634 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-18 22:13:02,635 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp20p23rzx/output.wav
2025-02-18 22:13:02,659 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-18 22:13:02,659 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-18 22:13:02,660 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.63s, Memory Change: -0.16MB
2025-02-18 22:13:02,660 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.63s
2025-02-18 22:13:07,405 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-18 22:13:07,407 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-18 22:13:30,851 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-18 22:13:30,851 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-18 22:13:52,032 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-18 22:13:52,032 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-18 22:13:52,039 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 3b5f65f4
2025-02-18 22:13:52,039 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-18 22:13:52,040 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-18 22:13:52,041 - services.translation_routes - INFO - [translation_routes.py:97] - Request 3b5f65f4: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdbdmxdrv.wav
2025-02-18 22:13:52,041 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-18 22:13:52,041 - services.translation_routes - INFO - [translation_routes.py:112] - Request 3b5f65f4: Beginning audio processing with diagnostics
2025-02-18 22:13:52,041 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdbdmxdrv.wav
2025-02-18 22:13:52,041 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 22:13:52,044 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 22:13:52,082 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 22:13:52,099 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 22:13:52,100 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 22:13:52,164 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 22:13:52,245 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:52,245 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:52,265 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:52,265 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:52,292 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:52,292 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:52,313 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:52,314 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:53,417 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 3b5f65f4
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 22:13:53,418 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-18 22:13:53,418 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdbdmxdrv.wav
2025-02-18 22:13:53,418 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-18 22:13:53,421 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-18 22:13:53,451 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-18 22:13:53,463 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 22:13:53,464 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-18 22:13:53,513 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-18 22:13:53,585 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:53,586 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:53,601 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:53,601 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:53,621 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:53,621 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:53,637 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:13:53,637 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:13:54,695 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 22:13:54,698 - services.translation_routes - INFO - [translation_routes.py:153] - Request 3b5f65f4: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-18 22:13:54,698 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-18 22:13:54,698 - services.translation_routes - INFO - [translation_routes.py:165] - Request 3b5f65f4: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-18 22:13:54,698 - services.translation_routes - INFO - [translation_routes.py:167] - Request 3b5f65f4: Audio processed successfully
2025-02-18 22:13:54,732 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-18 22:14:23,624 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-18 22:14:57,745 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-18 22:15:31,902 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-18 22:15:31,933 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:15:31,934 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:15:31,948 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:15:31,949 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:15:31,961 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:15:31,961 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:15:31,974 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-18 22:15:31,974 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-18 22:15:32,407 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 3b5f65f4
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.804
- Avg Amplitude: 0.063
- Rms Level: 0.099
- Crest Factor: 8.094
- Zero Crossings: 30129.000
- Silence Percentage: 10.240
- Clipping Points: 0.000
- Dynamic Range: 175.875

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.027
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.323
  - Volume Range: 385.271
  - Volume Variations: 0.056

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0245571312745074
- Background Noise: 4.237720035081397
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8842495083808899, 'stability': 3.6063249111175537, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.026145095005631447}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.527
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-18 22:15:32,408 - services.translation_routes - INFO - [translation_routes.py:307] - Request 3b5f65f4: Audio output processed successfully
2025-02-18 22:15:32,413 - services.translation_routes - INFO - [translation_routes.py:362] - Request 3b5f65f4: Response prepared successfully
2025-02-18 22:15:32,413 - services.translation_routes - INFO - [translation_routes.py:375] - Request 3b5f65f4 completed in 100.37s
2025-02-18 22:15:32,417 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 100.38s, Memory Change: 57.88MB
2025-02-18 22:15:32,417 - __main__ - INFO - [app.py:278] - Request to /translate took 145.01s
2025-02-19 10:09:50,768 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.58MB
2025-02-19 10:09:50,772 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.01s
2025-02-19 10:09:50,776 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-19 10:09:50,777 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 10:09:50,778 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpr2fle0bw/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2109575995907557055'}}}
2025-02-19 10:09:53,736 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-19 10:09:53,738 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpr2fle0bw/output.wav
2025-02-19 10:09:53,761 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-19 10:09:53,762 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-19 10:09:53,762 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.99s, Memory Change: 65.23MB
2025-02-19 10:09:53,762 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 2.99s
2025-02-19 10:09:56,424 - services.model_manager - INFO - [model_manager.py:211] - Model inactive for too long, reloading...
2025-02-19 10:09:56,425 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-19 10:10:10,918 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-19 10:10:10,918 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 10:10:10,919 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 10:10:37,945 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 10:10:37,945 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 10:10:53,144 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 10:10:53,144 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 10:10:53,147 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-19 10:10:53,147 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 10:10:53,148 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 10:11:17,128 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 10:11:17,129 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 10:11:38,595 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 10:11:38,596 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 10:11:38,600 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 7e804629
2025-02-19 10:11:38,601 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-19 10:11:38,601 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-19 10:11:38,603 - services.translation_routes - INFO - [translation_routes.py:97] - Request 7e804629: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa7wds6qg.wav
2025-02-19 10:11:38,605 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-19 10:11:38,605 - services.translation_routes - INFO - [translation_routes.py:112] - Request 7e804629: Beginning audio processing with diagnostics
2025-02-19 10:11:38,605 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa7wds6qg.wav
2025-02-19 10:11:38,605 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:11:38,610 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:11:38,662 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:11:38,685 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:11:38,685 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:11:38,758 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:11:38,843 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:38,847 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:38,869 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:38,869 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:38,900 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:38,902 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:38,929 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:38,929 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:40,019 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 7e804629
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:11:40,019 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-19 10:11:40,019 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpa7wds6qg.wav
2025-02-19 10:11:40,019 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:11:40,022 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:11:40,055 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:11:40,065 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:11:40,065 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:11:40,116 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:11:40,188 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:40,188 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:40,204 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:40,204 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:40,228 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:40,229 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:40,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:11:40,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:11:41,361 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:11:41,362 - services.translation_routes - INFO - [translation_routes.py:153] - Request 7e804629: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:11:41,362 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-19 10:11:41,362 - services.translation_routes - INFO - [translation_routes.py:165] - Request 7e804629: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-19 10:11:41,362 - services.translation_routes - INFO - [translation_routes.py:167] - Request 7e804629: Audio processed successfully
2025-02-19 10:11:41,395 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-19 10:12:11,527 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-19 10:12:45,025 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-19 10:13:16,370 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-19 10:13:16,400 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:13:16,401 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:13:16,407 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:13:16,408 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:13:16,416 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:13:16,416 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:13:16,426 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:13:16,426 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:13:16,758 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 7e804629
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.826
- Avg Amplitude: 0.066
- Rms Level: 0.103
- Crest Factor: 8.038
- Zero Crossings: 26857.000
- Silence Percentage: 9.331
- Clipping Points: 0.000
- Dynamic Range: 159.681

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.028
  - Temporal Flatness: 0.016

- Volume Metrics:
  - Volume Stability: 0.303
  - Volume Range: 286.638
  - Volume Variations: 0.059

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0255850913263616
- Background Noise: 4.215146044270107
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
No issues detected

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.9451561570167542, 'stability': 4.071811676025391, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.011780699715018272}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.527
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-19 10:13:16,758 - services.translation_routes - INFO - [translation_routes.py:307] - Request 7e804629: Audio output processed successfully
2025-02-19 10:13:16,763 - services.translation_routes - INFO - [translation_routes.py:362] - Request 7e804629: Response prepared successfully
2025-02-19 10:13:16,764 - services.translation_routes - INFO - [translation_routes.py:375] - Request 7e804629 completed in 98.16s
2025-02-19 10:13:16,764 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 98.16s, Memory Change: 10289.56MB
2025-02-19 10:13:16,764 - __main__ - INFO - [app.py:278] - Request to /translate took 200.34s
2025-02-19 10:17:15,111 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.03MB
2025-02-19 10:17:15,111 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-19 10:17:15,117 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-19 10:17:15,118 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 10:17:15,118 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu4qhben8/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '1859656137062522109'}}}
2025-02-19 10:17:16,516 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-19 10:17:16,517 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu4qhben8/output.wav
2025-02-19 10:17:16,540 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-19 10:17:16,541 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-19 10:17:16,541 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.43s, Memory Change: -122.30MB
2025-02-19 10:17:16,541 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.43s
2025-02-19 10:17:26,497 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 10:17:26,498 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 10:17:49,547 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 10:17:49,547 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 10:18:08,028 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 10:18:08,028 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 10:18:08,032 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 9f92efff
2025-02-19 10:18:08,032 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-19 10:18:08,033 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-19 10:18:08,035 - services.translation_routes - INFO - [translation_routes.py:97] - Request 9f92efff: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgi_lt0n9.wav
2025-02-19 10:18:08,036 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-19 10:18:08,036 - services.translation_routes - INFO - [translation_routes.py:112] - Request 9f92efff: Beginning audio processing with diagnostics
2025-02-19 10:18:08,036 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgi_lt0n9.wav
2025-02-19 10:18:08,036 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:18:08,038 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:18:08,072 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:18:08,083 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:18:08,083 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:18:08,134 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:18:08,201 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:08,202 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:08,215 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:08,216 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:08,235 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:08,235 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:08,252 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:08,252 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:09,330 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 9f92efff
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:18:09,331 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-19 10:18:09,331 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgi_lt0n9.wav
2025-02-19 10:18:09,331 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:18:09,333 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:18:09,364 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:18:09,377 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:18:09,377 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:18:09,429 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:18:09,496 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:09,496 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:09,511 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:09,512 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:09,527 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:09,527 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:09,544 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:18:09,545 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:18:10,645 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:18:10,647 - services.translation_routes - INFO - [translation_routes.py:153] - Request 9f92efff: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:18:10,647 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-19 10:18:10,647 - services.translation_routes - INFO - [translation_routes.py:165] - Request 9f92efff: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-19 10:18:10,647 - services.translation_routes - INFO - [translation_routes.py:167] - Request 9f92efff: Audio processed successfully
2025-02-19 10:18:10,694 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-19 10:18:43,234 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-19 10:19:20,988 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-19 10:19:55,334 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-19 10:19:55,362 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:19:55,364 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:19:55,373 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:19:55,374 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:19:55,385 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:19:55,385 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:19:55,394 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:19:55,394 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:19:55,704 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 9f92efff
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.631
- Avg Amplitude: 0.064
- Rms Level: 0.099
- Crest Factor: 6.404
- Zero Crossings: 23262.000
- Silence Percentage: 9.710
- Clipping Points: 0.000
- Dynamic Range: 162.407

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.200
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.326
  - Volume Range: 563.882
  - Volume Variations: 0.055

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0307724555495783
- Background Noise: 3.561415011054307
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8791534304618835, 'stability': 3.727125883102417, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.006362263113260269}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.526
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-19 10:19:55,705 - services.translation_routes - INFO - [translation_routes.py:307] - Request 9f92efff: Audio output processed successfully
2025-02-19 10:19:55,709 - services.translation_routes - INFO - [translation_routes.py:362] - Request 9f92efff: Response prepared successfully
2025-02-19 10:19:55,710 - services.translation_routes - INFO - [translation_routes.py:375] - Request 9f92efff completed in 107.68s
2025-02-19 10:19:55,713 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 107.68s, Memory Change: 1039.58MB
2025-02-19 10:19:55,713 - __main__ - INFO - [app.py:278] - Request to /translate took 149.22s
2025-02-19 10:20:50,786 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 10:20:50,788 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 10:21:17,042 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 10:21:17,043 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 10:21:38,888 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 10:21:38,888 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 10:21:38,894 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 18c5c3c8
2025-02-19 10:21:38,894 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-19 10:21:38,895 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-19 10:21:38,897 - services.translation_routes - INFO - [translation_routes.py:97] - Request 18c5c3c8: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpeiv9ad7h.wav
2025-02-19 10:21:38,898 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-19 10:21:38,898 - services.translation_routes - INFO - [translation_routes.py:112] - Request 18c5c3c8: Beginning audio processing with diagnostics
2025-02-19 10:21:38,898 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpeiv9ad7h.wav
2025-02-19 10:21:38,898 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:21:38,901 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:21:38,932 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:21:38,945 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:21:38,945 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:21:39,000 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:21:39,065 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:39,066 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:39,083 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:39,083 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:39,097 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:39,098 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:39,117 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:39,117 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:40,218 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 18c5c3c8
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:21:40,218 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-19 10:21:40,218 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpeiv9ad7h.wav
2025-02-19 10:21:40,218 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:21:40,222 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:21:40,261 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:21:40,274 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:21:40,274 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:21:40,333 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:21:40,404 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:40,404 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:40,419 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:40,419 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:40,437 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:40,437 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:40,451 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:21:40,452 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:21:41,503 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:21:41,504 - services.translation_routes - INFO - [translation_routes.py:153] - Request 18c5c3c8: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:21:41,504 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-19 10:21:41,504 - services.translation_routes - INFO - [translation_routes.py:165] - Request 18c5c3c8: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-19 10:21:41,504 - services.translation_routes - INFO - [translation_routes.py:167] - Request 18c5c3c8: Audio processed successfully
2025-02-19 10:21:41,539 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-19 10:22:10,619 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-19 10:22:43,197 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-19 10:23:20,669 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-19 10:23:20,705 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:23:20,705 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:23:20,716 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:23:20,717 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:23:20,728 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:23:20,729 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:23:20,737 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:23:20,737 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:23:21,226 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:23:21,226 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-19 10:23:21,226 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 18c5c3c8
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.781
- Avg Amplitude: 0.059
- Rms Level: 0.094
- Crest Factor: 8.325
- Zero Crossings: 40630.000
- Silence Percentage: 9.390
- Clipping Points: 0.000
- Dynamic Range: 147.747

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.025
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.283
  - Volume Range: 298.559
  - Volume Variations: 0.055

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.022525682560665
- Background Noise: 4.330186377993878
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7554920315742493, 'stability': 3.1432740688323975, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.023600738495588303, 'consistency': 0.0, 'distinction': 0.08663400262594223}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.504
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-19 10:23:21,227 - services.translation_routes - INFO - [translation_routes.py:307] - Request 18c5c3c8: Audio output processed successfully
2025-02-19 10:23:21,233 - services.translation_routes - INFO - [translation_routes.py:362] - Request 18c5c3c8: Response prepared successfully
2025-02-19 10:23:21,233 - services.translation_routes - INFO - [translation_routes.py:375] - Request 18c5c3c8 completed in 102.34s
2025-02-19 10:23:21,236 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 102.34s, Memory Change: 854.64MB
2025-02-19 10:23:21,236 - __main__ - INFO - [app.py:278] - Request to /translate took 150.45s
2025-02-19 10:29:37,989 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.05MB
2025-02-19 10:29:37,990 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-19 10:29:37,996 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-19 10:29:37,997 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 10:29:37,999 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpf_7ww_hs/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '1655740942480329061'}}}
2025-02-19 10:29:38,572 - services.audio_link_routes - ERROR - [audio_link_routes.py:185] - Download error for tiktok: [0;31mERROR:[0m [TikTok] 7411229444427287851: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U
2025-02-19 10:29:38,573 - services.audio_link_routes - ERROR - [audio_link_routes.py:192] - tiktok processing error: Unable to access this TikTok content. Please try another video or check the URL.
Traceback (most recent call last):
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1637, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1772, in __extract_info
    ie_result = ie.extract(url)
                ^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/common.py", line 742, in extract
    ie_result = self._real_extract(url)
                ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 894, in _real_extract
    video_data, status = self._extract_web_data_and_status(url, video_id)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/extractor/tiktok.py", line 250, in _extract_web_data_and_status
    raise ExtractorError('Unable to extract webpage video data')
yt_dlp.utils.ExtractorError: [TikTok] 7411229444427287851: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 142, in handle_video_platform_url
    ydl.download([url])
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3618, in download
    self.__download_wrapper(self.extract_info)(
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 3591, in wrapper
    res = func(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1626, in extract_info
    return self.__extract_info(url, self.get_info_extractor(key), download, extra_info, process)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1655, in wrapper
    self.report_error(str(e), e.format_traceback())
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1095, in report_error
    self.trouble(f'{self._format_err("ERROR:", self.Styles.ERROR)} {message}', *args, **kwargs)
  File "/opt/anaconda3/lib/python3.12/site-packages/yt_dlp/YoutubeDL.py", line 1034, in trouble
    raise DownloadError(message, exc_info)
yt_dlp.utils.DownloadError: [0;31mERROR:[0m [TikTok] 7411229444427287851: Unable to extract webpage video data; please report this issue on  https://github.com/yt-dlp/yt-dlp/issues?q= , filling out the appropriate issue template. Confirm you are on the latest version using  yt-dlp -U

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/audio_link_routes.py", line 187, in handle_video_platform_url
    raise Exception(f"Unable to access this TikTok content. Please try another video or check the URL.")
Exception: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-19 10:29:38,576 - services.audio_link_routes - ERROR - [audio_link_routes.py:260] - Processing error: Unable to access this TikTok content. Please try another video or check the URL.
2025-02-19 10:29:38,577 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.58s, Memory Change: 25.64MB
2025-02-19 10:29:38,577 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.58s
2025-02-19 10:30:20,373 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-19 10:30:20,375 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 10:30:20,375 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpxlq98kpu/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '6952859391373438493'}}}
2025-02-19 10:30:21,870 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-19 10:30:21,871 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpxlq98kpu/output.wav
2025-02-19 10:30:21,895 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-19 10:30:21,895 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-19 10:30:21,896 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.52s, Memory Change: 20.73MB
2025-02-19 10:30:21,896 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.52s
2025-02-19 10:37:27,572 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-02-19 10:37:27,572 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-19 10:37:27,575 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@y_combinator/video/7411229444427287851?is_from_webapp=1&sender_device=pc&web_id=7472529903809676822
2025-02-19 10:37:27,576 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 10:37:27,576 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp9t93losr/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '9575450934005025812'}}}
2025-02-19 10:37:28,957 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-19 10:37:28,957 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp9t93losr/output.wav
2025-02-19 10:37:28,983 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-19 10:37:28,984 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-19 10:37:28,984 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.41s, Memory Change: 13.22MB
2025-02-19 10:37:28,984 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 1.41s
2025-02-19 10:37:33,853 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 10:37:33,855 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 10:37:56,586 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 10:37:56,586 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 10:38:17,780 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 10:38:17,780 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 10:38:17,784 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 631f6d95
2025-02-19 10:38:17,785 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-19 10:38:17,785 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-19 10:38:17,787 - services.translation_routes - INFO - [translation_routes.py:97] - Request 631f6d95: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdr91x4ap.wav
2025-02-19 10:38:17,788 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 38.24 seconds
2025-02-19 10:38:17,788 - services.translation_routes - INFO - [translation_routes.py:112] - Request 631f6d95: Beginning audio processing with diagnostics
2025-02-19 10:38:17,788 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdr91x4ap.wav
2025-02-19 10:38:17,788 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:38:17,791 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:38:17,826 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:38:17,838 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:38:17,839 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:38:17,904 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:38:17,969 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:17,970 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:17,984 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:17,985 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:18,001 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:18,001 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:18,018 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:18,019 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:19,158 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 631f6d95
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.015
- Rms Level: 0.040
- Crest Factor: 23.831
- Zero Crossings: 254556.000
- Silence Percentage: 47.747
- Clipping Points: 0.000
- Dynamic Range: 3685257.968

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.066
  - Temporal Flatness: 0.021

- Volume Metrics:
  - Volume Stability: -0.405
  - Volume Range: 24536417.425
  - Volume Variations: 0.032

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.003345643146739
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7177200317382812, 'stability': 1.5061113834381104, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.42766523361206055, 'distinction': 0.15607275068759918}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.635
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.672
  - Rhythm Quality: 0.703
  - Intonation Quality: 0.641

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:38:19,159 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-19 10:38:19,159 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdr91x4ap.wav
2025-02-19 10:38:19,159 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 10:38:19,162 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 611915]), Frequency: 16000Hz
2025-02-19 10:38:19,201 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 10:38:19,214 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:38:19,214 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 10:38:19,276 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 10:38:19,352 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:19,353 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:19,372 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:19,373 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:19,393 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:19,393 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:19,412 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:38:19,413 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:38:20,517 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:38:20,519 - services.translation_routes - INFO - [translation_routes.py:153] - Request 631f6d95: Background music analysis: {'has_background_music': True, 'music_confidence': 0.3477175465611055, 'feature_scores': {'spectral_flatness': 0.1390788085613864, 'rhythm_regularity': 0.023657718120805367, 'bass_presence': 0.137733629472295, 'temporal_stability': 0.047247390406618676}, 'speech_vs_music': {'speech_prominence': 2.1681845428842896, 'speech_band_energy': 6.937399632533925e-08, 'music_band_energy': 3.189635222611287e-08}}
2025-02-19 10:38:20,519 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.3477175465611055)
2025-02-19 10:38:20,519 - services.translation_routes - INFO - [translation_routes.py:165] - Request 631f6d95: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.3477175465611055}}}
2025-02-19 10:38:20,519 - services.translation_routes - INFO - [translation_routes.py:167] - Request 631f6d95: Audio processed successfully
2025-02-19 10:38:20,556 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-19 10:38:49,763 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: When you choose pricing, it's important to keep it simple. Overcomplicated pricing will kill the sales process. In general, monthly recurring revenue is preferable to annual recurrent revenue, and that's because during an economic downturn, your revenue is protected at least until the contract is renewed, and then you can have a dispute with the customer about whether it is worth renewing.
2025-02-19 10:39:24,091 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Quand vous choisissez le prix, c'est important de le garder simple, trop compliqué. C'est préférable à un prix basé sur l'usage, parce que votre revenu est protégé au moins jusqu'à ce que le contrat soit renouvelé, alors que vous pouvez avoir un débat avec le client sur le fait qu'il vaut la peine d'être renouvelé. Il y a un risque réel que vos revenus tombent dans un mauvais mois et les investisseurs s'inquiètent pour ça.
2025-02-19 10:40:05,533 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-19 10:40:05,570 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:40:05,571 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:40:05,581 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:40:05,582 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:40:05,593 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:40:05,594 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:40:05,606 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 10:40:05,607 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 10:40:06,091 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 10:40:06,091 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-19 10:40:06,091 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-19 10:40:06,091 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-19 10:40:06,091 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 631f6d95
2025-02-19 10:40:06,091 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-19 10:40:06,092 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-19 10:40:06,092 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.828
- Avg Amplitude: 0.059
- Rms Level: 0.092
- Crest Factor: 8.982
- Zero Crossings: 36391.000
- Silence Percentage: 8.468
- Clipping Points: 0.000
- Dynamic Range: 126.465

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.302
  - Volume Range: 307.321
  - Volume Variations: 0.053

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.020525924192636
- Background Noise: 4.59279718932241
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.9615254402160645, 'stability': 3.5726771354675293, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.01849990151822567}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.513
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 10:40:06,092 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-19 10:40:06,092 - services.translation_routes - INFO - [translation_routes.py:307] - Request 631f6d95: Audio output processed successfully
2025-02-19 10:40:06,098 - services.translation_routes - INFO - [translation_routes.py:362] - Request 631f6d95: Response prepared successfully
2025-02-19 10:40:06,098 - services.translation_routes - INFO - [translation_routes.py:375] - Request 631f6d95 completed in 108.31s
2025-02-19 10:40:06,101 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 108.32s, Memory Change: 750.92MB
2025-02-19 10:40:06,101 - __main__ - INFO - [app.py:278] - Request to /translate took 152.25s
2025-02-19 14:00:58,415 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.52MB
2025-02-19 14:00:58,417 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 0.00s
2025-02-19 14:00:58,422 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053
2025-02-19 14:00:58,424 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-19 14:00:58,424 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpzmc0vqzq/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '1425764577893515204'}}}
2025-02-19 14:01:02,239 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-19 14:01:02,239 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpzmc0vqzq/output.wav
2025-02-19 14:01:02,244 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-19 14:01:02,245 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-19 14:01:02,245 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.82s, Memory Change: 53.03MB
2025-02-19 14:01:02,245 - __main__ - INFO - [app.py:278] - Request to /process-audio-url took 3.82s
2025-02-19 14:01:03,644 - __main__ - INFO - [app.py:278] - Request to /translate took 0.00s
2025-02-19 14:01:03,652 - services.model_manager - INFO - [model_manager.py:211] - Model inactive for too long, reloading...
2025-02-19 14:01:03,652 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-19 14:01:18,302 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-19 14:01:18,302 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 14:01:18,303 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 14:01:42,423 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 14:01:42,424 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 14:01:59,698 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 14:01:59,698 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 14:01:59,701 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-19 14:01:59,701 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-19 14:01:59,702 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-19 14:02:16,480 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-19 14:02:16,481 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-19 14:02:32,110 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-19 14:02:32,111 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-19 14:02:32,223 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 702dac6a
2025-02-19 14:02:32,223 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-19 14:02:32,224 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-19 14:02:32,225 - services.translation_routes - INFO - [translation_routes.py:97] - Request 702dac6a: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpwja33_93.wav
2025-02-19 14:02:32,225 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-19 14:02:32,225 - services.translation_routes - INFO - [translation_routes.py:112] - Request 702dac6a: Beginning audio processing with diagnostics
2025-02-19 14:02:32,226 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpwja33_93.wav
2025-02-19 14:02:32,226 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 14:02:32,226 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-19 14:02:32,231 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 14:02:32,234 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-19 14:02:32,234 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 14:02:32,245 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 14:02:32,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,255 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,259 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,259 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,263 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,263 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,267 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,267 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,413 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 702dac6a
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 14:02:32,414 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-19 14:02:32,414 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpwja33_93.wav
2025-02-19 14:02:32,415 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-19 14:02:32,415 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-19 14:02:32,419 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-19 14:02:32,424 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-19 14:02:32,424 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-19 14:02:32,435 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-19 14:02:32,446 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,446 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,451 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,451 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,455 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,456 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,461 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:32,461 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:32,607 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 14:02:32,608 - services.translation_routes - INFO - [translation_routes.py:153] - Request 702dac6a: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-19 14:02:32,608 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.15608341036219223)
2025-02-19 14:02:32,608 - services.translation_routes - INFO - [translation_routes.py:165] - Request 702dac6a: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.15608341036219223}}}
2025-02-19 14:02:32,608 - services.translation_routes - INFO - [translation_routes.py:167] - Request 702dac6a: Audio processed successfully
2025-02-19 14:02:32,616 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-19 14:02:39,054 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-19 14:02:46,217 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-19 14:02:53,922 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-19 14:02:53,932 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:53,932 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:53,935 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:53,935 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:53,939 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:53,939 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:53,942 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-19 14:02:53,942 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-19 14:02:54,045 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 702dac6a
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.405
- Avg Amplitude: 0.052
- Rms Level: 0.083
- Crest Factor: 4.885
- Zero Crossings: 9615.000
- Silence Percentage: 10.448
- Clipping Points: 0.000
- Dynamic Range: 156.754

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.389
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.024
  - Temporal Flatness: 0.011

- Volume Metrics:
  - Volume Stability: 0.230
  - Volume Range: 163.870
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0339318321721236
- Background Noise: 2.9541653731947073
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.594379723072052, 'stability': 3.1576290130615234, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Moderate nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.541
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.002
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-19 14:02:54,045 - services.translation_routes - INFO - [translation_routes.py:307] - Request 702dac6a: Audio output processed successfully
2025-02-19 14:02:54,048 - services.translation_routes - INFO - [translation_routes.py:362] - Request 702dac6a: Response prepared successfully
2025-02-19 14:02:54,048 - services.translation_routes - INFO - [translation_routes.py:375] - Request 702dac6a completed in 21.82s
2025-02-19 14:02:54,048 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 21.82s, Memory Change: 10091.89MB
2025-02-19 14:02:54,048 - __main__ - INFO - [app.py:278] - Request to /translate took 110.40s
2025-02-20 20:41:08,556 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 20:41:08,557 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 20:41:22,432 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 20:41:22,432 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 20:41:22,436 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 20:41:51,133 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 20:41:51,134 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 20:42:07,041 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 20:42:07,042 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 20:42:07,043 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 20:42:07,043 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 20:42:07,043 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 20:42:28,589 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 20:42:28,590 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 20:42:45,698 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 20:42:45,698 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.1GB available
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 20:42:45,702 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 20:53:51,532 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 20:53:51,532 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 20:53:51,532 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 20:53:51,533 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 20:54:07,193 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 20:54:07,194 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 20:54:23,408 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 20:54:23,408 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 20:54:23,410 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 31.88s, Memory Change: 360.92MB
2025-02-20 20:54:23,410 - __main__ - INFO - [app.py:279] - Request to /process-video took 31.88s
2025-02-20 20:54:23,905 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 20:54:23,907 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 20:54:23,910 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 20:54:33,074 - services.video_routes - ERROR - [video_routes.py:172] - Audio translation failed: 'tuple' object has no attribute 'waveform'
2025-02-20 20:54:33,074 - services.video_routes - ERROR - [video_routes.py:128] - Video processing failed: Failed to translate audio
2025-02-20 21:45:10,932 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 21:45:10,933 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 21:45:15,939 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 21:45:15,941 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 21:45:15,941 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 21:45:15,943 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 21:45:15,944 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 21:45:15,945 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 21:45:15,948 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 21:45:15,949 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 21:45:15,949 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 21:45:15,949 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 21:45:15,950 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 21:45:15,950 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 21:45:15,950 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 21:45:15,951 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 21:45:15,951 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 21:45:15,951 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 21:48:17,898 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 21:48:17,899 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 21:48:30,423 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 21:48:30,423 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 21:48:30,423 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 21:48:52,659 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 21:48:52,659 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 21:49:12,075 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 21:49:12,075 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 21:49:12,079 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 21:49:12,079 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 21:49:12,079 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 21:49:31,319 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 21:49:31,319 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 21:49:46,963 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 21:49:46,963 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.8GB available
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 21:49:46,967 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 21:51:50,016 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 21:51:50,016 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 21:51:50,017 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 21:51:50,017 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 21:52:10,122 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 21:52:10,122 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 21:52:27,850 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 21:52:27,851 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 21:52:27,852 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 37.84s, Memory Change: 13.12MB
2025-02-20 21:52:27,852 - __main__ - INFO - [app.py:279] - Request to /process-video took 37.84s
2025-02-20 21:52:28,332 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 21:52:28,332 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 21:52:28,333 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 21:52:40,745 - services.video_routes - ERROR - [video_routes.py:128] - Video processing failed: expected str, bytes or os.PathLike object, not Tensor
2025-02-20 22:08:41,640 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 22:08:41,641 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 22:08:46,646 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:08:46,647 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:08:46,647 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:08:46,648 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:08:46,649 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:08:46,649 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 22:08:46,650 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:08:46,650 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:08:46,650 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:08:46,651 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:08:46,652 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:08:46,652 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:08:46,652 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:08:46,652 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:08:46,653 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:08:46,653 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:08:59,709 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 22:08:59,709 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 22:09:12,276 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 22:09:12,276 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:09:12,277 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:09:28,360 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:09:28,360 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:09:45,926 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:09:45,926 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:09:45,929 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 22:09:45,929 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:09:45,930 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:10:01,464 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:10:01,464 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:10:19,118 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:10:19,118 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:10:19,121 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:10:19,121 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 22:10:19,121 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 16.3GB available
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 22:10:19,122 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 22:12:25,061 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 22:12:25,061 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 22:12:25,061 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:12:25,062 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:12:40,949 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:12:40,949 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:12:58,995 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:12:58,995 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:12:58,998 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 33.94s, Memory Change: 50.20MB
2025-02-20 22:12:58,998 - __main__ - INFO - [app.py:279] - Request to /process-video took 33.94s
2025-02-20 22:12:59,151 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 22:12:59,152 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 22:12:59,153 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 22:28:51,887 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 22:28:51,888 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 22:28:56,894 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:28:56,894 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:28:56,894 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:28:56,895 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:28:56,896 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:28:56,896 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 22:28:56,897 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:28:56,897 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:28:56,897 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:28:56,898 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:28:56,898 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:28:56,898 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 22:28:56,898 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 22:28:56,898 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 22:28:56,899 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:28:56,899 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 22:29:32,510 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 22:29:32,510 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 22:29:45,680 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 22:29:45,680 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:29:45,681 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:30:04,620 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:30:04,620 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:30:23,309 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:30:23,309 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:30:23,312 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 22:30:23,312 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:30:23,312 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:30:43,906 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:30:43,906 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:30:59,700 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:30:59,701 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 13.3GB available
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 22:30:59,704 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 22:38:14,752 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 22:38:14,752 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 22:38:14,753 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 22:38:14,754 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 22:38:31,316 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 22:38:31,316 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 22:38:49,532 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 22:38:49,532 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 22:38:49,535 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 34.78s, Memory Change: 537.91MB
2025-02-20 22:38:49,535 - __main__ - INFO - [app.py:279] - Request to /process-video took 34.78s
2025-02-20 22:38:49,709 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 22:38:49,709 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 22:38:49,711 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 23:03:31,408 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 23:03:31,410 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 23:03:36,416 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:03:36,417 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:03:36,418 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:03:36,420 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:03:36,421 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:03:36,421 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 23:03:36,423 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:03:36,423 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:03:36,423 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:03:36,424 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:03:36,424 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:03:36,424 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:03:36,424 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:03:36,424 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:03:36,425 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:03:36,425 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:03:49,477 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 23:03:49,477 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 23:04:03,925 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 23:04:03,925 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:04:03,926 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:04:23,546 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:04:23,547 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:04:45,571 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:04:45,571 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:04:45,574 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 23:04:45,574 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:04:45,575 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:05:07,379 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:05:07,380 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:05:26,954 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:05:26,954 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 23:05:26,957 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 11.2GB available
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 23:05:26,958 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 23:15:37,997 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 23:15:37,998 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 23:15:37,998 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:15:38,000 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:16:00,458 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:16:00,459 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:16:16,023 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:16:16,023 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:16:16,026 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 38.03s, Memory Change: 3470.91MB
2025-02-20 23:16:16,026 - __main__ - INFO - [app.py:279] - Request to /process-video took 38.03s
2025-02-20 23:16:16,381 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 23:16:16,382 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 23:16:16,383 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 23:16:16,433 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-20 23:16:23,996 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-20 23:16:23,996 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-20 23:16:29,542 - services.video_routes - ERROR - [video_routes.py:150] - Audio translation failed: abs(): argument 'input' (position 1) must be Tensor, not tuple
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 143, in translate_audio
    if torch.abs(translated_audio).max() > 0:
       ^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: abs(): argument 'input' (position 1) must be Tensor, not tuple
2025-02-20 23:16:29,543 - services.video_routes - ERROR - [video_routes.py:221] - Video processing failed: Failed to translate audio: abs(): argument 'input' (position 1) must be Tensor, not tuple
2025-02-20 23:23:45,757 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 23:23:45,760 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 23:23:50,763 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:23:50,764 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:23:50,767 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:23:50,768 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:23:50,770 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:23:50,771 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 23:23:50,775 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:23:50,775 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:23:50,775 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:23:50,776 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:23:50,776 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:23:50,777 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:23:50,777 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:23:50,777 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:23:50,778 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:23:50,778 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:24:02,398 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 23:24:02,398 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 23:24:15,645 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 23:24:15,645 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:24:15,646 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:24:39,838 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:24:39,838 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:24:57,016 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:24:57,016 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:24:57,018 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 23:24:57,018 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:24:57,019 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:25:15,475 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:25:15,475 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:25:31,235 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:25:31,235 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 11.7GB available
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 23:25:31,239 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 23:26:19,258 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 23:26:19,258 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 23:26:19,258 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:26:19,259 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:26:39,573 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:26:39,573 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:26:55,519 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:26:55,519 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:26:55,522 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.26s, Memory Change: 480.94MB
2025-02-20 23:26:55,522 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.26s
2025-02-20 23:26:55,690 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 23:26:55,691 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 23:26:55,692 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 23:26:55,720 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-20 23:27:03,226 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-20 23:27:03,226 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-20 23:27:08,689 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-20 23:40:10,061 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-20 23:40:10,062 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-20 23:40:15,067 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:40:15,068 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:40:15,069 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:40:15,071 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:40:15,073 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:40:15,073 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-20 23:40:15,075 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:40:15,076 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:40:15,076 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:40:15,077 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:40:15,077 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:40:15,078 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-20 23:40:15,078 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-20 23:40:15,078 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-20 23:40:15,079 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:40:15,080 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-20 23:40:24,479 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-20 23:40:24,479 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-20 23:40:37,546 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-20 23:40:37,546 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:40:37,546 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:40:58,793 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:40:58,793 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:41:18,132 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:41:18,133 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:41:18,136 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-20 23:41:18,136 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:41:18,136 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:41:33,213 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:41:33,213 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:41:50,977 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:41:50,977 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:41:50,980 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-20 23:41:50,980 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-20 23:41:50,980 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 11.3GB available
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-20 23:41:50,981 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-20 23:42:33,532 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-20 23:42:33,533 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-20 23:42:33,533 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-20 23:42:33,534 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-20 23:42:49,767 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-20 23:42:49,769 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-20 23:43:05,865 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-20 23:43:05,866 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-20 23:43:05,868 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 32.34s, Memory Change: 412.05MB
2025-02-20 23:43:05,868 - __main__ - INFO - [app.py:279] - Request to /process-video took 32.34s
2025-02-20 23:43:06,051 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-20 23:43:06,052 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-20 23:43:06,053 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-20 23:43:06,099 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-20 23:43:13,833 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-20 23:43:13,833 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-20 23:43:19,198 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-21 00:10:18,807 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-21 00:10:18,811 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-21 00:10:23,817 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:10:23,818 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:10:23,819 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:10:23,821 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:10:23,822 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:10:23,823 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-21 00:10:23,827 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:10:23,828 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:10:23,828 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:10:23,829 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:10:23,829 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:10:23,830 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:10:23,830 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:10:23,830 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:10:23,831 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:10:23,831 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:10:50,727 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-21 00:10:50,727 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-21 00:11:03,484 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-21 00:11:03,485 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:11:03,485 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:11:31,967 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:11:31,968 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:11:48,205 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:11:48,205 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:11:48,208 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-21 00:11:48,208 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:11:48,208 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:12:08,133 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:12:08,133 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:12:24,325 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:12:24,325 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 10.6GB available
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-21 00:12:24,328 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-21 00:13:11,768 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-21 00:13:11,769 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-21 00:13:11,769 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:13:11,770 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:13:34,331 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:13:34,331 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:13:52,688 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:13:52,688 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:13:52,692 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 40.92s, Memory Change: 930.81MB
2025-02-21 00:13:52,692 - __main__ - INFO - [app.py:279] - Request to /process-video took 40.93s
2025-02-21 00:13:53,163 - services.video_routes - INFO - [video_routes.py:233] - Detected speech starts at: 0.54 seconds
2025-02-21 00:13:53,164 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-21 00:13:53,164 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-21 00:13:53,165 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-21 00:13:53,213 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-21 00:14:00,752 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-21 00:14:00,753 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-21 00:14:06,180 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-21 00:34:47,153 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-21 00:34:47,156 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-21 00:34:52,161 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:34:52,163 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:34:52,164 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:34:52,166 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:34:52,167 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:34:52,168 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-21 00:34:52,173 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:34:52,173 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:34:52,173 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:34:52,174 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:34:52,174 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:34:52,175 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-21 00:34:52,175 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-21 00:34:52,175 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-21 00:34:52,176 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:34:52,176 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-21 00:35:08,801 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-21 00:35:08,801 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-21 00:35:23,073 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-21 00:35:23,074 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:35:23,075 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:35:54,059 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:35:54,059 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:36:14,751 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:36:14,752 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:36:14,755 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-21 00:36:14,755 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:36:14,755 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:36:33,445 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:36:33,447 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:36:57,349 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:36:57,350 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:36:57,353 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 00:36:57,353 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-21 00:36:57,353 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-21 00:36:57,353 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 8.0GB available
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-21 00:36:57,354 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-21 00:38:04,579 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-21 00:38:04,579 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-21 00:38:04,579 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 00:38:04,581 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 00:38:21,475 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 00:38:21,475 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 00:38:40,046 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 00:38:40,046 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 00:38:40,050 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 35.47s, Memory Change: 1113.27MB
2025-02-21 00:38:40,050 - __main__ - INFO - [app.py:279] - Request to /process-video took 35.47s
2025-02-21 00:38:40,334 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-21 00:38:40,334 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-21 00:38:40,335 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-21 00:38:40,337 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-21 00:38:40,381 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-21 00:38:48,545 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-21 00:38:48,546 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-21 00:38:54,146 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-21 21:11:57,832 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-21 21:11:57,832 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-21 21:12:12,059 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-21 21:12:12,059 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 21:12:12,061 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 21:12:40,116 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 21:12:40,117 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 21:13:00,085 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 21:13:00,085 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 21:13:00,088 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-21 21:13:00,089 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 21:13:00,089 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 21:13:16,203 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 21:13:16,203 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 21:13:32,584 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 21:13:32,585 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.1GB available
2025-02-21 21:13:32,588 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-21 21:13:32,589 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-21 21:15:39,616 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-21 21:15:39,616 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-21 21:15:39,616 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-21 21:15:39,617 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-21 21:15:55,220 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-21 21:15:55,221 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-21 21:16:10,670 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-21 21:16:10,670 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-21 21:16:10,673 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 31.06s, Memory Change: 46.69MB
2025-02-21 21:16:10,674 - __main__ - INFO - [app.py:279] - Request to /process-video took 31.06s
2025-02-21 21:16:11,177 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-21 21:16:11,177 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-21 21:16:11,178 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-21 21:16:11,181 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-21 21:16:11,232 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-21 21:16:18,907 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-21 21:16:18,907 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-21 21:16:24,613 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-22 23:49:47,750 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-22 23:49:47,750 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-22 23:50:00,498 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-22 23:50:00,498 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-22 23:50:00,501 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-22 23:50:30,093 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-22 23:50:30,094 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-22 23:50:46,581 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-22 23:50:46,582 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-22 23:50:46,585 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-22 23:50:46,586 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-22 23:50:46,586 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-22 23:51:04,955 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-22 23:51:04,955 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-22 23:51:20,600 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-22 23:51:20,601 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 7.2GB available
2025-02-22 23:51:20,603 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-22 23:51:20,604 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-22 23:55:18,180 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-22 23:55:18,181 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-22 23:55:18,181 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-22 23:55:18,182 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-22 23:55:42,757 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-22 23:55:42,757 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-22 23:55:58,322 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-22 23:55:58,322 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-22 23:55:58,325 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 40.15s, Memory Change: 5945.38MB
2025-02-22 23:55:58,325 - __main__ - INFO - [app.py:279] - Request to /process-video took 40.15s
2025-02-22 23:56:02,731 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-22 23:56:02,732 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-22 23:56:02,732 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-22 23:56:02,734 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-22 23:56:02,786 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-22 23:56:10,725 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-22 23:56:10,725 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-22 23:56:16,184 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-23 01:02:29,735 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-23 01:02:29,747 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-23 01:02:34,753 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 01:02:34,754 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 01:02:34,755 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 01:02:34,759 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 01:02:34,760 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 01:02:34,763 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-23 01:02:34,766 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 01:02:34,767 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 01:02:34,767 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 01:02:34,769 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 01:02:34,770 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 01:02:34,770 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 01:02:34,770 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 01:02:34,770 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 01:02:34,771 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 01:02:34,772 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 10:13:29,753 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-23 10:13:29,754 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-23 10:13:42,667 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-23 10:13:42,668 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:13:42,672 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:14:10,948 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:14:10,949 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:14:26,407 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:14:26,407 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:14:26,409 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-23 10:14:26,409 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:14:26,409 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:14:44,139 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:14:44,141 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:15:00,361 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:15:00,362 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 6.7GB available
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-23 10:15:00,365 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-23 10:15:00,366 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-23 10:15:00,366 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-23 10:15:00,366 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-23 10:15:00,366 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-23 10:15:00,366 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-23 10:22:02,290 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-23 10:22:02,292 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-23 10:22:02,292 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:22:02,293 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:22:28,858 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:22:28,859 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:22:46,932 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:22:46,932 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:22:46,936 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 44.65s, Memory Change: 7305.81MB
2025-02-23 10:22:46,936 - __main__ - INFO - [app.py:279] - Request to /process-video took 44.65s
2025-02-23 10:22:47,409 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-23 10:22:47,410 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-23 10:22:47,410 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-23 10:22:47,412 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-23 10:22:47,451 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-23 10:22:55,069 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-23 10:22:55,070 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-23 10:23:00,610 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-23 10:32:25,573 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-23 10:32:25,577 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-23 10:32:30,582 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 10:32:30,584 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 10:32:30,584 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 10:32:30,587 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 10:32:30,588 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 10:32:30,588 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-23 10:32:30,590 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 10:32:30,591 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 10:32:30,591 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 10:32:30,592 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 10:32:30,592 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 10:32:30,592 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-23 10:32:30,593 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-23 10:32:30,593 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-23 10:32:30,593 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 10:32:30,594 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-23 10:34:20,009 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-23 10:34:20,009 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-23 10:34:32,779 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-23 10:34:32,779 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:34:32,780 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:35:03,611 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:35:03,611 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:35:22,606 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:35:22,606 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:35:22,611 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-23 10:35:22,611 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:35:22,611 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:35:36,653 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:35:36,656 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:35:54,418 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:35:54,418 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-23 10:35:54,421 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 7.3GB available
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-23 10:35:54,422 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-23 10:37:48,998 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-23 10:37:48,999 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-23 10:37:48,999 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-23 10:37:49,000 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-23 10:38:07,695 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-23 10:38:07,695 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-23 10:38:26,225 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-23 10:38:26,226 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-23 10:38:26,229 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 37.23s, Memory Change: 2215.98MB
2025-02-23 10:38:26,229 - __main__ - INFO - [app.py:279] - Request to /process-video took 37.23s
2025-02-23 10:38:26,505 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-23 10:38:26,505 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-23 10:38:26,506 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-23 10:38:26,508 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-23 10:38:26,548 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-23 10:38:34,127 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-23 10:38:34,128 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-23 10:38:39,709 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-24 08:14:05,086 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-24 08:14:05,087 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-24 08:14:18,261 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-24 08:14:18,262 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-24 08:14:18,264 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-24 08:14:47,749 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-24 08:14:47,750 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-24 08:15:03,981 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-24 08:15:03,981 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-24 08:15:03,984 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-24 08:15:03,984 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-24 08:15:03,984 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-24 08:15:19,613 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-24 08:15:19,613 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-24 08:15:35,869 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-24 08:15:35,870 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.3GB available
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-24 08:15:35,873 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-24 08:20:24,979 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-24 08:20:24,980 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-24 08:20:24,980 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-24 08:20:24,981 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-24 08:20:41,814 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-24 08:20:41,814 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-24 08:21:01,987 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-24 08:21:01,987 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-24 08:21:01,990 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 37.01s, Memory Change: 342.25MB
2025-02-24 08:21:01,990 - __main__ - INFO - [app.py:279] - Request to /process-video took 37.01s
2025-02-24 08:21:02,457 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-24 08:21:02,457 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-24 08:21:02,458 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-24 08:21:02,460 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-24 08:21:02,502 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-24 08:21:09,973 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-24 08:21:09,973 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-24 08:21:15,494 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-25 22:53:49,864 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-25 22:53:49,865 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-25 22:54:02,807 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-25 22:54:02,807 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 22:54:02,811 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 22:54:31,753 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 22:54:31,753 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-25 22:54:49,262 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-25 22:54:49,262 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-25 22:54:49,265 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-25 22:54:49,265 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 22:54:49,265 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 22:55:07,121 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 22:55:07,121 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-25 22:55:26,293 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-25 22:55:26,293 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.2GB available
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-25 22:55:26,297 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-25 22:55:26,298 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-25 22:55:26,298 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-25 22:55:26,298 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-25 22:55:26,298 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-25 23:00:55,376 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-25 23:00:55,376 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-25 23:00:55,376 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 23:00:55,377 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 23:01:11,067 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 23:01:11,067 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-25 23:01:26,940 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-25 23:01:26,940 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-25 23:01:26,943 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 31.57s, Memory Change: 400.36MB
2025-02-25 23:01:26,943 - __main__ - INFO - [app.py:279] - Request to /process-video took 31.57s
2025-02-25 23:01:27,459 - services.video_routes - INFO - [video_routes.py:234] - Detected speech starts at: 0.54 seconds
2025-02-25 23:01:27,460 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-25 23:01:27,460 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-25 23:01:27,463 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-25 23:01:27,513 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-25 23:01:34,901 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-25 23:01:34,902 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-25 23:01:40,235 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-25 23:57:27,445 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-25 23:57:27,448 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-25 23:57:32,453 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-25 23:57:32,455 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-25 23:57:32,456 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-25 23:57:32,459 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-25 23:57:32,460 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-25 23:57:32,461 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-25 23:57:32,463 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-25 23:57:32,464 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-25 23:57:32,464 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-25 23:57:32,465 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-25 23:57:32,466 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-25 23:57:32,467 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-25 23:57:32,467 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-25 23:57:32,467 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-25 23:57:32,469 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-25 23:57:32,469 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-25 23:57:41,872 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-25 23:57:41,872 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-25 23:57:54,786 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-25 23:57:54,786 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 23:57:54,787 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 23:58:16,404 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 23:58:16,404 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-25 23:58:31,711 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-25 23:58:31,711 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-25 23:58:31,712 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-25 23:58:31,713 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 23:58:31,713 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 23:58:47,013 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 23:58:47,013 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-25 23:59:05,203 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-25 23:59:05,203 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 12.5GB available
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-25 23:59:05,208 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-25 23:59:41,162 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-25 23:59:41,162 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-25 23:59:41,162 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-25 23:59:41,163 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-25 23:59:57,497 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-25 23:59:57,497 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:00:17,968 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:00:17,968 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:00:17,970 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.81s, Memory Change: 251.38MB
2025-02-26 00:00:17,970 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.81s
2025-02-26 00:00:18,340 - services.video_routes - INFO - [video_routes.py:297] - Detected speech starts at: 0.54 seconds
2025-02-26 00:00:18,340 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 00:00:18,340 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 00:00:18,341 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 00:00:18,378 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 00:00:26,130 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 00:00:26,130 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 00:00:31,734 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 00:00:36,300 - services.video_routes - ERROR - [video_routes.py:248] - Face detection failed: Torch not compiled with CUDA enabled
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 226, in detect_face
    detector = face_detection.FaceAlignment(face_detection.LandmarksType._2D)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/diff2lip/face_detection/api.py", line 62, in __init__
    self.face_detector = face_detector_module.FaceDetector(device=device, verbose=verbose)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/diff2lip/face_detection/detection/sfd/sfd_detector.py", line 28, in __init__
    self.face_detector.to(device)
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1174, in to
    return self._apply(convert)
           ^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 780, in _apply
    module._apply(fn)
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 805, in _apply
    param_applied = fn(param)
                    ^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1160, in convert
    return t.to(
           ^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/cuda/__init__.py", line 305, in _lazy_init
    raise AssertionError("Torch not compiled with CUDA enabled")
AssertionError: Torch not compiled with CUDA enabled
2025-02-26 00:00:36,306 - services.video_routes - WARNING - [video_routes.py:344] - No face detected, using basic audio sync
2025-02-26 00:14:29,280 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 00:14:29,281 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 00:14:34,287 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:14:34,288 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:14:34,288 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:14:34,290 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:14:34,291 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:14:34,291 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 00:14:34,293 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:14:34,293 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:14:34,293 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:14:34,295 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:14:34,295 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:14:34,296 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:14:34,296 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:14:34,296 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:14:34,297 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:14:34,297 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:15:45,495 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 00:15:45,495 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 00:15:58,124 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 00:15:58,124 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:15:58,124 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:16:18,149 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:16:18,149 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:16:37,123 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:16:37,123 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:16:37,125 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 00:16:37,125 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:16:37,126 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:16:55,134 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:16:55,134 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:17:14,411 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:17:14,411 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.1GB available
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 00:17:14,413 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 00:19:29,334 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 00:19:29,335 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 00:19:29,335 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:19:29,336 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:19:45,275 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:19:45,275 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:20:03,564 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:20:03,566 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:20:03,567 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 34.23s, Memory Change: 477.66MB
2025-02-26 00:20:03,567 - __main__ - INFO - [app.py:279] - Request to /process-video took 34.23s
2025-02-26 00:20:03,721 - services.video_routes - INFO - [video_routes.py:301] - Detected speech starts at: 0.54 seconds
2025-02-26 00:20:03,722 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 00:20:03,722 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 00:20:03,722 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 00:20:03,746 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 00:20:11,511 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 00:20:11,511 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 00:20:16,903 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 00:20:19,974 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 00:20:19,976 - services.video_routes - INFO - [video_routes.py:271] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqi9yuspw.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --sample_mode cross --time_step 500
2025-02-26 00:20:23,826 - services.video_routes - ERROR - [video_routes.py:275] - Diff2Lip failed: Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 15, in <module>
    from guided_diffusion import dist_util, logger
  File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 9, in <module>
    import blobfile as bf
ModuleNotFoundError: No module named 'blobfile'

2025-02-26 00:20:23,826 - services.video_routes - WARNING - [video_routes.py:338] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 00:35:21,516 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 00:35:21,517 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 00:35:26,521 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:35:26,522 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:35:26,523 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:35:26,525 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:35:26,526 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:35:26,527 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 00:35:26,531 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:35:26,531 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:35:26,532 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:35:26,532 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:35:26,533 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:35:26,533 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:35:26,533 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:35:26,533 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:35:26,534 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:35:26,534 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:36:02,831 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 00:36:02,831 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 00:36:15,535 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 00:36:15,535 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:36:15,536 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:36:37,289 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:36:37,290 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:36:52,930 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:36:52,931 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:36:52,932 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 00:36:52,932 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:36:52,933 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:37:08,659 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:37:08,659 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:37:23,731 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:37:23,731 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.0GB available
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 00:37:23,734 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 00:40:45,520 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 00:40:45,520 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 00:40:45,520 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:40:45,521 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:41:03,056 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:41:03,057 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:41:23,117 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:41:23,117 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:41:23,119 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 37.60s, Memory Change: 39.45MB
2025-02-26 00:41:23,120 - __main__ - INFO - [app.py:279] - Request to /process-video took 37.60s
2025-02-26 00:41:23,285 - services.video_routes - INFO - [video_routes.py:301] - Detected speech starts at: 0.54 seconds
2025-02-26 00:41:23,285 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 00:41:23,286 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 00:41:23,291 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 00:41:23,331 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 00:41:31,253 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 00:41:31,253 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 00:41:36,661 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 00:41:39,713 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 00:41:39,715 - services.video_routes - INFO - [video_routes.py:271] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpogv0d9td.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --sample_mode cross --time_step 500
2025-02-26 00:41:41,700 - services.video_routes - ERROR - [video_routes.py:275] - Diff2Lip failed: Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 20, in <module>
    from guided_diffusion.guided_diffusion import dist_util, logger
ModuleNotFoundError: No module named 'guided_diffusion.guided_diffusion'

2025-02-26 00:41:41,700 - services.video_routes - WARNING - [video_routes.py:338] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 00:58:49,717 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 00:58:49,718 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 00:58:54,722 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:58:54,723 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:58:54,724 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:58:54,726 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:58:54,727 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:58:54,727 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 00:58:54,728 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:58:54,728 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:58:54,729 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:58:54,730 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:58:54,730 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:58:54,731 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 00:58:54,731 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 00:58:54,731 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 00:58:54,732 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 00:58:54,733 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 00:59:10,652 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 00:59:10,652 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 00:59:23,275 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 00:59:23,275 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:59:23,275 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 00:59:40,776 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 00:59:40,776 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 00:59:55,392 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 00:59:55,393 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 00:59:55,395 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 00:59:55,395 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 00:59:55,395 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 01:00:10,384 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 01:00:10,384 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 01:00:29,520 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 01:00:29,520 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 13.3GB available
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 01:00:29,525 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 01:01:27,356 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 01:01:27,356 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 01:01:27,356 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 01:01:27,357 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 01:01:43,612 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 01:01:43,612 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 01:01:59,092 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 01:01:59,092 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 01:01:59,094 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 31.74s, Memory Change: 17.23MB
2025-02-26 01:01:59,094 - __main__ - INFO - [app.py:279] - Request to /process-video took 31.74s
2025-02-26 01:01:59,259 - services.video_routes - INFO - [video_routes.py:301] - Detected speech starts at: 0.54 seconds
2025-02-26 01:01:59,259 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 01:01:59,260 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 01:01:59,260 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 01:01:59,298 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 01:02:06,771 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 01:02:06,772 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 01:02:12,218 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 01:02:15,152 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 01:02:15,155 - services.video_routes - INFO - [video_routes.py:271] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkfkm8mda.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --sample_mode cross --time_step 500
2025-02-26 01:02:17,292 - services.video_routes - ERROR - [video_routes.py:275] - Diff2Lip failed: Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 20, in <module>
    from guided_diffusion import dist_util, logger
  File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 10, in <module>
    from mpi4py import MPI
ModuleNotFoundError: No module named 'mpi4py'

2025-02-26 01:02:17,293 - services.video_routes - WARNING - [video_routes.py:338] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 08:25:46,801 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 08:25:46,802 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 08:25:51,805 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:25:51,806 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:25:51,806 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:25:51,808 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:25:51,808 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:25:51,809 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 08:25:51,810 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:25:51,810 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:25:51,810 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:25:51,811 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:25:51,811 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:25:51,812 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:25:51,812 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:25:51,812 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:25:51,813 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:25:51,813 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:26:14,290 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 08:26:14,290 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 08:26:31,431 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 08:26:31,431 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:26:31,432 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:26:53,693 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:26:53,694 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:27:10,237 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:27:10,237 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:27:10,239 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 08:27:10,239 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:27:10,240 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:27:24,130 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:27:24,130 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:27:41,648 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:27:41,648 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:27:41,651 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 11.3GB available
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 08:27:41,652 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 08:28:56,354 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 08:28:56,355 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 08:28:56,355 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:28:56,355 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:29:12,041 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:29:12,042 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:29:25,500 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:29:25,500 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:29:25,503 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 29.15s, Memory Change: 57.84MB
2025-02-26 08:29:25,504 - __main__ - INFO - [app.py:279] - Request to /process-video took 29.15s
2025-02-26 08:29:26,018 - services.video_routes - INFO - [video_routes.py:301] - Detected speech starts at: 0.54 seconds
2025-02-26 08:29:26,019 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 08:29:26,019 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 08:29:26,020 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 08:29:26,081 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 08:29:33,582 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 08:29:33,582 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 08:29:39,079 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 08:29:42,055 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 08:29:42,058 - services.video_routes - INFO - [video_routes.py:271] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmptu8k8zlx.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --sample_mode cross --time_step 500
2025-02-26 08:29:44,884 - services.video_routes - ERROR - [video_routes.py:275] - Diff2Lip failed: Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 20, in <module>
    from guided_diffusion import dist_util, logger
  File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/logger.py", line 17, in <module>
    from torch.utils.tensorboard import SummaryWriter
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/utils/tensorboard/__init__.py", line 1, in <module>
    import tensorboard
ModuleNotFoundError: No module named 'tensorboard'

2025-02-26 08:29:44,884 - services.video_routes - WARNING - [video_routes.py:338] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 08:39:18,795 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 08:39:18,796 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 08:39:23,801 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:39:23,803 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:39:23,803 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:39:23,806 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:39:23,807 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:39:23,807 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 08:39:23,809 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:39:23,809 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:39:23,809 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:39:23,810 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:39:23,810 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:39:23,811 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:39:23,811 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:39:23,811 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:39:23,812 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:39:23,812 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:40:46,657 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 08:40:46,658 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 08:40:59,228 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 08:40:59,229 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:40:59,229 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:41:14,056 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:41:14,056 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:41:31,435 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:41:31,435 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:41:31,438 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 08:41:31,438 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:41:31,439 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:41:50,788 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:41:50,789 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:42:05,882 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:42:05,882 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 08:42:05,884 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.0GB available
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 08:42:05,885 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 08:43:02,887 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 08:43:02,887 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 08:43:02,887 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:43:02,888 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:43:20,301 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:43:20,301 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:43:36,811 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:43:36,812 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:43:36,816 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 33.93s, Memory Change: -119.16MB
2025-02-26 08:43:36,816 - __main__ - INFO - [app.py:279] - Request to /process-video took 33.93s
2025-02-26 08:43:36,972 - services.video_routes - INFO - [video_routes.py:301] - Detected speech starts at: 0.54 seconds
2025-02-26 08:43:36,973 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 08:43:36,973 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 08:43:36,974 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 08:43:37,013 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 08:43:45,105 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 08:43:45,105 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 08:43:51,033 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 08:43:54,449 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 08:43:54,451 - services.video_routes - INFO - [video_routes.py:271] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmppvksyl0o.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --sample_mode cross --time_step 500
2025-02-26 08:43:56,910 - services.video_routes - ERROR - [video_routes.py:275] - Diff2Lip failed: usage: generate.py [-h] [--generate_from_filelist GENERATE_FROM_FILELIST]
                   [--video_path VIDEO_PATH] [--audio_path AUDIO_PATH]
                   [--out_path OUT_PATH] [--save_orig SAVE_ORIG]
                   [--test_video_dir TEST_VIDEO_DIR] [--filelist FILELIST]
                   [--use_fp16 USE_FP16]
                   [--face_hide_percentage FACE_HIDE_PERCENTAGE]
                   [--use_ref USE_REF] [--use_audio USE_AUDIO]
                   [--audio_as_style AUDIO_AS_STYLE]
                   [--audio_as_style_encoder_mlp AUDIO_AS_STYLE_ENCODER_MLP]
                   [--nframes NFRAMES] [--nrefer NREFER]
                   [--image_size IMAGE_SIZE] [--syncnet_T SYNCNET_T]
                   [--syncnet_mel_step_size SYNCNET_MEL_STEP_SIZE]
                   [--audio_frames_per_video AUDIO_FRAMES_PER_VIDEO]
                   [--audio_dim AUDIO_DIM] [--is_voxceleb2 IS_VOXCELEB2]
                   [--video_fps VIDEO_FPS] [--sample_rate SAMPLE_RATE]
                   [--mel_steps_per_sec MEL_STEPS_PER_SEC]
                   [--clip_denoised CLIP_DENOISED]
                   [--sampling_batch_size SAMPLING_BATCH_SIZE]
                   [--use_ddim USE_DDIM] [--model_path MODEL_PATH]
                   [--sample_path SAMPLE_PATH]
                   [--sample_partition SAMPLE_PARTITION]
                   [--sampling_seed SAMPLING_SEED]
                   [--sampling_use_gt_for_ref SAMPLING_USE_GT_FOR_REF]
                   [--sampling_ref_type SAMPLING_REF_TYPE]
                   [--sampling_input_type SAMPLING_INPUT_TYPE]
                   [--face_det_batch_size FACE_DET_BATCH_SIZE] [--pads PADS]
                   [--num_channels NUM_CHANNELS]
                   [--num_res_blocks NUM_RES_BLOCKS] [--num_heads NUM_HEADS]
                   [--num_heads_upsample NUM_HEADS_UPSAMPLE]
                   [--num_head_channels NUM_HEAD_CHANNELS]
                   [--attention_resolutions ATTENTION_RESOLUTIONS]
                   [--dropout DROPOUT] [--class_cond CLASS_COND]
                   [--use_checkpoint USE_CHECKPOINT]
                   [--use_scale_shift_norm USE_SCALE_SHIFT_NORM]
                   [--resblock_updown RESBLOCK_UPDOWN]
                   [--learn_sigma LEARN_SIGMA]
                   [--diffusion_steps DIFFUSION_STEPS]
                   [--noise_schedule NOISE_SCHEDULE]
                   [--timestep_respacing TIMESTEP_RESPACING] [--use_kl USE_KL]
                   [--predict_xstart PREDICT_XSTART]
                   [--rescale_timesteps RESCALE_TIMESTEPS]
                   [--rescale_learned_sigmas RESCALE_LEARNED_SIGMAS]
                   [--loss_variation LOSS_VARIATION]
                   [--audio_encoder_kwargs AUDIO_ENCODER_KWARGS]
generate.py: error: ambiguous option: --face could match --face_hide_percentage, --face_det_batch_size

2025-02-26 08:43:56,910 - services.video_routes - WARNING - [video_routes.py:338] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 08:53:09,768 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 08:53:09,771 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 08:53:14,775 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:53:14,777 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:53:14,778 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:53:14,780 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:53:14,782 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:53:14,782 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 08:53:14,784 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:53:14,784 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:53:14,785 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:53:14,786 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:53:14,787 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:53:14,792 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 08:53:14,793 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 08:53:14,793 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 08:53:14,794 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:53:14,794 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 08:53:32,457 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 08:53:32,457 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 08:53:45,455 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 08:53:45,455 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:53:45,455 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:54:06,406 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:54:06,407 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:54:22,037 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:54:22,037 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:54:22,039 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 08:54:22,039 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:54:22,039 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:54:42,231 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:54:42,231 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:54:59,243 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:54:59,244 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 10.9GB available
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 08:54:59,248 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 08:54:59,249 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 08:54:59,249 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 08:54:59,249 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 08:58:20,540 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 08:58:20,541 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 08:58:20,541 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 08:58:20,542 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 08:58:41,664 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 08:58:41,665 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 08:58:57,526 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 08:58:57,527 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 08:58:57,530 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.99s, Memory Change: 658.45MB
2025-02-26 08:58:57,530 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.99s
2025-02-26 08:58:57,704 - services.video_routes - INFO - [video_routes.py:300] - Detected speech starts at: 0.54 seconds
2025-02-26 08:58:57,704 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 08:58:57,704 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 08:58:57,705 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 08:58:57,730 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 08:59:05,408 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 08:59:05,409 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 08:59:10,877 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 08:59:13,944 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 08:59:13,946 - services.video_routes - INFO - [video_routes.py:270] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp15o3jqy7.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt
2025-02-26 08:59:16,539 - services.video_routes - ERROR - [video_routes.py:274] - Diff2Lip failed: [rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 61, in load_state_dict
[rank0]:     with bf.BlobFile(path, "rb") as f:
[rank0]:          ^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/blobfile/_ops.py", line 393, in BlobFile
[rank0]:     return default_context.BlobFile(
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/blobfile/_context.py", line 866, in BlobFile
[rank0]:     raise IsADirectoryError(f"Is a directory: '{path}'")
[rank0]: IsADirectoryError: Is a directory: 'diff2lip/checkpoints/archive'

2025-02-26 08:59:16,540 - services.video_routes - WARNING - [video_routes.py:337] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 20:02:25,365 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 20:02:25,368 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 20:02:30,371 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 20:02:30,373 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 20:02:30,374 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 20:02:30,377 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 20:02:30,378 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 20:02:30,378 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 20:02:30,380 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 20:02:30,381 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 20:02:30,381 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 20:02:30,382 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 20:02:30,382 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 20:02:30,383 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 20:02:30,384 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 20:02:30,384 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 20:02:30,385 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 20:02:30,385 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 20:03:32,357 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 20:03:32,357 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 20:03:45,413 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 20:03:45,413 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 20:03:45,414 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 20:04:05,104 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 20:04:05,104 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 20:04:24,521 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 20:04:24,521 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 20:04:24,523 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 20:04:24,523 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 20:04:24,523 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 20:04:41,580 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 20:04:41,581 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 20:04:58,229 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 20:04:58,229 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.0GB available
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 20:04:58,233 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 20:05:59,837 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 20:05:59,837 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 20:05:59,837 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 20:05:59,838 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 20:06:19,485 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 20:06:19,485 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 20:06:35,073 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 20:06:35,074 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 20:06:35,077 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 35.24s, Memory Change: 87.08MB
2025-02-26 20:06:35,077 - __main__ - INFO - [app.py:279] - Request to /process-video took 35.24s
2025-02-26 20:06:36,958 - services.video_routes - INFO - [video_routes.py:300] - Detected speech starts at: 0.54 seconds
2025-02-26 20:06:36,958 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 20:06:36,959 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 20:06:36,959 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 20:06:37,014 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 20:06:44,582 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 20:06:44,582 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 20:06:50,015 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 20:06:53,103 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 20:06:53,105 - services.video_routes - INFO - [video_routes.py:270] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive/data.pkl --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpnsw4qu9y.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt
2025-02-26 20:06:57,120 - services.video_routes - ERROR - [video_routes.py:274] - Diff2Lip failed: /Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py:75: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return th.load(io.BytesIO(data), **kwargs)
[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 75, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), **kwargs)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
[rank0]:     return _legacy_load(
[rank0]:            ^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load function was specified.

2025-02-26 20:06:57,120 - services.video_routes - WARNING - [video_routes.py:337] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 22:02:37,436 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 22:02:37,439 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 22:02:42,442 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 22:02:42,444 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 22:02:42,445 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 22:02:42,447 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 22:02:42,449 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 22:02:42,449 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 22:02:42,451 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 22:02:42,451 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 22:02:42,452 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 22:02:42,453 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 22:02:42,453 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 22:02:42,453 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 22:02:42,453 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 22:02:42,454 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 22:02:42,454 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 22:02:42,455 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 22:02:57,394 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 22:02:57,395 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 22:03:10,129 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 22:03:10,129 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 22:03:10,130 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 22:03:30,315 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 22:03:30,316 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 22:03:46,142 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 22:03:46,142 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 22:03:46,144 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 22:03:46,144 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 22:03:46,144 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 22:04:04,216 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 22:04:04,217 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 22:04:20,041 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 22:04:20,042 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 12.7GB available
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 22:04:20,045 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 22:04:55,493 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 22:04:55,493 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 22:04:55,493 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 22:04:55,494 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 22:05:15,516 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 22:05:15,516 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 22:05:31,987 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 22:05:31,987 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 22:05:31,991 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.50s, Memory Change: 426.09MB
2025-02-26 22:05:31,991 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.50s
2025-02-26 22:05:33,998 - services.video_routes - INFO - [video_routes.py:300] - Detected speech starts at: 0.54 seconds
2025-02-26 22:05:33,999 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 22:05:33,999 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 22:05:34,000 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 22:05:34,027 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 22:05:41,657 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 22:05:41,658 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 22:05:47,067 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 22:05:50,107 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 22:05:50,109 - services.video_routes - INFO - [video_routes.py:270] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive/data.pkl --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkz4mbnm_.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt
2025-02-26 22:05:54,295 - services.video_routes - ERROR - [video_routes.py:274] - Diff2Lip failed: [rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 77, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), map_location=kwargs["map_location"], weights_only=True)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1111, in load
[rank0]:     return _legacy_load(opened_file, map_location, _weights_only_unpickler, **pickle_load_args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 383, in load
[rank0]:     return Unpickler(file, encoding=encoding).load()
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 342, in load
[rank0]:     self.append(self.persistent_load(pid))
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 379, in persistent_load
[rank0]:     raise UnpicklingError("unsupported persistent id encountered")
[rank0]: _pickle.UnpicklingError: unsupported persistent id encountered

2025-02-26 22:05:54,295 - services.video_routes - WARNING - [video_routes.py:337] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 23:11:40,538 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 23:11:40,539 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 23:11:40,540 - services.model_manager - INFO - [model_manager.py:211] - Model inactive for too long, reloading...
2025-02-26 23:11:40,540 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 23:11:53,830 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 23:11:53,830 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:11:53,831 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:12:15,223 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:12:15,223 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:12:31,408 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:12:31,408 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:12:31,410 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 23:12:31,410 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:12:31,411 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:12:51,825 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:12:51,825 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:13:12,351 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:13:12,351 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:13:12,356 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 91.82s, Memory Change: 13695.09MB
2025-02-26 23:13:12,357 - __main__ - INFO - [app.py:279] - Request to /process-video took 91.82s
2025-02-26 23:13:13,737 - services.video_routes - INFO - [video_routes.py:300] - Detected speech starts at: 0.54 seconds
2025-02-26 23:13:13,737 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 23:13:13,737 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 23:13:13,738 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 23:13:13,775 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 23:13:21,472 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 23:13:21,472 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 23:13:26,936 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 23:13:29,536 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 23:13:29,538 - services.video_routes - INFO - [video_routes.py:270] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive/data.pkl --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpd1ratwn2.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt
2025-02-26 23:13:33,229 - services.video_routes - ERROR - [video_routes.py:274] - Diff2Lip failed: [rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 77, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), map_location=kwargs["map_location"], weights_only=True)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1111, in load
[rank0]:     return _legacy_load(opened_file, map_location, _weights_only_unpickler, **pickle_load_args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 383, in load
[rank0]:     return Unpickler(file, encoding=encoding).load()
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 342, in load
[rank0]:     self.append(self.persistent_load(pid))
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 379, in persistent_load
[rank0]:     raise UnpicklingError("unsupported persistent id encountered")
[rank0]: _pickle.UnpicklingError: unsupported persistent id encountered

2025-02-26 23:13:33,229 - services.video_routes - WARNING - [video_routes.py:337] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-26 23:39:08,846 - __main__ - ERROR - [app.py:550] - Failed to start application: [Errno 48] Address already in use
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/app.py", line 480, in <module>
    start_http_server(8000)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_client/exposition.py", line 170, in start_wsgi_server
    httpd = make_server(addr, port, app, TmpServer, handler_class=_SilentHandler)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 154, in make_server
    server = server_class((host, port), handler_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 50, in server_bind
    HTTPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/http/server.py", line 136, in server_bind
    socketserver.TCPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use
2025-02-26 23:39:08,848 - __main__ - ERROR - [app.py:552] - Stack trace:
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/app.py", line 480, in <module>
    start_http_server(8000)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_client/exposition.py", line 170, in start_wsgi_server
    httpd = make_server(addr, port, app, TmpServer, handler_class=_SilentHandler)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 154, in make_server
    server = server_class((host, port), handler_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 50, in server_bind
    HTTPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/http/server.py", line 136, in server_bind
    socketserver.TCPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use
2025-02-26 23:39:08,849 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:39:08,855 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 23:39:08,855 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 23:39:21,944 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 23:39:21,944 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:39:21,945 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:39:41,835 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:39:41,835 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:40:00,417 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:40:00,417 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:40:00,419 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 23:40:00,419 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 23:40:00,525 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 23:40:00,525 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:40:00,525 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 23:42:34,981 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-26 23:42:34,982 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-26 23:42:39,987 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 23:42:39,988 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 23:42:40,146 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 23:42:40,147 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:42:40,148 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 23:42:40,148 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-26 23:42:40,148 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 23:42:40,148 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 23:42:40,149 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 23:42:40,149 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:42:40,149 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 23:42:40,149 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-26 23:42:40,149 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-26 23:42:40,149 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-26 23:42:40,149 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:42:40,149 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-26 23:43:11,697 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-26 23:43:11,699 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-26 23:43:25,375 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-26 23:43:25,375 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:43:25,376 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:43:45,788 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:43:45,789 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:44:05,282 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:44:05,283 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:44:05,285 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-26 23:44:05,285 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:44:05,286 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:44:21,458 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:44:21,458 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:44:41,100 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:44:41,100 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 16.0GB available
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-26 23:44:41,105 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-26 23:44:41,106 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-26 23:44:41,106 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-26 23:44:41,106 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-26 23:44:41,106 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-26 23:44:41,106 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-26 23:45:34,726 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-26 23:45:34,726 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-26 23:45:34,726 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-26 23:45:34,727 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-26 23:45:51,883 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-26 23:45:51,883 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-26 23:46:08,593 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-26 23:46:08,593 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-26 23:46:08,597 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 33.87s, Memory Change: 12.55MB
2025-02-26 23:46:08,597 - __main__ - INFO - [app.py:279] - Request to /process-video took 33.87s
2025-02-26 23:46:08,797 - services.video_routes - INFO - [video_routes.py:335] - Detected speech starts at: 0.54 seconds
2025-02-26 23:46:08,798 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-26 23:46:08,798 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-26 23:46:08,798 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-26 23:46:08,832 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-26 23:46:16,841 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-26 23:46:16,842 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-26 23:46:22,315 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-26 23:46:25,283 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-26 23:46:25,286 - services.video_routes - INFO - [video_routes.py:274] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive/data.pkl --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp1q18prdz.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt --cpu
2025-02-26 23:46:27,900 - services.video_routes - ERROR - [video_routes.py:287] - Diff2Lip failed with return code 2: usage: generate.py [-h] [--generate_from_filelist GENERATE_FROM_FILELIST]
                   [--video_path VIDEO_PATH] [--audio_path AUDIO_PATH]
                   [--out_path OUT_PATH] [--save_orig SAVE_ORIG]
                   [--test_video_dir TEST_VIDEO_DIR] [--filelist FILELIST]
                   [--use_fp16 USE_FP16]
                   [--face_hide_percentage FACE_HIDE_PERCENTAGE]
                   [--use_ref USE_REF] [--use_audio USE_AUDIO]
                   [--audio_as_style AUDIO_AS_STYLE]
                   [--audio_as_style_encoder_mlp AUDIO_AS_STYLE_ENCODER_MLP]
                   [--nframes NFRAMES] [--nrefer NREFER]
                   [--image_size IMAGE_SIZE] [--syncnet_T SYNCNET_T]
                   [--syncnet_mel_step_size SYNCNET_MEL_STEP_SIZE]
                   [--audio_frames_per_video AUDIO_FRAMES_PER_VIDEO]
                   [--audio_dim AUDIO_DIM] [--is_voxceleb2 IS_VOXCELEB2]
                   [--video_fps VIDEO_FPS] [--sample_rate SAMPLE_RATE]
                   [--mel_steps_per_sec MEL_STEPS_PER_SEC]
                   [--clip_denoised CLIP_DENOISED]
                   [--sampling_batch_size SAMPLING_BATCH_SIZE]
                   [--use_ddim USE_DDIM] [--model_path MODEL_PATH]
                   [--sample_path SAMPLE_PATH]
                   [--sample_partition SAMPLE_PARTITION]
                   [--sampling_seed SAMPLING_SEED]
                   [--sampling_use_gt_for_ref SAMPLING_USE_GT_FOR_REF]
                   [--sampling_ref_type SAMPLING_REF_TYPE]
                   [--sampling_input_type SAMPLING_INPUT_TYPE]
                   [--face_det_batch_size FACE_DET_BATCH_SIZE] [--pads PADS]
                   [--num_channels NUM_CHANNELS]
                   [--num_res_blocks NUM_RES_BLOCKS] [--num_heads NUM_HEADS]
                   [--num_heads_upsample NUM_HEADS_UPSAMPLE]
                   [--num_head_channels NUM_HEAD_CHANNELS]
                   [--attention_resolutions ATTENTION_RESOLUTIONS]
                   [--dropout DROPOUT] [--class_cond CLASS_COND]
                   [--use_checkpoint USE_CHECKPOINT]
                   [--use_scale_shift_norm USE_SCALE_SHIFT_NORM]
                   [--resblock_updown RESBLOCK_UPDOWN]
                   [--learn_sigma LEARN_SIGMA]
                   [--diffusion_steps DIFFUSION_STEPS]
                   [--noise_schedule NOISE_SCHEDULE]
                   [--timestep_respacing TIMESTEP_RESPACING] [--use_kl USE_KL]
                   [--predict_xstart PREDICT_XSTART]
                   [--rescale_timesteps RESCALE_TIMESTEPS]
                   [--rescale_learned_sigmas RESCALE_LEARNED_SIGMAS]
                   [--loss_variation LOSS_VARIATION]
                   [--audio_encoder_kwargs AUDIO_ENCODER_KWARGS]
generate.py: error: unrecognized arguments: --cpu

2025-02-26 23:46:27,900 - services.video_routes - WARNING - [video_routes.py:372] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-27 00:01:58,677 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-27 00:01:58,681 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-27 00:02:03,684 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 00:02:03,685 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 00:02:03,685 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 00:02:03,688 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 00:02:03,689 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 00:02:03,690 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-27 00:02:03,692 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 00:02:03,693 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 00:02:03,693 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 00:02:03,694 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 00:02:03,694 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 00:02:03,694 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 00:02:03,694 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 00:02:03,695 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 00:02:03,696 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 00:02:03,696 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 00:02:45,073 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-27 00:02:45,073 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-27 00:02:57,853 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-27 00:02:57,853 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 00:02:57,854 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 00:03:16,464 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 00:03:16,464 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 00:03:31,247 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 00:03:31,247 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 00:03:31,250 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-27 00:03:31,250 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 00:03:31,251 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 00:03:50,374 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 00:03:50,374 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 00:04:05,380 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 00:04:05,380 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 00:04:05,383 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 00:04:05,383 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-27 00:04:05,383 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-27 00:04:05,383 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 16.1GB available
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-27 00:04:05,384 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-27 00:04:46,874 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-27 00:04:46,874 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-27 00:04:46,874 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 00:04:46,875 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 00:05:04,359 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 00:05:04,359 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 00:05:24,899 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 00:05:24,899 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 00:05:24,902 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 38.03s, Memory Change: 10.98MB
2025-02-27 00:05:24,902 - __main__ - INFO - [app.py:279] - Request to /process-video took 38.03s
2025-02-27 00:05:25,006 - services.video_routes - INFO - [video_routes.py:336] - Detected speech starts at: 0.54 seconds
2025-02-27 00:05:25,006 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-27 00:05:25,006 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-27 00:05:25,007 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-27 00:05:25,047 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-27 00:05:33,541 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-27 00:05:33,541 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-27 00:05:39,200 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-27 00:05:42,225 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-27 00:05:42,229 - services.video_routes - INFO - [video_routes.py:273] - Running Diff2Lip with command: python diff2lip/generate.py --model_path diff2lip/checkpoints/archive/data.pkl --video_path /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpfje9mbqs.mp4 --audio_path temp/translated_audio.wav --out_path temp/synced_video.mp4 --sampling_ref_type gt
2025-02-27 00:05:45,059 - services.video_routes - ERROR - [video_routes.py:286] - Diff2Lip failed with return code 1: /Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py:105: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return th.load(io.BytesIO(data),
[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 81, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
[rank0]:     return _legacy_load(
[rank0]:            ^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: TypeError: 'persistent_load' is an invalid keyword argument for load()

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 94, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1111, in load
[rank0]:     return _legacy_load(opened_file, map_location, _weights_only_unpickler, **pickle_load_args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 383, in load
[rank0]:     return Unpickler(file, encoding=encoding).load()
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 342, in load
[rank0]:     self.append(self.persistent_load(pid))
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 379, in persistent_load
[rank0]:     raise UnpicklingError("unsupported persistent id encountered")
[rank0]: _pickle.UnpicklingError: unsupported persistent id encountered

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 105, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
[rank0]:     return _legacy_load(
[rank0]:            ^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load function was specified.

2025-02-27 00:05:45,060 - services.video_routes - ERROR - [video_routes.py:290] - Model loading failed. Trying alternative approach...
2025-02-27 00:05:45,060 - services.video_routes - INFO - [video_routes.py:297] - Running Diff2Lip with forced CPU environment
2025-02-27 00:05:47,298 - services.video_routes - ERROR - [video_routes.py:305] - Alternative approach also failed: /Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py:105: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return th.load(io.BytesIO(data),
[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 81, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
[rank0]:     return _legacy_load(
[rank0]:            ^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: TypeError: 'persistent_load' is an invalid keyword argument for load()

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 94, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1111, in load
[rank0]:     return _legacy_load(opened_file, map_location, _weights_only_unpickler, **pickle_load_args)
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 383, in load
[rank0]:     return Unpickler(file, encoding=encoding).load()
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 342, in load
[rank0]:     self.append(self.persistent_load(pid))
[rank0]:                 ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/_weights_only_unpickler.py", line 379, in persistent_load
[rank0]:     raise UnpicklingError("unsupported persistent id encountered")
[rank0]: _pickle.UnpicklingError: unsupported persistent id encountered

[rank0]: During handling of the above exception, another exception occurred:

[rank0]: Traceback (most recent call last):
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 403, in <module>
[rank0]:     main()
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/generate.py", line 329, in main
[rank0]:     dist_util.load_state_dict(args.model_path, map_location='cpu')
[rank0]:   File "/Users/robmills/audio-translation/Backend/diff2lip/guided_diffusion/dist_util.py", line 105, in load_state_dict
[rank0]:     return th.load(io.BytesIO(data), 
[rank0]:            ^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
[rank0]:     return _legacy_load(
[rank0]:            ^^^^^^^^^^^^^
[rank0]:   File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
[rank0]:     magic_number = pickle_module.load(f, **pickle_load_args)
[rank0]:                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[rank0]: _pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load function was specified.

2025-02-27 00:05:47,299 - services.video_routes - WARNING - [video_routes.py:373] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-27 08:46:34,319 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-27 08:46:34,320 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-27 08:46:39,326 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 08:46:39,327 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 08:46:39,328 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 08:46:39,330 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 08:46:39,331 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 08:46:39,331 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-27 08:46:39,333 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 08:46:39,333 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 08:46:39,334 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 08:46:39,334 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 08:46:39,335 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 08:46:39,335 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 08:46:39,336 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 08:46:39,336 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 08:46:39,337 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 08:46:39,338 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 08:47:57,596 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-27 08:47:57,597 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-27 08:48:10,866 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-27 08:48:10,867 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 08:48:10,867 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 08:48:29,375 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 08:48:29,376 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 08:48:49,921 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 08:48:49,921 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 08:48:49,924 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-27 08:48:49,924 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 08:48:49,924 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 08:49:11,597 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 08:49:11,598 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 08:49:27,927 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 08:49:27,927 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.9GB available
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-27 08:49:27,931 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-27 08:50:17,338 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-27 08:50:17,338 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-27 08:50:17,338 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 08:50:17,339 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 08:50:39,554 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 08:50:39,555 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 08:50:56,751 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 08:50:56,752 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 08:50:56,756 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 39.42s, Memory Change: 14.39MB
2025-02-27 08:50:56,756 - __main__ - INFO - [app.py:279] - Request to /process-video took 39.42s
2025-02-27 08:50:57,622 - services.video_routes - INFO - [video_routes.py:339] - Detected speech starts at: 0.54 seconds
2025-02-27 08:50:57,622 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-27 08:50:57,622 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-27 08:50:57,624 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-27 08:50:57,650 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-27 08:51:05,502 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-27 08:51:05,502 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-27 08:51:11,044 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-27 08:51:14,021 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-27 08:51:14,055 - services.video_routes - ERROR - [video_routes.py:283] - Model pre-check failed:   File "<string>", line 2
    import sys
IndentationError: unexpected indent

2025-02-27 08:51:14,056 - services.video_routes - WARNING - [video_routes.py:376] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-27 09:14:46,744 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-27 09:14:46,745 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-27 09:14:51,748 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 09:14:51,749 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 09:14:51,750 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 09:14:51,752 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 09:14:51,753 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 09:14:51,754 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-27 09:14:51,755 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 09:14:51,755 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 09:14:51,755 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 09:14:51,757 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 09:14:51,757 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 09:14:51,758 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-27 09:14:51,758 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-27 09:14:51,758 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-27 09:14:51,759 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 09:14:51,759 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-27 09:15:09,351 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-27 09:15:09,351 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-27 09:15:22,945 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-27 09:15:22,945 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 09:15:22,945 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 09:15:43,779 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 09:15:43,779 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 09:16:02,682 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 09:16:02,683 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 09:16:02,685 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-27 09:16:02,685 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 09:16:02,685 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 09:16:23,868 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 09:16:23,868 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 09:16:45,073 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 09:16:45,073 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-27 09:16:45,077 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 16.5GB available
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-27 09:16:45,078 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-27 09:18:11,258 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-27 09:18:11,258 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-27 09:18:11,258 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-27 09:18:11,258 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-27 09:18:31,607 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-27 09:18:31,607 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-27 09:18:47,422 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-27 09:18:47,422 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-27 09:18:47,424 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.17s, Memory Change: 25.59MB
2025-02-27 09:18:47,424 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.17s
2025-02-27 09:18:47,580 - services.video_routes - INFO - [video_routes.py:339] - Detected speech starts at: 0.54 seconds
2025-02-27 09:18:47,580 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-27 09:18:47,580 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-27 09:18:47,581 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-27 09:18:47,617 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-27 09:18:55,465 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-27 09:18:55,465 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-27 09:19:01,469 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-27 09:19:04,514 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-27 09:19:05,304 - services.video_routes - ERROR - [video_routes.py:283] - Model pre-check failed: Custom model loading failed: 'tuple' object has no attribute 'dtype'
/Users/robmills/audio-translation/Backend/diff2lip_loader.py:40: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  return torch.load(model_path, map_location=map_location)
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/diff2lip_loader.py", line 32, in custom_load_model
    model_dict = unpickler.load()
                 ^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/_utils.py", line 200, in _rebuild_tensor_v2
    tensor = _rebuild_tensor(storage, storage_offset, size, stride)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/_utils.py", line 178, in _rebuild_tensor
    t = torch.empty((0,), dtype=storage.dtype, device=storage._untyped_storage.device)
                                ^^^^^^^^^^^^^
AttributeError: 'tuple' object has no attribute 'dtype'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "<string>", line 6, in <module>
  File "/Users/robmills/audio-translation/Backend/diff2lip_loader.py", line 40, in custom_load_model
    return torch.load(model_path, map_location=map_location)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1114, in load
    return _legacy_load(
           ^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/torch/serialization.py", line 1338, in _legacy_load
    magic_number = pickle_module.load(f, **pickle_load_args)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
_pickle.UnpicklingError: A load persistent id instruction was encountered, but no persistent_load function was specified.

2025-02-27 09:19:05,305 - services.video_routes - WARNING - [video_routes.py:376] - Diff2Lip sync failed, falling back to basic audio sync
2025-02-28 08:03:49,959 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-28 08:03:49,964 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-28 08:03:54,967 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 08:03:54,969 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 08:03:54,969 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 08:03:54,972 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 08:03:54,973 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 08:03:54,974 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-28 08:03:54,976 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 08:03:54,977 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 08:03:54,977 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 08:03:54,979 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 08:03:54,979 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 08:03:54,980 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 08:03:54,980 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 08:03:54,980 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 08:03:54,981 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 08:03:54,982 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 09:34:19,225 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-28 09:34:19,225 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-28 09:34:31,810 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-28 09:34:31,810 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 09:34:31,813 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 09:34:59,090 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 09:34:59,091 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 09:35:16,526 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 09:35:16,527 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 09:35:16,528 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-28 09:35:16,528 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 09:35:16,529 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 09:35:29,800 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 09:35:29,800 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 09:35:44,868 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 09:35:44,868 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 14.2GB available
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-28 09:35:44,872 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-28 09:37:10,593 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-28 09:37:10,593 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-28 09:37:10,593 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 09:37:10,594 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 09:37:26,739 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 09:37:26,739 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 09:37:44,747 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 09:37:44,747 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 09:37:44,750 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 34.16s, Memory Change: 270.45MB
2025-02-28 09:37:44,751 - __main__ - INFO - [app.py:279] - Request to /process-video took 34.16s
2025-02-28 09:37:46,753 - services.video_routes - INFO - [video_routes.py:368] - Detected speech starts at: 0.54 seconds
2025-02-28 09:37:46,753 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-28 09:37:46,753 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 09:37:46,756 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-28 09:37:46,798 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-28 09:37:54,422 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-28 09:37:54,422 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-28 09:37:59,821 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-28 09:38:02,847 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-28 09:38:02,849 - services.video_routes - INFO - [video_routes.py:258] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpexk4cu26.mp4 + temp/translated_audio.wav
2025-02-28 09:38:02,849 - services.video_routes - INFO - [video_routes.py:296] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpexk4cu26.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0
2025-02-28 09:38:09,095 - services.video_routes - ERROR - [video_routes.py:309] - Wav2Lip process failed with return code 1: Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py", line 280, in <module>
    main()
  File "/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py", line 225, in main
    mel = audio.melspectrogram(wav)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/Wav2Lip/audio.py", line 47, in melspectrogram
    S = _amp_to_db(_linear_to_mel(np.abs(D))) - hp.ref_level_db
                   ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/Wav2Lip/audio.py", line 95, in _linear_to_mel
    _mel_basis = _build_mel_basis()
                 ^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/Wav2Lip/audio.py", line 100, in _build_mel_basis
    return librosa.filters.mel(hp.sample_rate, hp.n_fft, n_mels=hp.num_mels,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: mel() takes 0 positional arguments but 2 positional arguments (and 3 keyword-only arguments) were given

2025-02-28 09:38:09,096 - services.video_routes - WARNING - [video_routes.py:405] - Wav2Lip sync failed, falling back to basic audio sync
2025-02-28 10:00:15,613 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-28 10:00:15,614 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-28 10:00:20,619 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:00:20,619 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:00:20,619 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:00:20,620 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:00:20,620 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:00:20,620 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-28 10:00:20,621 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:00:20,621 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:00:20,621 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:00:20,621 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:00:20,621 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:00:20,621 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:00:20,621 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:00:20,621 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:00:20,622 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:00:20,622 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:00:33,577 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-28 10:00:33,577 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-28 10:00:46,238 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-28 10:00:46,238 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:00:46,239 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:01:03,724 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:01:03,724 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:01:19,475 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:01:19,475 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:01:19,477 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-28 10:01:19,477 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:01:19,478 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:01:34,348 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:01:34,348 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:01:51,909 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:01:51,910 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.5GB available
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-28 10:01:51,913 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-28 10:02:22,855 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-28 10:02:22,856 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-28 10:02:22,856 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:02:22,857 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:02:38,160 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:02:38,160 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:02:56,155 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:02:56,155 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:02:56,158 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 33.30s, Memory Change: 29.98MB
2025-02-28 10:02:56,158 - __main__ - INFO - [app.py:279] - Request to /process-video took 33.30s
2025-02-28 10:02:57,646 - services.video_routes - INFO - [video_routes.py:368] - Detected speech starts at: 0.54 seconds
2025-02-28 10:02:57,647 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-28 10:02:57,647 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 10:02:57,647 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-28 10:02:57,676 - services.video_routes - INFO - [video_routes.py:117] - Generating text translation in fra
2025-02-28 10:03:05,031 - services.video_routes - INFO - [video_routes.py:126] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-28 10:03:05,031 - services.video_routes - INFO - [video_routes.py:129] - Generating translated speech
2025-02-28 10:03:10,502 - services.video_routes - INFO - [video_routes.py:157] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-28 10:03:13,384 - services.video_routes - INFO - [video_routes.py:249] - Face detected with bounding box: (641, 245, 1057, 834)
2025-02-28 10:03:13,385 - services.video_routes - INFO - [video_routes.py:258] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu32h81bb.mp4 + temp/translated_audio.wav
2025-02-28 10:03:13,385 - services.video_routes - INFO - [video_routes.py:296] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpu32h81bb.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0
2025-02-28 10:10:15,474 - services.video_routes - ERROR - [video_routes.py:345] - Wav2Lip process timed out after 5 minutes
2025-02-28 10:10:15,476 - services.video_routes - WARNING - [video_routes.py:405] - Wav2Lip sync failed, falling back to basic audio sync
2025-02-28 10:24:20,040 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-02-28 10:24:20,043 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-02-28 10:24:25,048 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:24:25,050 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:24:25,051 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:24:25,053 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:24:25,055 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:24:25,055 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-02-28 10:24:25,057 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:24:25,057 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:24:25,057 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:24:25,058 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:24:25,058 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:24:25,059 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-02-28 10:24:25,060 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-02-28 10:24:25,060 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-02-28 10:24:25,061 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:24:25,061 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-02-28 10:24:48,240 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-28 10:24:48,240 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-28 10:25:01,272 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-28 10:25:01,272 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:25:01,275 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:25:25,790 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:25:25,791 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:25:45,103 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:25:45,103 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:25:45,106 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-28 10:25:45,106 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:25:45,106 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:25:59,261 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:25:59,262 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:26:14,420 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:26:14,420 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 16.6GB available
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-28 10:26:14,423 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-28 10:26:41,051 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-02-28 10:26:41,051 - services.video_routes - INFO - [video_routes.py:901] - Processing video: Movie on 20-02-2025 at 20.44.mov for language: fra
2025-02-28 10:26:41,051 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-02-28 10:26:41,051 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-28 10:26:41,051 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-28 10:26:41,051 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 10:26:41,052 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 10:27:00,891 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 10:27:00,892 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 10:27:19,761 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 10:27:19,761 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-02-28 10:27:19,766 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-02-28 10:27:19,766 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-02-28 10:27:19,767 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 38.72s, Memory Change: 53.78MB
2025-02-28 10:27:19,767 - __main__ - INFO - [app.py:279] - Request to /process-video took 38.72s
2025-02-28 10:27:19,767 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: fra
2025-02-28 10:27:19,767 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: Movie on 20-02-2025 at 20.44.mov, content type: video/quicktime
2025-02-28 10:27:19,776 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-02-28 10:27:19,777 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4
2025-02-28 10:27:19,777 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-02-28 10:27:19,856 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-02-28 10:27:19,856 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-02-28 10:27:19,859 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-02-28 10:27:19,859 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-02-28 10:27:19,859 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-28 10:27:19,860 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 10:27:19,860 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-28 10:27:19,871 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language fra
2025-02-28 10:27:19,885 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in fra
2025-02-28 10:27:27,378 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-28 10:27:27,378 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language fra
2025-02-28 10:27:32,767 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.39 seconds
2025-02-28 10:27:32,767 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-28 10:27:32,768 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 12.90 seconds
2025-02-28 10:27:32,768 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 81280]) to temp/translated_audio.wav
2025-02-28 10:27:32,769 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 162604 bytes)
2025-02-28 10:27:32,769 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4
2025-02-28 10:27:35,120 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-02-28 10:27:35,122 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 2.35 seconds, result: True
2025-02-28 10:27:35,122 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-02-28 10:27:35,122 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4 + temp/translated_audio.wav
2025-02-28 10:27:35,346 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 1.5
2025-02-28 10:27:36,577 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: usage: inference.py [-h] --checkpoint_path CHECKPOINT_PATH --face FACE --audio
                    AUDIO [--outfile OUTFILE] [--static STATIC] [--fps FPS]
                    [--pads PADS [PADS ...]]
                    [--face_det_batch_size FACE_DET_BATCH_SIZE]
                    [--wav2lip_batch_size WAV2LIP_BATCH_SIZE]
                    [--resize_factor RESIZE_FACTOR] [--crop CROP [CROP ...]]
                    [--box BOX [BOX ...]] [--rotate] [--nosmooth]
inference.py: error: argument --resize_factor: invalid int value: '1.5'

2025-02-28 10:27:36,577 - services.video_routes - ERROR - [video_routes.py:588] - Wav2Lip process failed with return code 2
2025-02-28 10:27:36,577 - services.video_routes - INFO - [video_routes.py:628] - Trying with different padding values...
2025-02-28 10:27:36,577 - services.video_routes - INFO - [video_routes.py:638] - Running Wav2Lip with alternative parameters: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmgpa3y0k.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 10 10 10 10 --resize_factor 2
2025-02-28 10:29:29,097 - services.video_routes - INFO - [video_routes.py:649] - Alt parameters stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 407)
Length of mel chunks: 149
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-02-28 10:29:29,099 - services.video_routes - ERROR - [video_routes.py:651] - Alt parameters stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/10 [00:00<?, ?it/s][A

 10%|█         | 1/10 [00:11<01:43, 11.55s/it][A

 20%|██        | 2/10 [00:22<01:31, 11.48s/it][A

 30%|███       | 3/10 [00:34<01:19, 11.40s/it][A

 40%|████      | 4/10 [00:45<01:08, 11.34s/it][A

 50%|█████     | 5/10 [00:56<00:56, 11.30s/it][A

 60%|██████    | 6/10 [01:08<00:45, 11.32s/it][A

 70%|███████   | 7/10 [01:19<00:33, 11.30s/it][A

 80%|████████  | 8/10 [01:30<00:22, 11.30s/it][A

 90%|█████████ | 9/10 [01:41<00:11, 11.30s/it][A

100%|██████████| 10/10 [01:45<00:00,  8.89s/it][A
100%|██████████| 10/10 [01:45<00:00, 10.55s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [01:48<01:48, 108.93s/it]
100%|██████████| 2/2 [01:49<00:00, 45.27s/it] 
100%|██████████| 2/2 [01:49<00:00, 54.82s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x14b104cb0] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:05.08, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:04.97, start: 0.000000, bitrate: 1577 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1573 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x14b109120] -qscale is ignored, -crf is recommended.
[libx264 @ 0x14b109120] using SAR=1/1
[libx264 @ 0x14b109120] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x14b109120] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x14b109120] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x14b105db0] video:381KiB audio:48KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.951279%
frame=  149 fps=0.0 q=-1.0 Lsize=     433KiB time=00:00:04.90 bitrate= 723.9kbits/s speed=19.5x    
[libx264 @ 0x14b109120] frame I:1     Avg QP:21.51  size: 21612
[libx264 @ 0x14b109120] frame P:67    Avg QP:22.42  size:  4539
[libx264 @ 0x14b109120] frame B:81    Avg QP:24.98  size:   788
[libx264 @ 0x14b109120] consecutive B-frames: 18.8% 25.5%  2.0% 53.7%
[libx264 @ 0x14b109120] mb I  I16..4: 17.0% 81.4%  1.6%
[libx264 @ 0x14b109120] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 42.0%  8.2%  4.6%  0.0%  0.0%    skip:39.2%
[libx264 @ 0x14b109120] mb B  I16..4:  0.3%  1.1%  0.0%  B16..8: 26.3%  0.8%  0.1%  direct: 0.2%  skip:71.2%  L0:43.3% L1:55.4% BI: 1.3%
[libx264 @ 0x14b109120] 8x8 transform intra:76.1% inter:83.4%
[libx264 @ 0x14b109120] coded y,uvDC,uvAC intra: 43.4% 57.4% 5.4% inter: 7.3% 12.7% 0.1%
[libx264 @ 0x14b109120] i16 v,h,dc,p: 30% 26% 22% 22%
[libx264 @ 0x14b109120] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x14b109120] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 39% 24% 17%  3%  4%  6%  3%  3%  1%
[libx264 @ 0x14b109120] i8c dc,h,v,p: 51% 21% 24%  3%
[libx264 @ 0x14b109120] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x14b109120] ref P L0: 71.7%  8.6% 14.5%  5.3%
[libx264 @ 0x14b109120] ref B L0: 84.9% 12.4%  2.7%
[libx264 @ 0x14b109120] ref B L1: 96.7%  3.3%
[libx264 @ 0x14b109120] kb/s:627.46
[aac @ 0x14b111050] Qavg: 3496.252

2025-02-28 10:29:29,099 - services.video_routes - INFO - [video_routes.py:654] - Wav2Lip successful with alternative parameters!
2025-02-28 10:29:29,099 - services.video_routes - INFO - [video_routes.py:657] - Output file created successfully: temp/synced_video.mp4 (size: 443376 bytes)
2025-02-28 10:29:29,099 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 113.98 seconds, success: True
2025-02-28 10:29:29,099 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 443376 bytes)
2025-02-28 10:29:29,100 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 591168 characters)
2025-02-28 10:29:29,101 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 129.33 seconds
2025-02-28 11:06:51,437 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.22MB
2025-02-28 11:06:51,438 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 0.00s
2025-02-28 11:06:51,441 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?lang=en&q=comedy&t=1737721075998
2025-02-28 11:06:51,442 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-02-28 11:06:51,443 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkl9ozw8n/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '6990764255877038994'}}}
2025-02-28 11:06:53,314 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-02-28 11:06:53,315 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkl9ozw8n/output.wav
2025-02-28 11:06:53,320 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-02-28 11:06:53,320 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-02-28 11:06:53,321 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 1.88s, Memory Change: 87.30MB
2025-02-28 11:06:53,321 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 1.88s
2025-02-28 11:06:56,404 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 11:06:56,408 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 11:07:16,309 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 11:07:16,309 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 11:07:33,529 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 11:07:33,529 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 11:07:33,532 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 45bcfbe6
2025-02-28 11:07:33,532 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-28 11:07:33,532 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-28 11:07:33,532 - services.translation_routes - INFO - [translation_routes.py:97] - Request 45bcfbe6: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpe50ijtch.wav
2025-02-28 11:07:33,533 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-02-28 11:07:33,533 - services.translation_routes - INFO - [translation_routes.py:112] - Request 45bcfbe6: Beginning audio processing with diagnostics
2025-02-28 11:07:33,533 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpe50ijtch.wav
2025-02-28 11:07:33,533 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 11:07:33,534 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-28 11:07:33,540 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-28 11:07:33,545 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-28 11:07:33,545 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-28 11:07:33,556 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-28 11:07:33,571 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,574 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,579 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,579 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,590 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,590 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,739 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 45bcfbe6
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-28 11:07:33,739 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-02-28 11:07:33,739 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpe50ijtch.wav
2025-02-28 11:07:33,739 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 11:07:33,740 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-02-28 11:07:33,745 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-02-28 11:07:33,748 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-28 11:07:33,748 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-02-28 11:07:33,757 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-02-28 11:07:33,767 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,767 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,771 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,771 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,775 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,776 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,780 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:33,780 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:33,927 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-28 11:07:33,927 - services.translation_routes - INFO - [translation_routes.py:153] - Request 45bcfbe6: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-02-28 11:07:33,927 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.15608341036219223)
2025-02-28 11:07:33,927 - services.translation_routes - INFO - [translation_routes.py:165] - Request 45bcfbe6: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.15608341036219223}}}
2025-02-28 11:07:33,928 - services.translation_routes - INFO - [translation_routes.py:167] - Request 45bcfbe6: Audio processed successfully
2025-02-28 11:07:33,934 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-02-28 11:07:39,493 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-02-28 11:07:46,369 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-02-28 11:07:53,996 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-02-28 11:07:54,006 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:54,006 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:54,011 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:54,011 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:54,015 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:54,016 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:54,019 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-02-28 11:07:54,019 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-02-28 11:07:54,144 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 45bcfbe6
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.492
- Avg Amplitude: 0.051
- Rms Level: 0.083
- Crest Factor: 5.901
- Zero Crossings: 13509.000
- Silence Percentage: 12.754
- Clipping Points: 0.000
- Dynamic Range: 206.157

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.262
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.023
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.224
  - Volume Range: 181.221
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0282525947262173
- Background Noise: 3.3605953147310896
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7069417238235474, 'stability': 3.2708752155303955, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.12426472455263138, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.538
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-02-28 11:07:54,145 - services.translation_routes - INFO - [translation_routes.py:307] - Request 45bcfbe6: Audio output processed successfully
2025-02-28 11:07:54,148 - services.translation_routes - INFO - [translation_routes.py:362] - Request 45bcfbe6: Response prepared successfully
2025-02-28 11:07:54,148 - services.translation_routes - INFO - [translation_routes.py:375] - Request 45bcfbe6 completed in 20.62s
2025-02-28 11:07:54,148 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 20.62s, Memory Change: 372.17MB
2025-02-28 11:07:54,148 - __main__ - INFO - [app.py:279] - Request to /translate took 57.74s
2025-02-28 23:29:47,780 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-02-28 23:29:47,780 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-02-28 23:30:00,822 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-02-28 23:30:00,822 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 23:30:00,823 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 23:30:22,316 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 23:30:22,316 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 23:30:40,269 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 23:30:40,269 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 23:30:40,272 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-02-28 23:30:40,272 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 23:30:40,272 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 23:30:55,842 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 23:30:55,843 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 23:31:11,423 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 23:31:11,423 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:505] - ==================================================
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.5GB available
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:524] - Configuration:
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-02-28 23:31:11,427 - __main__ - INFO - [app.py:530] - ==================================================
2025-02-28 23:32:35,047 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-02-28 23:32:35,047 - services.video_routes - INFO - [video_routes.py:901] - Processing video: Movie on 20-02-2025 at 20.44.mov for language: fra
2025-02-28 23:32:35,047 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-02-28 23:32:35,047 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-02-28 23:32:35,047 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-02-28 23:32:35,047 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-02-28 23:32:35,048 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-02-28 23:32:55,917 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-02-28 23:32:55,917 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-02-28 23:33:13,667 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-02-28 23:33:13,667 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-02-28 23:33:13,670 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-02-28 23:33:13,671 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-02-28 23:33:13,672 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-02-28 23:33:13,672 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-02-28 23:33:13,672 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 38.63s, Memory Change: 32.97MB
2025-02-28 23:33:13,672 - __main__ - INFO - [app.py:279] - Request to /process-video took 38.63s
2025-02-28 23:33:13,673 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: fra
2025-02-28 23:33:13,673 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: Movie on 20-02-2025 at 20.44.mov, content type: video/quicktime
2025-02-28 23:33:13,682 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-02-28 23:33:13,683 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4
2025-02-28 23:33:13,683 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-02-28 23:33:15,646 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-02-28 23:33:15,647 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-02-28 23:33:15,648 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-02-28 23:33:15,649 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-02-28 23:33:15,649 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-02-28 23:33:15,650 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-02-28 23:33:15,653 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-02-28 23:33:15,667 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language fra
2025-02-28 23:33:15,687 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in fra
2025-02-28 23:33:24,092 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-02-28 23:33:24,093 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language fra
2025-02-28 23:33:30,307 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 6.21 seconds
2025-02-28 23:33:30,308 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 81280])
2025-02-28 23:33:30,308 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 14.64 seconds
2025-02-28 23:33:30,308 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 81280]) to temp/translated_audio.wav
2025-02-28 23:33:30,309 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 162604 bytes)
2025-02-28 23:33:30,309 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4
2025-02-28 23:33:33,745 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-02-28 23:33:33,747 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 3.44 seconds, result: True
2025-02-28 23:33:33,747 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-02-28 23:33:33,747 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4 + temp/translated_audio.wav
2025-02-28 23:33:34,032 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 1.5
2025-02-28 23:33:35,411 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: usage: inference.py [-h] --checkpoint_path CHECKPOINT_PATH --face FACE --audio
                    AUDIO [--outfile OUTFILE] [--static STATIC] [--fps FPS]
                    [--pads PADS [PADS ...]]
                    [--face_det_batch_size FACE_DET_BATCH_SIZE]
                    [--wav2lip_batch_size WAV2LIP_BATCH_SIZE]
                    [--resize_factor RESIZE_FACTOR] [--crop CROP [CROP ...]]
                    [--box BOX [BOX ...]] [--rotate] [--nosmooth]
inference.py: error: argument --resize_factor: invalid int value: '1.5'

2025-02-28 23:33:35,411 - services.video_routes - ERROR - [video_routes.py:588] - Wav2Lip process failed with return code 2
2025-02-28 23:33:35,412 - services.video_routes - INFO - [video_routes.py:628] - Trying with different padding values...
2025-02-28 23:33:35,412 - services.video_routes - INFO - [video_routes.py:638] - Running Wav2Lip with alternative parameters: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpcgjoo65j.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 10 10 10 10 --resize_factor 2
2025-02-28 23:35:37,816 - services.video_routes - INFO - [video_routes.py:649] - Alt parameters stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 407)
Length of mel chunks: 149
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-02-28 23:35:37,817 - services.video_routes - ERROR - [video_routes.py:651] - Alt parameters stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/10 [00:00<?, ?it/s][A

 10%|█         | 1/10 [00:12<01:54, 12.70s/it][A

 20%|██        | 2/10 [00:25<01:41, 12.74s/it][A

 30%|███       | 3/10 [00:37<01:27, 12.54s/it][A

 40%|████      | 4/10 [00:50<01:14, 12.46s/it][A

 50%|█████     | 5/10 [01:02<01:02, 12.44s/it][A

 60%|██████    | 6/10 [01:14<00:49, 12.34s/it][A

 70%|███████   | 7/10 [01:26<00:36, 12.33s/it][A

 80%|████████  | 8/10 [01:39<00:24, 12.29s/it][A

 90%|█████████ | 9/10 [01:51<00:12, 12.30s/it][A

100%|██████████| 10/10 [01:54<00:00,  9.52s/it][A
100%|██████████| 10/10 [01:54<00:00, 11.48s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [01:58<01:58, 118.50s/it]
100%|██████████| 2/2 [01:59<00:00, 49.22s/it] 
100%|██████████| 2/2 [01:59<00:00, 59.62s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x135a10eb0] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:05.08, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:04.97, start: 0.000000, bitrate: 1577 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1573 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x134e07e60] -qscale is ignored, -crf is recommended.
[libx264 @ 0x134e07e60] using SAR=1/1
[libx264 @ 0x134e07e60] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x134e07e60] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x134e07e60] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x134e06d50] video:381KiB audio:48KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.951279%
frame=  149 fps=0.0 q=-1.0 Lsize=     433KiB time=00:00:04.90 bitrate= 723.9kbits/s speed=18.2x    
[libx264 @ 0x134e07e60] frame I:1     Avg QP:21.51  size: 21612
[libx264 @ 0x134e07e60] frame P:67    Avg QP:22.42  size:  4539
[libx264 @ 0x134e07e60] frame B:81    Avg QP:24.98  size:   788
[libx264 @ 0x134e07e60] consecutive B-frames: 18.8% 25.5%  2.0% 53.7%
[libx264 @ 0x134e07e60] mb I  I16..4: 17.0% 81.4%  1.6%
[libx264 @ 0x134e07e60] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 42.0%  8.2%  4.6%  0.0%  0.0%    skip:39.2%
[libx264 @ 0x134e07e60] mb B  I16..4:  0.3%  1.1%  0.0%  B16..8: 26.3%  0.8%  0.1%  direct: 0.2%  skip:71.2%  L0:43.3% L1:55.4% BI: 1.3%
[libx264 @ 0x134e07e60] 8x8 transform intra:76.1% inter:83.4%
[libx264 @ 0x134e07e60] coded y,uvDC,uvAC intra: 43.4% 57.4% 5.4% inter: 7.3% 12.7% 0.1%
[libx264 @ 0x134e07e60] i16 v,h,dc,p: 30% 26% 22% 22%
[libx264 @ 0x134e07e60] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x134e07e60] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 39% 24% 17%  3%  4%  6%  3%  3%  1%
[libx264 @ 0x134e07e60] i8c dc,h,v,p: 51% 21% 24%  3%
[libx264 @ 0x134e07e60] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x134e07e60] ref P L0: 71.7%  8.6% 14.5%  5.3%
[libx264 @ 0x134e07e60] ref B L0: 84.9% 12.4%  2.7%
[libx264 @ 0x134e07e60] ref B L1: 96.7%  3.3%
[libx264 @ 0x134e07e60] kb/s:627.46
[aac @ 0x135a19000] Qavg: 3496.252

2025-02-28 23:35:37,818 - services.video_routes - INFO - [video_routes.py:654] - Wav2Lip successful with alternative parameters!
2025-02-28 23:35:37,818 - services.video_routes - INFO - [video_routes.py:657] - Output file created successfully: temp/synced_video.mp4 (size: 443376 bytes)
2025-02-28 23:35:37,818 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 124.07 seconds, success: True
2025-02-28 23:35:37,818 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 443376 bytes)
2025-02-28 23:35:37,819 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 591168 characters)
2025-02-28 23:35:37,820 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 144.15 seconds
2025-03-01 00:23:07,520 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 00:23:07,522 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 00:23:25,670 - __main__ - INFO - [app.py:279] - Request to /translate took 0.00s
2025-03-01 00:23:25,679 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 00:23:25,680 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 00:23:29,433 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 00:23:29,433 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 00:23:54,292 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 00:23:54,292 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 00:23:58,953 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 00:23:58,953 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 00:23:58,961 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request fa51c8f0
2025-03-01 00:23:58,961 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 00:23:58,961 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 00:23:58,964 - services.translation_routes - INFO - [translation_routes.py:97] - Request fa51c8f0: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmt7gohpb.wav
2025-03-01 00:23:58,965 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 14.07 seconds
2025-03-01 00:23:58,965 - services.translation_routes - INFO - [translation_routes.py:112] - Request fa51c8f0: Beginning audio processing with diagnostics
2025-03-01 00:23:58,965 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmt7gohpb.wav
2025-03-01 00:23:58,966 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 24000, Channels: 1
2025-03-01 00:23:58,968 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 337726]), Frequency: 24000Hz
2025-03-01 00:23:58,969 - services.audio_processor - INFO - [audio_processor.py:295] - Resampling from 24000Hz to 16000Hz
2025-03-01 00:23:59,033 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:23:59,044 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:23:59,044 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:23:59,089 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:23:59,125 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,126 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,143 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,144 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,154 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,154 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,167 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,167 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,645 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: fa51c8f0
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.857
- Avg Amplitude: 0.021
- Rms Level: 0.045
- Crest Factor: 19.078
- Zero Crossings: 71644.000
- Silence Percentage: 42.885
- Clipping Points: 0.000
- Dynamic Range: 5268664.323

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.063
  - Temporal Flatness: 0.022

- Volume Metrics:
  - Volume Stability: -0.148
  - Volume Range: 21939340.234
  - Volume Variations: 0.034

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.004707959398745
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8170238733291626, 'stability': 1.7942428588867188, 'peak_frequencies': [230.46875]}
  - Quality Assessment: {'authenticity': 0.21528562903404236, 'consistency': 0.5572667121887207, 'distinction': 0.022590521723031998}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.651
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.612
  - Rhythm Quality: 0.646
  - Intonation Quality: 0.578

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:23:59,646 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-01 00:23:59,646 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpmt7gohpb.wav
2025-03-01 00:23:59,647 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 24000, Channels: 1
2025-03-01 00:23:59,649 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 337726]), Frequency: 24000Hz
2025-03-01 00:23:59,649 - services.audio_processor - INFO - [audio_processor.py:295] - Resampling from 24000Hz to 16000Hz
2025-03-01 00:23:59,699 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:23:59,703 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:23:59,703 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:23:59,736 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:23:59,771 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,772 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,791 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,791 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,810 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,810 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:23:59,827 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:23:59,827 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:00,339 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:24:00,340 - services.translation_routes - INFO - [translation_routes.py:153] - Request fa51c8f0: Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:24:00,340 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.30090368289968344)
2025-03-01 00:24:00,340 - services.translation_routes - INFO - [translation_routes.py:165] - Request fa51c8f0: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.30090368289968344}}}
2025-03-01 00:24:00,340 - services.translation_routes - INFO - [translation_routes.py:167] - Request fa51c8f0: Audio processed successfully
2025-03-01 00:24:00,360 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-01 00:24:17,085 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: some call me nature others call me mother nature i've been here for over four point five billion years twenty two thousand five hundred times longer than you
2025-03-01 00:24:21,986 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 00:24:21,986 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 00:24:21,988 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request c7c9a5cf
2025-03-01 00:24:21,988 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 00:24:21,988 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 00:24:21,992 - services.translation_routes - INFO - [translation_routes.py:97] - Request c7c9a5cf: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmprp6xq0sq.wav
2025-03-01 00:24:21,992 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 14.07 seconds
2025-03-01 00:24:21,992 - services.translation_routes - INFO - [translation_routes.py:112] - Request c7c9a5cf: Beginning audio processing with diagnostics
2025-03-01 00:24:21,992 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmprp6xq0sq.wav
2025-03-01 00:24:21,992 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 24000, Channels: 1
2025-03-01 00:24:21,995 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 337726]), Frequency: 24000Hz
2025-03-01 00:24:21,995 - services.audio_processor - INFO - [audio_processor.py:295] - Resampling from 24000Hz to 16000Hz
2025-03-01 00:24:22,055 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:24:22,066 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:24:22,066 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:24:22,093 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:24:22,121 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,121 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,129 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,130 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,141 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,142 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,155 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,155 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,647 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: c7c9a5cf
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.857
- Avg Amplitude: 0.021
- Rms Level: 0.045
- Crest Factor: 19.078
- Zero Crossings: 71644.000
- Silence Percentage: 42.885
- Clipping Points: 0.000
- Dynamic Range: 5268664.323

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.063
  - Temporal Flatness: 0.022

- Volume Metrics:
  - Volume Stability: -0.148
  - Volume Range: 21939340.234
  - Volume Variations: 0.034

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.004707959398745
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8170238733291626, 'stability': 1.7942428588867188, 'peak_frequencies': [230.46875]}
  - Quality Assessment: {'authenticity': 0.21528562903404236, 'consistency': 0.5572667121887207, 'distinction': 0.022590521723031998}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.651
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.612
  - Rhythm Quality: 0.646
  - Intonation Quality: 0.578

Vowel Quality:
  - Quality Score: 0.010
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:24:22,647 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-01 00:24:22,648 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmprp6xq0sq.wav
2025-03-01 00:24:22,648 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 24000, Channels: 1
2025-03-01 00:24:22,649 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 337726]), Frequency: 24000Hz
2025-03-01 00:24:22,649 - services.audio_processor - INFO - [audio_processor.py:295] - Resampling from 24000Hz to 16000Hz
2025-03-01 00:24:22,699 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:24:22,710 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:24:22,710 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:24:22,739 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:24:22,778 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,779 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,791 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,791 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,804 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,804 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:22,819 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:24:22,819 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:24:23,308 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:24:23,309 - services.translation_routes - INFO - [translation_routes.py:153] - Request c7c9a5cf: Background music analysis: {'has_background_music': True, 'music_confidence': 0.30090368289968344, 'feature_scores': {'spectral_flatness': 0.12600845940715738, 'rhythm_regularity': 0.024770642201834864, 'bass_presence': 0.09985111876545806, 'temporal_stability': 0.05027346252523314}, 'speech_vs_music': {'speech_prominence': 3.000345724219113, 'speech_band_energy': 2.911005481109896e-07, 'music_band_energy': 9.692233504665637e-08}}
2025-03-01 00:24:23,309 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.30090368289968344)
2025-03-01 00:24:23,309 - services.translation_routes - INFO - [translation_routes.py:165] - Request c7c9a5cf: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.30090368289968344}}}
2025-03-01 00:24:23,309 - services.translation_routes - INFO - [translation_routes.py:167] - Request c7c9a5cf: Audio processed successfully
2025-03-01 00:24:23,351 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-01 00:24:36,930 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: certains m'appellent nature d'autres m'appelent mère nature j'ai été ici pour plus de quatre point cinq milliards d'années vingt-deux mille cinq cents fois plus longtemps que vous
2025-03-01 00:24:38,268 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: some call me nature others call me mother nature i've been here for over four point five billion years twenty two thousand five hundred times longer than you
2025-03-01 00:24:57,597 - services.translation_routes - ERROR - [translation_routes.py:282] - Translation error: index out of range in self
2025-03-01 00:24:57,619 - services.translation_routes - INFO - [translation_routes.py:375] - Request fa51c8f0 completed in 58.66s
2025-03-01 00:24:57,619 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 58.66s, Memory Change: 1056.48MB
2025-03-01 00:24:57,619 - __main__ - INFO - [app.py:279] - Request to /translate took 110.10s
2025-03-01 00:24:57,955 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: certains m'appellent nature d'autres m'appelent mère nature j'ai été ici pour plus de quatre point cinq milliards d'années vingt-deux mille cinq cents fois plus longtemps que vous
2025-03-01 00:25:10,739 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-03-01 00:25:10,754 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:25:10,755 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:25:10,764 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:25:10,764 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:25:10,769 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:25:10,769 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:25:10,777 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:25:10,777 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:25:10,985 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: c7c9a5cf
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.683
- Avg Amplitude: 0.062
- Rms Level: 0.095
- Crest Factor: 7.169
- Zero Crossings: 17484.000
- Silence Percentage: 7.838
- Clipping Points: 0.000
- Dynamic Range: 116.768

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.104
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.025
  - Temporal Flatness: 0.014

- Volume Metrics:
  - Volume Stability: 0.319
  - Volume Range: 130.034
  - Volume Variations: 0.054

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.026560776499065
- Background Noise: 3.867701265960556
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.8741398453712463, 'stability': 3.5264785289764404, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.10592163354158401, 'consistency': 0.0, 'distinction': 0.14608575403690338}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.505
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-03-01 00:25:10,985 - services.translation_routes - INFO - [translation_routes.py:307] - Request c7c9a5cf: Audio output processed successfully
2025-03-01 00:25:10,988 - services.translation_routes - INFO - [translation_routes.py:362] - Request c7c9a5cf: Response prepared successfully
2025-03-01 00:25:10,988 - services.translation_routes - INFO - [translation_routes.py:375] - Request c7c9a5cf completed in 49.00s
2025-03-01 00:25:10,990 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 49.00s, Memory Change: 684.91MB
2025-03-01 00:25:10,990 - __main__ - INFO - [app.py:279] - Request to /translate took 105.31s
2025-03-01 00:29:48,975 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.00MB
2025-03-01 00:29:48,976 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 0.00s
2025-03-01 00:29:48,978 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.tiktok.com/@fightjoe/video/7127311328095522053?lang=en&q=comedy&t=1737721075998
2025-03-01 00:29:48,978 - services.audio_link_routes - INFO - [audio_link_routes.py:246] - Processing TikTok URL
2025-03-01 00:29:48,979 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for tiktok: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpm91a_kv5/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True, 'extractor_args': {'tiktok': {'api_hostname': 'api22-normal-c-alisg.tiktokv.com', 'app_name': 'trill', 'app_version': '34.1.2', 'manifest_app_version': '2023401020', 'app_info': '1234567890123456789/trill///1180', 'device_id': '2666449591343112283'}}}
2025-03-01 00:29:51,857 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded tiktok content
2025-03-01 00:29:51,858 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpm91a_kv5/output.wav
2025-03-01 00:29:51,863 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-03-01 00:29:51,863 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-03-01 00:29:51,863 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 2.89s, Memory Change: 123.66MB
2025-03-01 00:29:51,863 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 2.89s
2025-03-01 00:29:55,029 - __main__ - INFO - [app.py:279] - Request to /translate took 0.00s
2025-03-01 00:29:55,033 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 00:29:55,034 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 00:30:14,149 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 00:30:14,150 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 00:30:30,987 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 00:30:30,988 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 00:30:30,992 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request d1d1f03c
2025-03-01 00:30:30,992 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 00:30:30,992 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 00:30:30,992 - services.translation_routes - INFO - [translation_routes.py:97] - Request d1d1f03c: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdsmbmj0n.wav
2025-03-01 00:30:30,992 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 6.57 seconds
2025-03-01 00:30:30,993 - services.translation_routes - INFO - [translation_routes.py:112] - Request d1d1f03c: Beginning audio processing with diagnostics
2025-03-01 00:30:30,993 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdsmbmj0n.wav
2025-03-01 00:30:30,993 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 00:30:30,993 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-03-01 00:30:30,998 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:30:31,001 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-03-01 00:30:31,001 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:30:31,010 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:30:31,020 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,020 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,024 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,024 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,028 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,028 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,032 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,032 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,180 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: d1d1f03c
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.076
- Crest Factor: 12.530
- Zero Crossings: 29106.000
- Silence Percentage: 62.741
- Clipping Points: 0.000
- Dynamic Range: 6753166.765

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.082
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.671
  - Volume Range: 28777495.027
  - Volume Variations: 0.065

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.012101101788277
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0195544958114624, 'stability': 3.234647035598755, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.004738867282867432, 'distinction': 0.9893258810043335}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.653
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.045
  - Rhythm Quality: 0.090
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.007
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:30:31,180 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-01 00:30:31,181 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpdsmbmj0n.wav
2025-03-01 00:30:31,181 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 00:30:31,181 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 105163]), Frequency: 16000Hz
2025-03-01 00:30:31,185 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:30:31,188 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-03-01 00:30:31,188 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:30:31,196 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:30:31,207 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,207 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,210 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,211 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,215 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,215 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,219 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:30:31,219 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:30:31,367 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:30:31,367 - services.translation_routes - INFO - [translation_routes.py:153] - Request d1d1f03c: Background music analysis: {'has_background_music': False, 'music_confidence': 0.15608341036219223, 'feature_scores': {'spectral_flatness': 0.03820588165673722, 'rhythm_regularity': 0.023762376237623763, 'bass_presence': 0.039862824445829455, 'temporal_stability': 0.054252328022001785}, 'speech_vs_music': {'speech_prominence': 7.497730333222908, 'speech_band_energy': 2.2766175789001863e-07, 'music_band_energy': 3.0264089900811086e-08}}
2025-03-01 00:30:31,367 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.15608341036219223)
2025-03-01 00:30:31,367 - services.translation_routes - INFO - [translation_routes.py:165] - Request d1d1f03c: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.15608341036219223}}}
2025-03-01 00:30:31,367 - services.translation_routes - INFO - [translation_routes.py:167] - Request d1d1f03c: Audio processed successfully
2025-03-01 00:30:31,373 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-01 00:30:36,563 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: if you wouldn't fight what do you think it would be I would definitely be a diabetic
2025-03-01 00:30:43,502 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Si tu ne faisais pas ça, ce que tu penses que tu pourrais faire, je serais définitivement diabétique.
2025-03-01 00:31:17,053 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-03-01 00:31:17,196 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:31:17,197 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:31:17,217 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:31:17,218 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:31:17,245 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:31:17,250 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:31:17,301 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:31:17,304 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:31:17,922 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: d1d1f03c
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.463
- Avg Amplitude: 0.049
- Rms Level: 0.082
- Crest Factor: 5.679
- Zero Crossings: 12738.000
- Silence Percentage: 12.861
- Clipping Points: 0.000
- Dynamic Range: 212.868

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.290
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.021
  - Temporal Flatness: 0.012

- Volume Metrics:
  - Volume Stability: 0.204
  - Volume Range: 254.904
  - Volume Variations: 0.051

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0287172255175485
- Background Noise: 3.2716983759322966
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7183030843734741, 'stability': 3.251460075378418, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.12484455108642578, 'consistency': 0.0, 'distinction': 1.0}
  - Description: Strong nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.519
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-03-01 00:31:17,923 - services.translation_routes - INFO - [translation_routes.py:307] - Request d1d1f03c: Audio output processed successfully
2025-03-01 00:31:17,926 - services.translation_routes - INFO - [translation_routes.py:362] - Request d1d1f03c: Response prepared successfully
2025-03-01 00:31:17,926 - services.translation_routes - INFO - [translation_routes.py:375] - Request d1d1f03c completed in 46.93s
2025-03-01 00:31:17,926 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 46.93s, Memory Change: -184.02MB
2025-03-01 00:31:17,927 - __main__ - INFO - [app.py:279] - Request to /translate took 82.89s
2025-03-01 00:38:25,792 - __main__ - INFO - [app.py:279] - Request to /translate took 0.00s
2025-03-01 00:38:25,801 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 00:38:25,803 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 00:38:52,630 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 00:38:52,630 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 00:39:10,476 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 00:39:10,476 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 00:39:10,480 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 14f02cdb
2025-03-01 00:39:10,480 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 00:39:10,480 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 00:39:10,481 - services.translation_routes - INFO - [translation_routes.py:97] - Request 14f02cdb: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp2mshg1ba.wav
2025-03-01 00:39:10,481 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 12.42 seconds
2025-03-01 00:39:10,481 - services.translation_routes - INFO - [translation_routes.py:112] - Request 14f02cdb: Beginning audio processing with diagnostics
2025-03-01 00:39:10,481 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp2mshg1ba.wav
2025-03-01 00:39:10,481 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 00:39:10,482 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 198720]), Frequency: 16000Hz
2025-03-01 00:39:10,489 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:39:10,495 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.18008755383104388, 'feature_scores': {'spectral_flatness': 0.08629004359708954, 'rhythm_regularity': 0.0077720207253886, 'bass_presence': 0.05178997184283635, 'temporal_stability': 0.034235517665729374}, 'speech_vs_music': {'speech_prominence': 5.700518743049041, 'speech_band_energy': 4.203902292942985e-08, 'music_band_energy': 7.274596036666026e-09}}
2025-03-01 00:39:10,495 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:39:10,508 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:39:10,523 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,523 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,529 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,530 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,537 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,537 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,545 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,546 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,648 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 14f02cdb
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.800
- Avg Amplitude: 0.005
- Rms Level: 0.031
- Crest Factor: 25.616
- Zero Crossings: 17960.000
- Silence Percentage: 92.179
- Clipping Points: 0.000
- Dynamic Range: 0.005

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 1.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 1.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.040
  - Temporal Flatness: 0.006

- Volume Metrics:
  - Volume Stability: -2.761
  - Volume Range: 20229537.785
  - Volume Variations: 0.030

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0024394528156853
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.2549993097782135, 'stability': 1.3261313438415527, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.6581804156303406, 'consistency': 0.23076701164245605, 'distinction': 1.0}
  - Description: Weak nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: True
  - Confidence: 0.718
  - Description: Clear liaison patterns detected

Prosody:
  - Score: 0.190
  - Rhythm Quality: 0.380
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.003
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:39:10,648 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-01 00:39:10,648 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp2mshg1ba.wav
2025-03-01 00:39:10,648 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 00:39:10,649 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 198720]), Frequency: 16000Hz
2025-03-01 00:39:10,656 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-01 00:39:10,661 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.18008755383104388, 'feature_scores': {'spectral_flatness': 0.08629004359708954, 'rhythm_regularity': 0.0077720207253886, 'bass_presence': 0.05178997184283635, 'temporal_stability': 0.034235517665729374}, 'speech_vs_music': {'speech_prominence': 5.700518743049041, 'speech_band_energy': 4.203902292942985e-08, 'music_band_energy': 7.274596036666026e-09}}
2025-03-01 00:39:10,661 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-01 00:39:10,681 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-01 00:39:10,696 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,696 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,704 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,704 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,711 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,711 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,717 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:10,718 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:10,820 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:39:10,820 - services.translation_routes - INFO - [translation_routes.py:153] - Request 14f02cdb: Background music analysis: {'has_background_music': False, 'music_confidence': 0.18008755383104388, 'feature_scores': {'spectral_flatness': 0.08629004359708954, 'rhythm_regularity': 0.0077720207253886, 'bass_presence': 0.05178997184283635, 'temporal_stability': 0.034235517665729374}, 'speech_vs_music': {'speech_prominence': 5.700518743049041, 'speech_band_energy': 4.203902292942985e-08, 'music_band_energy': 7.274596036666026e-09}}
2025-03-01 00:39:10,820 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.18008755383104388)
2025-03-01 00:39:10,820 - services.translation_routes - INFO - [translation_routes.py:165] - Request 14f02cdb: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.18008755383104388}}}
2025-03-01 00:39:10,820 - services.translation_routes - INFO - [translation_routes.py:167] - Request 14f02cdb: Audio processed successfully
2025-03-01 00:39:10,841 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-01 00:39:14,737 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: let's do a test
2025-03-01 00:39:18,381 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Faisons un test.
2025-03-01 00:39:23,576 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-03-01 00:39:23,580 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:23,580 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:23,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:23,583 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:23,586 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:23,586 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:23,588 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-01 00:39:23,588 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-01 00:39:23,619 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 14f02cdb
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.545
- Avg Amplitude: 0.046
- Rms Level: 0.095
- Crest Factor: 5.716
- Zero Crossings: 2826.000
- Silence Percentage: 44.673
- Clipping Points: 0.000
- Dynamic Range: 2028.849

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.286
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.026
  - Temporal Flatness: 0.012

- Volume Metrics:
  - Volume Stability: -0.185
  - Volume Range: 1562.344
  - Volume Variations: 0.075

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.03333831695135
- Background Noise: 3.286361572272008
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': nan, 'stability': nan, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 1.0, 'distinction': 1.0}
  - Description: Weak nasal resonance. Unstable nasal resonance. Clear distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.631
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 1.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-03-01 00:39:23,619 - services.translation_routes - INFO - [translation_routes.py:307] - Request 14f02cdb: Audio output processed successfully
2025-03-01 00:39:23,620 - services.translation_routes - INFO - [translation_routes.py:362] - Request 14f02cdb: Response prepared successfully
2025-03-01 00:39:23,620 - services.translation_routes - INFO - [translation_routes.py:375] - Request 14f02cdb completed in 13.14s
2025-03-01 00:39:23,621 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 13.14s, Memory Change: 266.75MB
2025-03-01 00:39:23,621 - __main__ - INFO - [app.py:279] - Request to /translate took 57.82s
2025-03-01 00:43:42,531 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-03-01 00:43:42,533 - services.video_routes - ERROR - [video_routes.py:893] - No video file provided in request
2025-03-01 00:43:42,533 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 0.00s, Memory Change: 0.25MB
2025-03-01 00:43:42,533 - __main__ - INFO - [app.py:279] - Request to /process-video took 0.00s
2025-03-01 00:43:42,577 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-03-01 00:43:42,577 - services.video_routes - INFO - [video_routes.py:901] - Processing video: Movie on 20-02-2025 at 20.44.mov for language: fra
2025-03-01 00:43:42,577 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-01 00:43:42,577 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 00:43:42,577 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 00:43:42,577 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 00:43:42,578 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 00:43:58,774 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 00:43:58,775 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 00:44:15,295 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 00:44:15,296 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-01 00:44:15,298 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-01 00:44:15,299 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-01 00:44:15,299 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-01 00:44:15,299 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 32.72s, Memory Change: 387.53MB
2025-03-01 00:44:15,299 - __main__ - INFO - [app.py:279] - Request to /process-video took 32.72s
2025-03-01 00:44:15,300 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: fra
2025-03-01 00:44:15,300 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: Movie on 20-02-2025 at 20.44.mov, content type: video/quicktime
2025-03-01 00:44:15,309 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-01 00:44:15,309 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4
2025-03-01 00:44:15,309 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-01 00:44:15,534 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-01 00:44:15,534 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-01 00:44:15,535 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-01 00:44:15,536 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-01 00:44:15,536 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-01 00:44:15,536 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 00:44:15,537 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-01 00:44:15,548 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language fra
2025-03-01 00:44:15,561 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in fra
2025-03-01 00:44:23,123 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-03-01 00:44:23,124 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language fra
2025-03-01 00:44:28,461 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.34 seconds
2025-03-01 00:44:28,463 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 81280])
2025-03-01 00:44:28,463 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 12.92 seconds
2025-03-01 00:44:28,463 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 81280]) to temp/translated_audio.wav
2025-03-01 00:44:28,464 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 162604 bytes)
2025-03-01 00:44:28,464 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4
2025-03-01 00:44:31,489 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-03-01 00:44:31,491 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 3.03 seconds, result: True
2025-03-01 00:44:31,491 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-03-01 00:44:31,491 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4 + temp/translated_audio.wav
2025-03-01 00:44:31,492 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 1.5
2025-03-01 00:44:33,093 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: usage: inference.py [-h] --checkpoint_path CHECKPOINT_PATH --face FACE --audio
                    AUDIO [--outfile OUTFILE] [--static STATIC] [--fps FPS]
                    [--pads PADS [PADS ...]]
                    [--face_det_batch_size FACE_DET_BATCH_SIZE]
                    [--wav2lip_batch_size WAV2LIP_BATCH_SIZE]
                    [--resize_factor RESIZE_FACTOR] [--crop CROP [CROP ...]]
                    [--box BOX [BOX ...]] [--rotate] [--nosmooth]
inference.py: error: argument --resize_factor: invalid int value: '1.5'

2025-03-01 00:44:33,094 - services.video_routes - ERROR - [video_routes.py:588] - Wav2Lip process failed with return code 2
2025-03-01 00:44:33,094 - services.video_routes - INFO - [video_routes.py:628] - Trying with different padding values...
2025-03-01 00:44:33,094 - services.video_routes - INFO - [video_routes.py:638] - Running Wav2Lip with alternative parameters: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpchlbhqv5.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 10 10 10 10 --resize_factor 2
2025-03-01 00:46:26,472 - services.video_routes - INFO - [video_routes.py:649] - Alt parameters stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 407)
Length of mel chunks: 149
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-03-01 00:46:26,474 - services.video_routes - ERROR - [video_routes.py:651] - Alt parameters stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/10 [00:00<?, ?it/s][A

 10%|█         | 1/10 [00:11<01:46, 11.79s/it][A

 20%|██        | 2/10 [00:23<01:33, 11.74s/it][A

 30%|███       | 3/10 [00:34<01:21, 11.60s/it][A

 40%|████      | 4/10 [00:46<01:09, 11.53s/it][A

 50%|█████     | 5/10 [00:57<00:57, 11.45s/it][A

 60%|██████    | 6/10 [01:09<00:45, 11.42s/it][A

 70%|███████   | 7/10 [01:20<00:34, 11.39s/it][A

 80%|████████  | 8/10 [01:31<00:22, 11.36s/it][A

 90%|█████████ | 9/10 [01:43<00:11, 11.37s/it][A

100%|██████████| 10/10 [01:46<00:00,  8.89s/it][A
100%|██████████| 10/10 [01:46<00:00, 10.64s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [01:49<01:49, 109.78s/it]
100%|██████████| 2/2 [01:50<00:00, 45.60s/it] 
100%|██████████| 2/2 [01:50<00:00, 55.22s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x15b805270] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:05.08, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:04.97, start: 0.000000, bitrate: 1577 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1573 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x15b809730] -qscale is ignored, -crf is recommended.
[libx264 @ 0x15b809730] using SAR=1/1
[libx264 @ 0x15b809730] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x15b809730] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x15b809730] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x15b807140] video:381KiB audio:48KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.951279%
frame=  149 fps=0.0 q=-1.0 Lsize=     433KiB time=00:00:04.90 bitrate= 723.9kbits/s speed=19.3x    
[libx264 @ 0x15b809730] frame I:1     Avg QP:21.51  size: 21612
[libx264 @ 0x15b809730] frame P:67    Avg QP:22.42  size:  4539
[libx264 @ 0x15b809730] frame B:81    Avg QP:24.98  size:   788
[libx264 @ 0x15b809730] consecutive B-frames: 18.8% 25.5%  2.0% 53.7%
[libx264 @ 0x15b809730] mb I  I16..4: 17.0% 81.4%  1.6%
[libx264 @ 0x15b809730] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 42.0%  8.2%  4.6%  0.0%  0.0%    skip:39.2%
[libx264 @ 0x15b809730] mb B  I16..4:  0.3%  1.1%  0.0%  B16..8: 26.3%  0.8%  0.1%  direct: 0.2%  skip:71.2%  L0:43.3% L1:55.4% BI: 1.3%
[libx264 @ 0x15b809730] 8x8 transform intra:76.1% inter:83.4%
[libx264 @ 0x15b809730] coded y,uvDC,uvAC intra: 43.4% 57.4% 5.4% inter: 7.3% 12.7% 0.1%
[libx264 @ 0x15b809730] i16 v,h,dc,p: 30% 26% 22% 22%
[libx264 @ 0x15b809730] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x15b809730] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 39% 24% 17%  3%  4%  6%  3%  3%  1%
[libx264 @ 0x15b809730] i8c dc,h,v,p: 51% 21% 24%  3%
[libx264 @ 0x15b809730] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x15b809730] ref P L0: 71.7%  8.6% 14.5%  5.3%
[libx264 @ 0x15b809730] ref B L0: 84.9% 12.4%  2.7%
[libx264 @ 0x15b809730] ref B L1: 96.7%  3.3%
[libx264 @ 0x15b809730] kb/s:627.46
[aac @ 0x15ae0df90] Qavg: 3496.252

2025-03-01 00:46:26,474 - services.video_routes - INFO - [video_routes.py:654] - Wav2Lip successful with alternative parameters!
2025-03-01 00:46:26,474 - services.video_routes - INFO - [video_routes.py:657] - Output file created successfully: temp/synced_video.mp4 (size: 443376 bytes)
2025-03-01 00:46:26,475 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 114.98 seconds, success: True
2025-03-01 00:46:26,475 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 443376 bytes)
2025-03-01 00:46:26,475 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 591168 characters)
2025-03-01 00:46:26,477 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 131.18 seconds
2025-03-01 02:00:52,341 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-03-01 02:00:52,344 - services.video_routes - ERROR - [video_routes.py:893] - No video file provided in request
2025-03-01 02:00:52,345 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 0.01s, Memory Change: 2.81MB
2025-03-01 02:00:52,346 - __main__ - INFO - [app.py:279] - Request to /process-video took 0.01s
2025-03-01 02:00:52,383 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-03-01 02:00:52,383 - services.video_routes - INFO - [video_routes.py:901] - Processing video: Movie on 20-02-2025 at 20.44.mov for language: fra
2025-03-01 02:00:52,384 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-01 02:00:52,384 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-01 02:00:52,384 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-01 02:00:52,384 - services.model_manager - INFO - [model_manager.py:211] - Model inactive for too long, reloading...
2025-03-01 02:00:52,384 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-01 02:01:07,692 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-01 02:01:07,693 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 02:01:07,694 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 02:01:30,651 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 02:01:30,651 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 02:01:49,493 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 02:01:49,493 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 02:01:49,497 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-01 02:01:49,497 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-01 02:01:49,497 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-01 02:02:04,241 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-01 02:02:04,241 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-01 02:02:25,636 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-01 02:02:25,636 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-01 02:02:25,639 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-01 02:02:25,640 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-01 02:02:25,640 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-01 02:02:25,640 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-01 02:02:25,640 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 93.26s, Memory Change: 13203.38MB
2025-03-01 02:02:25,640 - __main__ - INFO - [app.py:279] - Request to /process-video took 93.26s
2025-03-01 02:02:25,640 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: fra
2025-03-01 02:02:25,640 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: Movie on 20-02-2025 at 20.44.mov, content type: video/quicktime
2025-03-01 02:02:25,651 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-01 02:02:25,651 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4
2025-03-01 02:02:25,651 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-01 02:02:26,059 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-01 02:02:26,059 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-01 02:02:26,063 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-01 02:02:26,063 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-01 02:02:26,064 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-01 02:02:26,064 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-01 02:02:26,066 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-01 02:02:26,085 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language fra
2025-03-01 02:02:26,109 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in fra
2025-03-01 02:02:33,719 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-03-01 02:02:33,720 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language fra
2025-03-01 02:02:39,217 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.50 seconds
2025-03-01 02:02:39,217 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 81280])
2025-03-01 02:02:39,217 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 13.13 seconds
2025-03-01 02:02:39,217 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 81280]) to temp/translated_audio.wav
2025-03-01 02:02:39,218 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 162604 bytes)
2025-03-01 02:02:39,219 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4
2025-03-01 02:02:41,599 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-03-01 02:02:41,602 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 2.38 seconds, result: True
2025-03-01 02:02:41,602 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-03-01 02:02:41,602 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4 + temp/translated_audio.wav
2025-03-01 02:02:41,602 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 1.5
2025-03-01 02:02:43,214 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: usage: inference.py [-h] --checkpoint_path CHECKPOINT_PATH --face FACE --audio
                    AUDIO [--outfile OUTFILE] [--static STATIC] [--fps FPS]
                    [--pads PADS [PADS ...]]
                    [--face_det_batch_size FACE_DET_BATCH_SIZE]
                    [--wav2lip_batch_size WAV2LIP_BATCH_SIZE]
                    [--resize_factor RESIZE_FACTOR] [--crop CROP [CROP ...]]
                    [--box BOX [BOX ...]] [--rotate] [--nosmooth]
inference.py: error: argument --resize_factor: invalid int value: '1.5'

2025-03-01 02:02:43,214 - services.video_routes - ERROR - [video_routes.py:588] - Wav2Lip process failed with return code 2
2025-03-01 02:02:43,214 - services.video_routes - INFO - [video_routes.py:628] - Trying with different padding values...
2025-03-01 02:02:43,214 - services.video_routes - INFO - [video_routes.py:638] - Running Wav2Lip with alternative parameters: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpyusv8s_5.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 10 10 10 10 --resize_factor 2
2025-03-01 02:04:38,740 - services.video_routes - INFO - [video_routes.py:649] - Alt parameters stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 407)
Length of mel chunks: 149
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-03-01 02:04:38,742 - services.video_routes - ERROR - [video_routes.py:651] - Alt parameters stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/10 [00:00<?, ?it/s][A

 10%|█         | 1/10 [00:13<02:01, 13.52s/it][A

 20%|██        | 2/10 [00:25<01:39, 12.48s/it][A

 30%|███       | 3/10 [00:36<01:23, 11.89s/it][A

 40%|████      | 4/10 [00:48<01:10, 11.75s/it][A

 50%|█████     | 5/10 [01:00<00:59, 11.89s/it][A

 60%|██████    | 6/10 [01:11<00:46, 11.73s/it][A

 70%|███████   | 7/10 [01:22<00:34, 11.54s/it][A

 80%|████████  | 8/10 [01:33<00:22, 11.45s/it][A

 90%|█████████ | 9/10 [01:45<00:11, 11.35s/it][A

100%|██████████| 10/10 [01:48<00:00,  8.89s/it][A
100%|██████████| 10/10 [01:48<00:00, 10.85s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [01:51<01:51, 111.77s/it]
100%|██████████| 2/2 [01:52<00:00, 46.46s/it] 
100%|██████████| 2/2 [01:52<00:00, 56.26s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x150704e80] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:05.08, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:04.97, start: 0.000000, bitrate: 1577 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1573 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x150709340] -qscale is ignored, -crf is recommended.
[libx264 @ 0x150709340] using SAR=1/1
[libx264 @ 0x150709340] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x150709340] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x150709340] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x150705fc0] video:381KiB audio:48KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.951279%
frame=  149 fps=0.0 q=-1.0 Lsize=     433KiB time=00:00:04.90 bitrate= 723.9kbits/s speed=19.4x    
[libx264 @ 0x150709340] frame I:1     Avg QP:21.51  size: 21612
[libx264 @ 0x150709340] frame P:67    Avg QP:22.42  size:  4539
[libx264 @ 0x150709340] frame B:81    Avg QP:24.98  size:   788
[libx264 @ 0x150709340] consecutive B-frames: 18.8% 25.5%  2.0% 53.7%
[libx264 @ 0x150709340] mb I  I16..4: 17.0% 81.4%  1.6%
[libx264 @ 0x150709340] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 42.0%  8.2%  4.6%  0.0%  0.0%    skip:39.2%
[libx264 @ 0x150709340] mb B  I16..4:  0.3%  1.1%  0.0%  B16..8: 26.3%  0.8%  0.1%  direct: 0.2%  skip:71.2%  L0:43.3% L1:55.4% BI: 1.3%
[libx264 @ 0x150709340] 8x8 transform intra:76.1% inter:83.4%
[libx264 @ 0x150709340] coded y,uvDC,uvAC intra: 43.4% 57.4% 5.4% inter: 7.3% 12.7% 0.1%
[libx264 @ 0x150709340] i16 v,h,dc,p: 30% 26% 22% 22%
[libx264 @ 0x150709340] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x150709340] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 39% 24% 17%  3%  4%  6%  3%  3%  1%
[libx264 @ 0x150709340] i8c dc,h,v,p: 51% 21% 24%  3%
[libx264 @ 0x150709340] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x150709340] ref P L0: 71.7%  8.6% 14.5%  5.3%
[libx264 @ 0x150709340] ref B L0: 84.9% 12.4%  2.7%
[libx264 @ 0x150709340] ref B L1: 96.7%  3.3%
[libx264 @ 0x150709340] kb/s:627.46
[aac @ 0x15100bbb0] Qavg: 3496.252

2025-03-01 02:04:38,742 - services.video_routes - INFO - [video_routes.py:654] - Wav2Lip successful with alternative parameters!
2025-03-01 02:04:38,742 - services.video_routes - INFO - [video_routes.py:657] - Output file created successfully: temp/synced_video.mp4 (size: 443376 bytes)
2025-03-01 02:04:38,743 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 117.14 seconds, success: True
2025-03-01 02:04:38,743 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 443376 bytes)
2025-03-01 02:04:38,744 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 591168 characters)
2025-03-01 02:04:38,745 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 133.11 seconds
2025-03-02 18:45:05,728 - __main__ - ERROR - [app.py:550] - Failed to start application: [Errno 48] Address already in use
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/app.py", line 480, in <module>
    start_http_server(8000)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_client/exposition.py", line 170, in start_wsgi_server
    httpd = make_server(addr, port, app, TmpServer, handler_class=_SilentHandler)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 154, in make_server
    server = server_class((host, port), handler_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 50, in server_bind
    HTTPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/http/server.py", line 136, in server_bind
    socketserver.TCPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use
2025-03-02 18:45:05,729 - __main__ - ERROR - [app.py:552] - Stack trace:
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/app.py", line 480, in <module>
    start_http_server(8000)
  File "/opt/anaconda3/lib/python3.12/site-packages/prometheus_client/exposition.py", line 170, in start_wsgi_server
    httpd = make_server(addr, port, app, TmpServer, handler_class=_SilentHandler)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 154, in make_server
    server = server_class((host, port), handler_class)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 457, in __init__
    self.server_bind()
  File "/opt/anaconda3/lib/python3.12/wsgiref/simple_server.py", line 50, in server_bind
    HTTPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/http/server.py", line 136, in server_bind
    socketserver.TCPServer.server_bind(self)
  File "/opt/anaconda3/lib/python3.12/socketserver.py", line 473, in server_bind
    self.socket.bind(self.server_address)
OSError: [Errno 48] Address already in use
2025-03-02 18:45:05,730 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 18:45:05,739 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-03-02 18:45:05,739 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-02 18:45:18,597 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-02 18:45:18,597 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 18:45:18,597 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 18:45:42,790 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 18:45:42,791 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 18:46:02,826 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 18:46:02,826 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 18:46:02,829 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-02 18:46:02,829 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 18:46:02,945 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 18:46:02,945 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 18:46:02,945 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-03-02 18:48:16,852 - __main__ - INFO - [app.py:481] - Metrics server started on port 8000
2025-03-02 18:48:16,853 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-02 18:48:29,855 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-02 18:48:29,855 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 18:48:29,856 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 18:48:47,162 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 18:48:47,162 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 18:49:05,119 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 18:49:05,119 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 18:49:05,121 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-02 18:49:05,122 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 18:49:05,122 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 18:49:22,975 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 18:49:22,975 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 18:49:38,967 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 18:49:38,968 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 18:49:38,975 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 18:49:38,976 - __main__ - INFO - [app.py:505] - ==================================================
2025-03-02 18:49:38,976 - __main__ - INFO - [app.py:506] - Starting LinguaSync Backend
2025-03-02 18:49:38,976 - __main__ - INFO - [app.py:507] - Starting Flask app on port 5001 using cpu
2025-03-02 18:49:38,976 - __main__ - INFO - [app.py:508] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-03-02 18:49:38,976 - __main__ - INFO - [app.py:509] - Supported languages: ['fra', 'spa', 'deu', 'ita', 'por']
2025-03-02 18:49:38,977 - __main__ - INFO - [app.py:510] - Maximum audio length: 300 seconds
2025-03-02 18:49:38,977 - __main__ - INFO - [app.py:511] - Sample rate: 16000 Hz
2025-03-02 18:49:38,977 - __main__ - INFO - [app.py:515] - System memory: 36.0GB total, 15.6GB available
2025-03-02 18:49:38,977 - __main__ - INFO - [app.py:516] - CPU cores: 11
2025-03-02 18:49:38,977 - __main__ - INFO - [app.py:524] - Configuration:
2025-03-02 18:49:38,978 - __main__ - INFO - [app.py:525] - - Debug mode: False
2025-03-02 18:49:38,978 - __main__ - INFO - [app.py:526] - - CORS enabled: True
2025-03-02 18:49:38,978 - __main__ - INFO - [app.py:527] - - Rate limiting: 10 requests per minute
2025-03-02 18:49:38,978 - __main__ - INFO - [app.py:528] - - Metrics enabled: True (port 8000)
2025-03-02 18:49:38,978 - __main__ - INFO - [app.py:530] - ==================================================
2025-03-02 18:50:09,022 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: fra
2025-03-02 18:50:09,022 - services.video_routes - INFO - [video_routes.py:901] - Processing video: Movie on 20-02-2025 at 20.44.mov for language: fra
2025-03-02 18:50:09,023 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-02 18:50:09,023 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 18:50:09,023 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 18:50:09,023 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 18:50:09,023 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 18:50:24,881 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 18:50:24,881 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 18:50:45,077 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 18:50:45,078 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-02 18:50:45,081 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-02 18:50:45,081 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-02 18:50:45,082 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 36.06s, Memory Change: 42.75MB
2025-03-02 18:50:45,082 - __main__ - INFO - [app.py:279] - Request to /process-video took 36.06s
2025-03-02 18:50:45,082 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: fra
2025-03-02 18:50:45,082 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: Movie on 20-02-2025 at 20.44.mov, content type: video/quicktime
2025-03-02 18:50:45,094 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-02 18:50:45,094 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp16xnjlct.mp4
2025-03-02 18:50:45,094 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp16xnjlct.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-02 18:50:45,628 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-02 18:50:45,629 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-02 18:50:45,630 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-02 18:50:45,630 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-02 18:50:45,630 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-02 18:50:45,630 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 18:50:45,631 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-02 18:50:45,642 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language fra
2025-03-02 18:50:45,678 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in fra
2025-03-02 18:50:54,010 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Ok, c'est un test, voyons si nous pouvons traduire cette vidéo et aussi faire une synchronisation des lèvres.
2025-03-02 18:50:54,010 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language fra
2025-03-02 18:50:59,568 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.56 seconds
2025-03-02 18:50:59,569 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 81280])
2025-03-02 18:50:59,569 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 13.93 seconds
2025-03-02 18:50:59,569 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 81280]) to temp/translated_audio.wav
2025-03-02 18:50:59,570 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 162604 bytes)
2025-03-02 18:50:59,570 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp16xnjlct.mp4
2025-03-02 18:51:02,828 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-03-02 18:51:02,830 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 3.26 seconds, result: True
2025-03-02 18:51:02,831 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-03-02 18:51:02,831 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp16xnjlct.mp4 + temp/translated_audio.wav
2025-03-02 18:51:03,103 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp16xnjlct.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 2
2025-03-02 18:52:58,375 - services.video_routes - INFO - [video_routes.py:577] - Process stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 407)
Length of mel chunks: 149
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-03-02 18:52:58,376 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/10 [00:00<?, ?it/s][A

 10%|█         | 1/10 [00:11<01:44, 11.60s/it][A

 20%|██        | 2/10 [00:23<01:32, 11.62s/it][A

 30%|███       | 3/10 [00:34<01:21, 11.66s/it][A

 40%|████      | 4/10 [00:46<01:09, 11.59s/it][A

 50%|█████     | 5/10 [00:58<00:58, 11.61s/it][A

 60%|██████    | 6/10 [01:09<00:46, 11.54s/it][A

 70%|███████   | 7/10 [01:20<00:34, 11.52s/it][A

 80%|████████  | 8/10 [01:32<00:23, 11.64s/it][A

 90%|█████████ | 9/10 [01:44<00:11, 11.60s/it][A

100%|██████████| 10/10 [01:47<00:00,  9.09s/it][A
100%|██████████| 10/10 [01:47<00:00, 10.78s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [01:51<01:51, 111.35s/it]
100%|██████████| 2/2 [01:52<00:00, 46.30s/it] 
100%|██████████| 2/2 [01:52<00:00, 56.06s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x13bf07190] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:05.08, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:04.97, start: 0.000000, bitrate: 1583 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1579 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x13c813040] -qscale is ignored, -crf is recommended.
[libx264 @ 0x13c813040] using SAR=1/1
[libx264 @ 0x13c813040] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x13c813040] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x13c813040] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x13c810a50] video:388KiB audio:48KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.936167%
frame=  149 fps=0.0 q=-1.0 Lsize=     440KiB time=00:00:04.90 bitrate= 735.5kbits/s speed=17.1x    
[libx264 @ 0x13c813040] frame I:1     Avg QP:21.49  size: 21742
[libx264 @ 0x13c813040] frame P:73    Avg QP:22.46  size:  4395
[libx264 @ 0x13c813040] frame B:75    Avg QP:25.04  size:   721
[libx264 @ 0x13c813040] consecutive B-frames: 19.5% 38.9%  4.0% 37.6%
[libx264 @ 0x13c813040] mb I  I16..4: 17.8% 80.9%  1.3%
[libx264 @ 0x13c813040] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 41.2%  7.8%  4.6%  0.0%  0.0%    skip:40.3%
[libx264 @ 0x13c813040] mb B  I16..4:  0.3%  1.1%  0.0%  B16..8: 25.4%  0.6%  0.0%  direct: 0.2%  skip:72.4%  L0:43.1% L1:55.8% BI: 1.1%
[libx264 @ 0x13c813040] 8x8 transform intra:75.4% inter:82.8%
[libx264 @ 0x13c813040] coded y,uvDC,uvAC intra: 43.2% 56.7% 5.1% inter: 7.4% 13.0% 0.1%
[libx264 @ 0x13c813040] i16 v,h,dc,p: 30% 26% 23% 22%
[libx264 @ 0x13c813040] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x13c813040] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 34% 27% 19%  2%  6%  4%  4%  3%  2%
[libx264 @ 0x13c813040] i8c dc,h,v,p: 51% 22% 24%  4%
[libx264 @ 0x13c813040] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x13c813040] ref P L0: 73.4%  8.5% 13.2%  4.9%
[libx264 @ 0x13c813040] ref B L0: 85.9% 12.1%  2.1%
[libx264 @ 0x13c813040] ref B L1: 98.5%  1.5%
[libx264 @ 0x13c813040] kb/s:638.88
[aac @ 0x13bf0f120] Qavg: 3496.252

2025-03-02 18:52:58,376 - services.video_routes - INFO - [video_routes.py:674] - Wav2Lip process completed successfully. Output saved to temp/synced_video.mp4
2025-03-02 18:52:58,376 - services.video_routes - INFO - [video_routes.py:686] - Output file verified: temp/synced_video.mp4 (size: 450466 bytes)
2025-03-02 18:52:58,434 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 115.60 seconds, success: True
2025-03-02 18:52:58,435 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 450466 bytes)
2025-03-02 18:52:58,435 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 600624 characters)
2025-03-02 18:52:58,437 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 133.36 seconds
2025-03-02 18:59:06,456 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.02MB
2025-03-02 18:59:06,456 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 0.00s
2025-03-02 18:59:06,458 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.youtube.com/watch?v=GqcSXt1CQOQ
2025-03-02 18:59:06,459 - services.audio_link_routes - INFO - [audio_link_routes.py:243] - Processing YouTube URL
2025-03-02 18:59:06,459 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgx_wasqr/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True}
2025-03-02 18:59:10,105 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded youtube content
2025-03-02 18:59:10,106 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpgx_wasqr/output.wav
2025-03-02 18:59:10,176 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-03-02 18:59:10,177 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-03-02 18:59:10,177 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.72s, Memory Change: 55.03MB
2025-03-02 18:59:10,178 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 3.72s
2025-03-02 18:59:11,463 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 18:59:11,465 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 18:59:35,488 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 18:59:35,488 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 18:59:54,750 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 18:59:54,750 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 18:59:54,753 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 52814ac9
2025-03-02 18:59:54,753 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 18:59:54,753 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 18:59:54,755 - services.translation_routes - INFO - [translation_routes.py:97] - Request 52814ac9: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp592v24_k.wav
2025-03-02 18:59:54,756 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 114.71 seconds
2025-03-02 18:59:54,756 - services.translation_routes - INFO - [translation_routes.py:112] - Request 52814ac9: Beginning audio processing with diagnostics
2025-03-02 18:59:54,756 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp592v24_k.wav
2025-03-02 18:59:54,756 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 18:59:54,761 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1835305]), Frequency: 16000Hz
2025-03-02 18:59:54,864 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 18:59:54,895 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 18:59:54,895 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-02 18:59:55,042 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 18:59:55,236 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:55,237 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:55,279 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:55,280 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:55,321 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:55,321 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:55,362 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:55,363 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:58,266 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 52814ac9
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: fra
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.895
- Avg Amplitude: 0.020
- Rms Level: 0.054
- Crest Factor: 16.494
- Zero Crossings: 707694.000
- Silence Percentage: 56.240
- Clipping Points: 0.000
- Dynamic Range: 5488079.645

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.072
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.610
  - Volume Range: 29136264.324
  - Volume Variations: 0.046

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0065812942754495
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 0.7752232551574707, 'stability': 1.182119607925415, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.5474183559417725, 'distinction': 0.30630162358283997}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.648
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.625
  - Rhythm Quality: 0.681
  - Intonation Quality: 0.569

Vowel Quality:
  - Quality Score: 0.000
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-02 18:59:58,267 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-02 18:59:58,267 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp592v24_k.wav
2025-03-02 18:59:58,267 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 18:59:58,273 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1835305]), Frequency: 16000Hz
2025-03-02 18:59:58,368 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 18:59:58,398 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 18:59:58,398 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for fra
2025-03-02 18:59:58,543 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 18:59:58,733 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:58,734 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:58,777 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:58,777 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:58,819 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:58,819 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 18:59:58,859 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 18:59:58,859 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 19:00:02,019 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-02 19:00:02,020 - services.translation_routes - INFO - [translation_routes.py:153] - Request 52814ac9: Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 19:00:02,020 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.2807337500457735)
2025-03-02 19:00:02,020 - services.translation_routes - INFO - [translation_routes.py:165] - Request 52814ac9: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.2807337500457735}}}
2025-03-02 19:00:02,020 - services.translation_routes - INFO - [translation_routes.py:167] - Request 52814ac9: Audio processed successfully
2025-03-02 19:00:02,115 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-02 19:02:21,495 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The dark side of the force is a pathway to many abilities some consider to be unnatural like what exactly the dark side can prevent padmay from dying anything else yes pick a card anakin and boom that's your card isn't it what you just jumped ahead like five steps dude holy shit hey shut your damn mouth i'm trying to enjoy the opera young sky waker ah perfect let me show you how to handle this woops sorry mace no worries man just don't hit me with lightning again anytime soon okay yeah won't happen again so no i reject it entirely the darkside poisons the intellect and enslaves the soul it's a parasite while stripping away reason and integrity oh is it possible to learn this power from a jedi
2025-03-02 19:04:55,770 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: Dark Side of the Force est un chemin à beaucoup de capacités certains considèrent être innaturel comme quoi exactement le Dark Side peut empêcher Padmé de mourir tout autre chose oui pick a card Anakin et boom that's your card n'est-ce pas quoi vous avez juste sauté à l'avant comme cinq pas dude holy shit hein shut your damn mouth i'm trying to enjoy the opera young sky waker ah perfect laissez moi vous montrer comment gérer cela woops sorry maison no worries man just don't hit me with lightning again any time soon ok yep won't happen again so have i rejected it entirely the Dark Side poisones the intellect and enslaves the soul it's a parasite while stripping away reason and integrity i see through its deception and it has no place in my destiny oh is it possible to learn from a jedi
2025-03-02 19:09:19,499 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-03-02 19:09:19,586 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 19:09:19,590 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 19:09:19,603 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 19:09:19,603 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 19:09:19,617 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 19:09:19,617 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 19:09:19,631 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 19:09:19,631 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 19:09:20,521 - services.diagnostics.base - INFO - [base.py:112] - Completed language analysis for fra
2025-03-02 19:09:20,522 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-03-02 19:09:20,522 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-03-02 19:09:20,522 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-03-02 19:09:20,522 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 52814ac9
2025-03-02 19:09:20,522 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: fra
2025-03-02 19:09:20,523 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-03-02 19:09:20,523 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: fra

Waveform Analysis:
--------------------
- Peak Amplitude: 0.664
- Avg Amplitude: 0.056
- Rms Level: 0.085
- Crest Factor: 7.830
- Zero Crossings: 62187.000
- Silence Percentage: 8.200
- Clipping Points: 0.000
- Dynamic Range: 108.647

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.021
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.023
  - Temporal Flatness: 0.013

- Volume Metrics:
  - Volume Stability: 0.357
  - Volume Range: 553.054
  - Volume Variations: 0.046

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.021674901249021
- Background Noise: 4.13215694851162
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled

Language-Specific Analysis:
--------------------

Nasalization:
  - Nasal Resonance: {'strength': 1.0012272596359253, 'stability': 3.549739122390747, 'peak_frequencies': []}
  - Quality Assessment: {'authenticity': 0.0, 'consistency': 0.0, 'distinction': 0.11055175215005875}
  - Description: Strong nasal resonance. Unstable nasal resonance. Limited distinction between nasal and oral vowels

Liaison:
  - Detected: False
  - Confidence: 0.511
  - Description: Weak or inconsistent liaison patterns

Prosody:
  - Score: 0.000
  - Rhythm Quality: 0.000
  - Intonation Quality: 0.000

Vowel Quality:
  - Quality Score: 0.004
  - Formant Structure: 0.000
  - Description: Poor vowel articulation. Unclear formant structure
2025-03-02 19:09:20,523 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-03-02 19:09:20,523 - services.translation_routes - INFO - [translation_routes.py:307] - Request 52814ac9: Audio output processed successfully
2025-03-02 19:09:20,538 - services.translation_routes - INFO - [translation_routes.py:362] - Request 52814ac9: Response prepared successfully
2025-03-02 19:09:20,539 - services.translation_routes - INFO - [translation_routes.py:375] - Request 52814ac9 completed in 565.79s
2025-03-02 19:09:20,542 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 565.79s, Memory Change: -5821.84MB
2025-03-02 19:09:20,542 - __main__ - INFO - [app.py:279] - Request to /translate took 609.08s
2025-03-02 19:46:01,577 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-03-02 19:46:01,579 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-03-02 19:46:06,581 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-03-02 19:46:06,583 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 19:46:06,583 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 19:46:06,585 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 19:46:06,586 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-03-02 19:46:06,586 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-03-02 19:46:06,588 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-03-02 19:46:06,588 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 19:46:06,588 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 19:46:06,589 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 19:46:06,590 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-03-02 19:46:06,590 - __main__ - INFO - [app.py:450] - Application shutting down...
2025-03-02 19:46:06,590 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 19:46:06,590 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 19:46:06,591 - __main__ - INFO - [app.py:432] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 19:46:06,591 - __main__ - INFO - [app.py:464] - Cleanup completed successfully
2025-03-02 19:46:18,863 - __main__ - INFO - [app.py:538] - Metrics server started on port 8000
2025-03-02 19:46:18,863 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-02 19:46:32,567 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-02 19:46:32,567 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 19:46:32,569 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 19:46:50,421 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 19:46:50,421 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 19:47:10,191 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 19:47:10,191 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 19:47:10,193 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-02 19:47:10,193 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 19:47:10,194 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 19:47:27,745 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 19:47:27,746 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 19:47:49,808 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 19:47:49,808 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:489] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:562] - ==================================================
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:563] - Starting LinguaSync Backend
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:564] - Starting Flask app on port 5001 using cpu
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:565] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:566] - Supported languages: ['spa', 'fra', 'deu', 'ita', 'por', 'rus', 'jpn', 'zho', 'ara', 'bel', 'bul', 'ces', 'dan', 'ell', 'epo', 'est', 'fin', 'heb', 'hrv', 'hun', 'lit', 'lav', 'mkd', 'nld', 'pol', 'ron', 'slk', 'slv', 'srp', 'tha', 'tur', 'vie']
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:567] - Maximum audio length: 300 seconds
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:568] - Sample rate: 16000 Hz
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:572] - System memory: 36.0GB total, 14.4GB available
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:573] - CPU cores: 11
2025-03-02 19:47:49,811 - __main__ - INFO - [app.py:581] - Configuration:
2025-03-02 19:47:49,812 - __main__ - INFO - [app.py:582] - - Debug mode: False
2025-03-02 19:47:49,812 - __main__ - INFO - [app.py:583] - - CORS enabled: True
2025-03-02 19:47:49,812 - __main__ - INFO - [app.py:584] - - Rate limiting: 10 requests per minute
2025-03-02 19:47:49,812 - __main__ - INFO - [app.py:585] - - Metrics enabled: True (port 8000)
2025-03-02 19:47:49,812 - __main__ - INFO - [app.py:587] - ==================================================
2025-03-02 19:55:38,342 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: zho
2025-03-02 19:55:38,342 - services.video_routes - INFO - [video_routes.py:901] - Processing video: original-clip.mov for language: zho
2025-03-02 19:55:38,343 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-02 19:55:38,343 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 19:55:38,343 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 19:55:38,343 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 19:55:38,343 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 19:55:55,711 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 19:55:55,711 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 19:56:12,451 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 19:56:12,451 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 19:56:12,454 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-02 19:56:12,454 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-02 19:56:12,454 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-02 19:56:12,455 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-02 19:56:12,455 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 34.11s, Memory Change: -120.31MB
2025-03-02 19:56:12,455 - __main__ - INFO - [app.py:279] - Request to /process-video took 34.11s
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: zho
2025-03-02 19:56:12,455 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: original-clip.mov, content type: video/quicktime
2025-03-02 19:56:12,467 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-02 19:56:12,467 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqmle66dd.mp4
2025-03-02 19:56:12,468 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpqmle66dd.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-02 19:56:12,685 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-02 19:56:12,685 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-02 19:56:12,687 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-02 19:56:12,688 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-02 19:56:12,688 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-02 19:56:12,688 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 19:56:12,690 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-02 19:56:12,707 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language zho
2025-03-02 19:56:12,745 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in zho
2025-03-02 19:56:12,747 - services.video_routes - ERROR - [video_routes.py:266] - Audio translation failed: `tgt_lang=zho` is not supported by this model. Please specify a `tgt_lang` in
                        afr, amh, arb, ary, arz, asm, azj, bel, ben, bos, bul, cat, ceb, ces, ckb, cmn, cmn_Hant, cym, dan, deu, ell, eng, est, eus, fin, fra, fuv, gaz, gle, glg, guj, heb, hin, hrv, hun, hye, ibo, ind, isl, ita, jav, jpn, kan, kat, kaz, khk, khm, kir, kor, lao, lit, lug, luo, lvs, mai, mal, mar, mkd, mlt, mni, mya, nld, nno, nob, npi, nya, ory, pan, pbt, pes, pol, por, ron, rus, sat, slk, slv, sna, snd, som, spa, srp, swe, swh, tam, tel, tgk, tgl, tha, tur, ukr, urd, uzn, vie, yor, yue, zlm, zul
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 211, in translate_audio
    text_output = self.text_model.generate(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/transformers/models/seamless_m4t_v2/modeling_seamless_m4t_v2.py", line 3448, in generate
    raise ValueError(
ValueError: `tgt_lang=zho` is not supported by this model. Please specify a `tgt_lang` in
                        afr, amh, arb, ary, arz, asm, azj, bel, ben, bos, bul, cat, ceb, ces, ckb, cmn, cmn_Hant, cym, dan, deu, ell, eng, est, eus, fin, fra, fuv, gaz, gle, glg, guj, heb, hin, hrv, hun, hye, ibo, ind, isl, ita, jav, jpn, kan, kat, kaz, khk, khm, kir, kor, lao, lit, lug, luo, lvs, mai, mal, mar, mkd, mlt, mni, mya, nld, nno, nob, npi, nya, ory, pan, pbt, pes, pol, por, ron, rus, sat, slk, slv, sna, snd, som, spa, srp, swe, swh, tam, tel, tgk, tgl, tha, tur, ukr, urd, uzn, vie, yor, yue, zlm, zul
2025-03-02 19:56:12,752 - services.video_routes - ERROR - [video_routes.py:869] - Video processing failed: Failed to translate audio: `tgt_lang=zho` is not supported by this model. Please specify a `tgt_lang` in
                        afr, amh, arb, ary, arz, asm, azj, bel, ben, bos, bul, cat, ceb, ces, ckb, cmn, cmn_Hant, cym, dan, deu, ell, eng, est, eus, fin, fra, fuv, gaz, gle, glg, guj, heb, hin, hrv, hun, hye, ibo, ind, isl, ita, jav, jpn, kan, kat, kaz, khk, khm, kir, kor, lao, lit, lug, luo, lvs, mai, mal, mar, mkd, mlt, mni, mya, nld, nno, nob, npi, nya, ory, pan, pbt, pes, pol, por, ron, rus, sat, slk, slv, sna, snd, som, spa, srp, swe, swh, tam, tel, tgk, tgl, tha, tur, ukr, urd, uzn, vie, yor, yue, zlm, zul
Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 211, in translate_audio
    text_output = self.text_model.generate(
                  ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/anaconda3/lib/python3.12/site-packages/transformers/models/seamless_m4t_v2/modeling_seamless_m4t_v2.py", line 3448, in generate
    raise ValueError(
ValueError: `tgt_lang=zho` is not supported by this model. Please specify a `tgt_lang` in
                        afr, amh, arb, ary, arz, asm, azj, bel, ben, bos, bul, cat, ceb, ces, ckb, cmn, cmn_Hant, cym, dan, deu, ell, eng, est, eus, fin, fra, fuv, gaz, gle, glg, guj, heb, hin, hrv, hun, hye, ibo, ind, isl, ita, jav, jpn, kan, kat, kaz, khk, khm, kir, kor, lao, lit, lug, luo, lvs, mai, mal, mar, mkd, mlt, mni, mya, nld, nno, nob, npi, nya, ory, pan, pbt, pes, pol, por, ron, rus, sat, slk, slv, sna, snd, som, spa, srp, swe, swh, tam, tel, tgk, tgl, tha, tur, ukr, urd, uzn, vie, yor, yue, zlm, zul

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 763, in process_video
    translated_audio = self.translate_audio(audio_tensor, target_language)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/robmills/audio-translation/Backend/services/video_routes.py", line 267, in translate_audio
    raise ValueError(f"Failed to translate audio: {str(e)}")
ValueError: Failed to translate audio: `tgt_lang=zho` is not supported by this model. Please specify a `tgt_lang` in
                        afr, amh, arb, ary, arz, asm, azj, bel, ben, bos, bul, cat, ceb, ces, ckb, cmn, cmn_Hant, cym, dan, deu, ell, eng, est, eus, fin, fra, fuv, gaz, gle, glg, guj, heb, hin, hrv, hun, hye, ibo, ind, isl, ita, jav, jpn, kan, kat, kaz, khk, khm, kir, kor, lao, lit, lug, luo, lvs, mai, mal, mar, mkd, mlt, mni, mya, nld, nno, nob, npi, nya, ory, pan, pbt, pes, pol, por, ron, rus, sat, slk, slv, sna, snd, som, spa, srp, swe, swh, tam, tel, tgk, tgl, tha, tur, ukr, urd, uzn, vie, yor, yue, zlm, zul
2025-03-02 20:21:41,870 - __main__ - INFO - [app.py:218] - Received SIGINT signal
2025-03-02 20:21:41,872 - __main__ - INFO - [app.py:203] - Initiating graceful shutdown...
2025-03-02 20:21:46,877 - __main__ - INFO - [app.py:507] - Application shutting down...
2025-03-02 20:21:46,878 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 20:21:46,878 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 20:21:46,880 - __main__ - INFO - [app.py:489] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 20:21:46,881 - __main__ - INFO - [app.py:521] - Cleanup completed successfully
2025-03-02 20:21:46,881 - __main__ - INFO - [app.py:207] - Graceful shutdown completed
2025-03-02 20:21:46,882 - __main__ - INFO - [app.py:507] - Application shutting down...
2025-03-02 20:21:46,882 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 20:21:46,882 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 20:21:46,884 - __main__ - INFO - [app.py:489] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 20:21:46,884 - __main__ - INFO - [app.py:521] - Cleanup completed successfully
2025-03-02 20:21:46,884 - __main__ - INFO - [app.py:507] - Application shutting down...
2025-03-02 20:21:46,885 - services.model_manager - INFO - [model_manager.py:233] - Cleaning up model resources
2025-03-02 20:21:46,885 - services.model_manager - INFO - [model_manager.py:246] - Model cleanup completed successfully
2025-03-02 20:21:46,886 - __main__ - INFO - [app.py:489] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 20:21:46,886 - __main__ - INFO - [app.py:521] - Cleanup completed successfully
2025-03-02 20:22:02,654 - __main__ - INFO - [app.py:540] - Metrics server started on port 8000
2025-03-02 20:22:02,655 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-02 20:22:29,841 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-02 20:22:29,841 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 20:22:29,842 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 20:22:51,038 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 20:22:51,039 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 20:23:09,433 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 20:23:09,433 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 20:23:09,436 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-02 20:23:09,436 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 20:23:09,436 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 20:23:27,966 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 20:23:27,966 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 20:23:47,835 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 20:23:47,835 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:491] - Cleanup complete: removed 0 files, freed 0.00MB
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:564] - ==================================================
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:565] - Starting LinguaSync Backend
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:566] - Starting Flask app on port 5001 using cpu
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:567] - Python version: 3.12.4 | packaged by Anaconda, Inc. | (main, Jun 18 2024, 10:07:17) [Clang 14.0.6 ]
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:568] - Supported languages: ['spa', 'fra', 'deu', 'ita', 'por', 'rus', 'jpn', 'cmn', 'cmn_Hant', 'ara', 'bel', 'bul', 'ces', 'dan', 'ell', 'epo', 'est', 'fin', 'heb', 'hrv', 'hun', 'lit', 'lav', 'mkd', 'nld', 'pol', 'ron', 'slk', 'slv', 'srp', 'tha', 'tur', 'vie']
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:569] - Maximum audio length: 300 seconds
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:570] - Sample rate: 16000 Hz
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:574] - System memory: 36.0GB total, 14.3GB available
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:575] - CPU cores: 11
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:583] - Configuration:
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:584] - - Debug mode: False
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:585] - - CORS enabled: True
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:586] - - Rate limiting: 10 requests per minute
2025-03-02 20:23:47,840 - __main__ - INFO - [app.py:587] - - Metrics enabled: True (port 8000)
2025-03-02 20:23:47,841 - __main__ - INFO - [app.py:589] - ==================================================
2025-03-02 20:39:56,147 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: cmn
2025-03-02 20:39:56,148 - services.video_routes - INFO - [video_routes.py:901] - Processing video: original-clip.mov for language: cmn
2025-03-02 20:39:56,148 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-02 20:39:56,148 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 20:39:56,148 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 20:39:56,148 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 20:39:56,149 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 20:40:10,230 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 20:40:10,230 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 20:40:28,846 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 20:40:28,846 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-02 20:40:28,849 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-02 20:40:28,849 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-02 20:40:28,849 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 32.70s, Memory Change: 396.27MB
2025-03-02 20:40:28,850 - __main__ - INFO - [app.py:279] - Request to /process-video took 32.70s
2025-03-02 20:40:28,850 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: cmn
2025-03-02 20:40:28,850 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: original-clip.mov, content type: video/quicktime
2025-03-02 20:40:28,862 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-02 20:40:28,864 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmphbpdao0i.mp4
2025-03-02 20:40:28,864 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmphbpdao0i.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-02 20:40:29,096 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-02 20:40:29,096 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-02 20:40:29,098 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-02 20:40:29,098 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-02 20:40:29,098 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-02 20:40:29,098 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 20:40:29,099 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-02 20:40:29,111 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language cmn
2025-03-02 20:40:29,127 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in cmn
2025-03-02 20:40:35,678 - services.video_routes - INFO - [video_routes.py:218] - Generated text: 好吧,这是一个测试, 让我们看看我们是否可以翻译这个视频,
2025-03-02 20:40:35,678 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language cmn
2025-03-02 20:40:41,120 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.44 seconds
2025-03-02 20:40:41,121 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 121280])
2025-03-02 20:40:41,121 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 12.01 seconds
2025-03-02 20:40:41,121 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 121280]) to temp/translated_audio.wav
2025-03-02 20:40:41,122 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 242604 bytes)
2025-03-02 20:40:41,122 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmphbpdao0i.mp4
2025-03-02 20:40:44,702 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-03-02 20:40:44,703 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 3.58 seconds, result: True
2025-03-02 20:40:44,704 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-03-02 20:40:44,704 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmphbpdao0i.mp4 + temp/translated_audio.wav
2025-03-02 20:40:44,978 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmphbpdao0i.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 2
2025-03-02 20:43:36,431 - services.video_routes - INFO - [video_routes.py:577] - Process stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 607)
Length of mel chunks: 224
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-03-02 20:43:36,433 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/14 [00:00<?, ?it/s][A

  7%|▋         | 1/14 [00:12<02:37, 12.12s/it][A

 14%|█▍        | 2/14 [00:23<02:23, 11.94s/it][A

 21%|██▏       | 3/14 [00:35<02:09, 11.74s/it][A

 29%|██▊       | 4/14 [00:47<01:56, 11.67s/it][A

 36%|███▌      | 5/14 [00:58<01:45, 11.68s/it][A

 43%|████▎     | 6/14 [01:10<01:33, 11.64s/it][A

 50%|█████     | 7/14 [01:21<01:21, 11.61s/it][A

 57%|█████▋    | 8/14 [01:33<01:09, 11.57s/it][A

 64%|██████▍   | 9/14 [01:44<00:57, 11.53s/it][A

 71%|███████▏  | 10/14 [01:56<00:46, 11.53s/it][A

 79%|███████▊  | 11/14 [02:07<00:34, 11.51s/it][A

 86%|████████▌ | 12/14 [02:19<00:22, 11.48s/it][A

 93%|█████████▎| 13/14 [02:30<00:11, 11.50s/it][A

100%|██████████| 14/14 [02:42<00:00, 11.49s/it][A
100%|██████████| 14/14 [02:42<00:00, 11.58s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [02:45<02:45, 165.69s/it]
100%|██████████| 2/2 [02:48<00:00, 69.66s/it] 
100%|██████████| 2/2 [02:48<00:00, 84.06s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x15a006300] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:07.58, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:07.47, start: 0.000000, bitrate: 1511 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1505 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x15a00aa20] -qscale is ignored, -crf is recommended.
[libx264 @ 0x15a00aa20] using SAR=1/1
[libx264 @ 0x15a00aa20] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x15a00aa20] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x15a00aa20] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x15a007fe0] video:551KiB audio:68KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.886173%
frame=  224 fps=0.0 q=-1.0 Lsize=     624KiB time=00:00:07.40 bitrate= 690.5kbits/s speed=20.2x    
[libx264 @ 0x15a00aa20] frame I:1     Avg QP:21.47  size: 21818
[libx264 @ 0x15a00aa20] frame P:102   Avg QP:22.21  size:  4496
[libx264 @ 0x15a00aa20] frame B:121   Avg QP:24.87  size:   684
[libx264 @ 0x15a00aa20] consecutive B-frames: 14.3% 40.2%  2.7% 42.9%
[libx264 @ 0x15a00aa20] mb I  I16..4: 17.4% 81.2%  1.4%
[libx264 @ 0x15a00aa20] mb P  I16..4:  1.6%  4.5%  0.1%  P16..4: 40.7%  8.1%  5.0%  0.0%  0.0%    skip:40.0%
[libx264 @ 0x15a00aa20] mb B  I16..4:  0.3%  0.9%  0.0%  B16..8: 25.7%  0.5%  0.0%  direct: 0.2%  skip:72.3%  L0:43.1% L1:55.9% BI: 1.0%
[libx264 @ 0x15a00aa20] 8x8 transform intra:75.0% inter:82.0%
[libx264 @ 0x15a00aa20] coded y,uvDC,uvAC intra: 42.7% 56.8% 4.9% inter: 7.0% 12.3% 0.1%
[libx264 @ 0x15a00aa20] i16 v,h,dc,p: 29% 27% 22% 23%
[libx264 @ 0x15a00aa20] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 30% 16% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x15a00aa20] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 42% 25% 19%  2%  2%  4%  3%  2%  1%
[libx264 @ 0x15a00aa20] i8c dc,h,v,p: 51% 22% 24%  3%
[libx264 @ 0x15a00aa20] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x15a00aa20] ref P L0: 72.5%  8.4% 13.8%  5.4%
[libx264 @ 0x15a00aa20] ref B L0: 85.1% 12.5%  2.4%
[libx264 @ 0x15a00aa20] ref B L1: 98.0%  2.0%
[libx264 @ 0x15a00aa20] kb/s:603.41
[aac @ 0x15a0127a0] Qavg: 21639.879

2025-03-02 20:43:36,433 - services.video_routes - INFO - [video_routes.py:674] - Wav2Lip process completed successfully. Output saved to temp/synced_video.mp4
2025-03-02 20:43:36,433 - services.video_routes - INFO - [video_routes.py:686] - Output file verified: temp/synced_video.mp4 (size: 638669 bytes)
2025-03-02 20:43:36,493 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 171.79 seconds, success: True
2025-03-02 20:43:36,493 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 638669 bytes)
2025-03-02 20:43:36,494 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 851560 characters)
2025-03-02 20:43:36,496 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 187.65 seconds
2025-03-02 21:31:12,164 - services.video_routes - INFO - [video_routes.py:890] - Received video processing request for language: ukr
2025-03-02 21:31:12,165 - services.video_routes - INFO - [video_routes.py:901] - Processing video: original-clip.mov for language: ukr
2025-03-02 21:31:12,165 - services.video_routes - INFO - [video_routes.py:32] - Initializing VideoProcessor
2025-03-02 21:31:12,165 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 21:31:12,165 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 21:31:12,165 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 21:31:12,167 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 21:31:29,467 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 21:31:29,467 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 21:31:47,915 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 21:31:47,915 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 21:31:47,917 - services.video_routes - INFO - [video_routes.py:37] - Using device: cpu
2025-03-02 21:31:47,917 - services.video_routes - INFO - [video_routes.py:42] - Temp directory: temp
2025-03-02 21:31:47,917 - services.video_routes - INFO - [video_routes.py:49] - Checking Wav2Lip setup...
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:56] - Wav2Lip directory found: /Users/robmills/audio-translation/Backend/Wav2Lip
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:71] - ✓ Inference script found: Wav2Lip/inference.py (9750 bytes)
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:71] - ✓ Audio processing module found: Wav2Lip/audio.py (4508 bytes)
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection API found: Wav2Lip/face_detection/api.py (2266 bytes)
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:71] - ✓ Face detection model found: Wav2Lip/face_detection/detection/sfd/s3fd.pth (89843225 bytes)
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:71] - ✓ Primary model checkpoint found: Wav2Lip/checkpoints/wav2lip.pth (435807851 bytes)
2025-03-02 21:31:47,918 - services.video_routes - WARNING - [video_routes.py:73] - ✗ GAN model checkpoint (optional) not found: Wav2Lip/checkpoints/wav2lip_gan.pth
2025-03-02 21:31:47,918 - services.utils - INFO - [utils.py:57] - Performance - Function: process_video, Duration: 35.75s, Memory Change: 797.50MB
2025-03-02 21:31:47,918 - __main__ - INFO - [app.py:279] - Request to /process-video took 35.75s
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:720] - Starting video processing for language: ukr
2025-03-02 21:31:47,918 - services.video_routes - INFO - [video_routes.py:725] - Input video filename: original-clip.mov, content type: video/quicktime
2025-03-02 21:31:47,930 - services.video_routes - INFO - [video_routes.py:734] - Saved uploaded video (size: 20861521 bytes)
2025-03-02 21:31:47,931 - services.video_routes - INFO - [video_routes.py:82] - Extracting audio from /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkayjs4ei.mp4
2025-03-02 21:31:47,931 - services.video_routes - INFO - [video_routes.py:94] - Running FFmpeg command: ffmpeg -y -i /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkayjs4ei.mp4 -vn -acodec pcm_s16le -ar 16000 -ac 1 temp/temp_audio.wav
2025-03-02 21:31:48,202 - services.video_routes - INFO - [video_routes.py:105] - Audio successfully extracted to temp/temp_audio.wav (size: 446598 bytes)
2025-03-02 21:31:48,203 - services.video_routes - INFO - [video_routes.py:341] - Detecting speech start in temp/temp_audio.wav
2025-03-02 21:31:48,204 - services.video_routes - INFO - [video_routes.py:383] - Detected speech start at 0.540 seconds
2025-03-02 21:31:48,204 - services.video_routes - INFO - [video_routes.py:749] - Detected speech starts at: 0.54 seconds
2025-03-02 21:31:48,204 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: temp/temp_audio.wav
2025-03-02 21:31:48,204 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 21:31:48,205 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 223260]), Frequency: 16000Hz
2025-03-02 21:31:48,233 - services.video_routes - INFO - [video_routes.py:184] - Translating audio of shape torch.Size([1, 223232]) to language ukr
2025-03-02 21:31:48,251 - services.video_routes - INFO - [video_routes.py:209] - Generating text translation in ukr
2025-03-02 21:31:56,656 - services.video_routes - INFO - [video_routes.py:218] - Generated text: Добре, це тест, давайте подивимося, чи можемо ми перекласти це відео і також зробити синхронізацію губ.
2025-03-02 21:31:56,656 - services.video_routes - INFO - [video_routes.py:221] - Generating translated speech for language ukr
2025-03-02 21:32:02,451 - services.video_routes - INFO - [video_routes.py:233] - Speech generation completed in 5.80 seconds
2025-03-02 21:32:02,452 - services.video_routes - INFO - [video_routes.py:262] - Translation successful, audio shape: torch.Size([1, 111040])
2025-03-02 21:32:02,452 - services.video_routes - INFO - [video_routes.py:765] - Translation completed in 14.22 seconds
2025-03-02 21:32:02,452 - services.video_routes - INFO - [video_routes.py:155] - Saving audio tensor of shape torch.Size([1, 111040]) to temp/translated_audio.wav
2025-03-02 21:32:02,454 - services.video_routes - INFO - [video_routes.py:175] - Audio saved successfully to temp/translated_audio.wav (size: 222124 bytes)
2025-03-02 21:32:02,454 - services.video_routes - INFO - [video_routes.py:392] - Detecting face in /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkayjs4ei.mp4
2025-03-02 21:32:05,469 - services.video_routes - INFO - [video_routes.py:458] - Selected face detected with bounding box: (641, 245, 1057, 834)
2025-03-02 21:32:05,471 - services.video_routes - INFO - [video_routes.py:785] - Face detection completed in 3.02 seconds, result: True
2025-03-02 21:32:05,471 - services.video_routes - INFO - [video_routes.py:800] - Attempting lip sync with Wav2Lip
2025-03-02 21:32:05,471 - services.video_routes - INFO - [video_routes.py:467] - Starting lip sync with Wav2Lip: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkayjs4ei.mp4 + temp/translated_audio.wav
2025-03-02 21:32:05,472 - services.video_routes - INFO - [video_routes.py:564] - Running Wav2Lip with command: python Wav2Lip/inference.py --checkpoint_path Wav2Lip/checkpoints/wav2lip.pth --face /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpkayjs4ei.mp4 --audio temp/translated_audio.wav --outfile temp/synced_video.mp4 --nosmooth --pads 0 20 0 0 --resize_factor 2
2025-03-02 21:34:45,596 - services.video_routes - INFO - [video_routes.py:577] - Process stdout: Using cpu for inference.
Reading video frames...
Number of frames available for inference: 420
(80, 556)
Length of mel chunks: 204
Load checkpoint from: Wav2Lip/checkpoints/wav2lip.pth
Model loaded

2025-03-02 21:34:45,597 - services.video_routes - ERROR - [video_routes.py:582] - Process stderr: 
  0%|          | 0/2 [00:00<?, ?it/s]/Users/robmills/audio-translation/Backend/Wav2Lip/face_detection/detection/sfd/sfd_detector.py:24: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  model_weights = torch.load(path_to_detector)


  0%|          | 0/13 [00:00<?, ?it/s][A

  8%|▊         | 1/13 [00:11<02:23, 11.98s/it][A

 15%|█▌        | 2/13 [00:23<02:11, 11.93s/it][A

 23%|██▎       | 3/13 [00:35<01:57, 11.72s/it][A

 31%|███       | 4/13 [00:47<01:45, 11.71s/it][A

 38%|███▊      | 5/13 [00:58<01:32, 11.61s/it][A

 46%|████▌     | 6/13 [01:10<01:21, 11.60s/it][A

 54%|█████▍    | 7/13 [01:21<01:10, 11.71s/it][A

 62%|██████▏   | 8/13 [01:33<00:58, 11.73s/it][A

 69%|██████▉   | 9/13 [01:45<00:46, 11.71s/it][A

 77%|███████▋  | 10/13 [01:57<00:35, 11.68s/it][A

 85%|████████▍ | 11/13 [02:08<00:23, 11.64s/it][A

 92%|█████████▏| 12/13 [02:20<00:11, 11.64s/it][A

100%|██████████| 13/13 [02:31<00:00, 11.43s/it][A
100%|██████████| 13/13 [02:31<00:00, 11.63s/it]
/Users/robmills/audio-translation/Backend/Wav2Lip/inference.py:164: FutureWarning: You are using `torch.load` with `weights_only=False` (the current default value), which uses the default pickle module implicitly. It is possible to construct malicious pickle data which will execute arbitrary code during unpickling (See https://github.com/pytorch/pytorch/blob/main/SECURITY.md#untrusted-models for more details). In a future release, the default value for `weights_only` will be flipped to `True`. This limits the functions that could be executed during unpickling. Arbitrary objects will no longer be allowed to be loaded via this mode unless they are explicitly allowlisted by the user via `torch.serialization.add_safe_globals`. We recommend you start setting `weights_only=True` for any use case where you don't have full control of the loaded file. Please open an issue on GitHub for any issues related to this experimental feature.
  checkpoint = torch.load(checkpoint_path,

 50%|█████     | 1/2 [02:34<02:34, 154.78s/it]
100%|██████████| 2/2 [02:36<00:00, 64.87s/it] 
100%|██████████| 2/2 [02:36<00:00, 78.36s/it]
ffmpeg version 7.1 Copyright (c) 2000-2024 the FFmpeg developers
  built with Apple clang version 16.0.0 (clang-1600.0.26.4)
  configuration: --prefix=/opt/homebrew/Cellar/ffmpeg/7.1_4 --enable-shared --enable-pthreads --enable-version3 --cc=clang --host-cflags= --host-ldflags='-Wl,-ld_classic' --enable-ffplay --enable-gnutls --enable-gpl --enable-libaom --enable-libaribb24 --enable-libbluray --enable-libdav1d --enable-libharfbuzz --enable-libjxl --enable-libmp3lame --enable-libopus --enable-librav1e --enable-librist --enable-librubberband --enable-libsnappy --enable-libsrt --enable-libssh --enable-libsvtav1 --enable-libtesseract --enable-libtheora --enable-libvidstab --enable-libvmaf --enable-libvorbis --enable-libvpx --enable-libwebp --enable-libx264 --enable-libx265 --enable-libxml2 --enable-libxvid --enable-lzma --enable-libfontconfig --enable-libfreetype --enable-frei0r --enable-libass --enable-libopencore-amrnb --enable-libopencore-amrwb --enable-libopenjpeg --enable-libspeex --enable-libsoxr --enable-libzmq --enable-libzimg --disable-libjack --disable-indev=jack --enable-videotoolbox --enable-audiotoolbox --enable-neon
  libavutil      59. 39.100 / 59. 39.100
  libavcodec     61. 19.100 / 61. 19.100
  libavformat    61.  7.100 / 61.  7.100
  libavdevice    61.  3.100 / 61.  3.100
  libavfilter    10.  4.100 / 10.  4.100
  libswscale      8.  3.100 /  8.  3.100
  libswresample   5.  3.100 /  5.  3.100
  libpostproc    58.  3.100 / 58.  3.100
[aist#0:0/pcm_s16le @ 0x12162ffb0] Guessed Channel Layout: mono
Input #0, wav, from 'temp/translated_audio.wav':
  Duration: 00:00:06.94, bitrate: 256 kb/s
  Stream #0:0: Audio: pcm_s16le ([1][0][0][0] / 0x0001), 16000 Hz, mono, s16, 256 kb/s
Input #1, avi, from 'temp/result.avi':
  Metadata:
    software        : Lavf61.7.100
  Duration: 00:00:06.80, start: 0.000000, bitrate: 1506 kb/s
  Stream #1:0: Video: mpeg4 (Simple Profile) (DIVX / 0x58564944), yuv420p, 810x540 [SAR 1:1 DAR 3:2], 1501 kb/s, 30 fps, 30 tbr, 30 tbn
Stream mapping:
  Stream #1:0 -> #0:0 (mpeg4 (native) -> h264 (libx264))
  Stream #0:0 -> #0:1 (pcm_s16le (native) -> aac (native))
Press [q] to stop, [?] for help
[libx264 @ 0x121633fb0] -qscale is ignored, -crf is recommended.
[libx264 @ 0x121633fb0] using SAR=1/1
[libx264 @ 0x121633fb0] using cpu capabilities: ARMv8 NEON
[libx264 @ 0x121633fb0] profile High, level 3.1, 4:2:0, 8-bit
[libx264 @ 0x121633fb0] 264 - core 164 r3108 31e19f9 - H.264/MPEG-4 AVC codec - Copyleft 2003-2023 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=16 lookahead_threads=2 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, mp4, to 'temp/synced_video.mp4':
  Metadata:
    encoder         : Lavf61.7.100
  Stream #0:0: Video: h264 (avc1 / 0x31637661), yuv420p(tv, progressive), 810x540 [SAR 1:1 DAR 3:2], q=2-31, 30 fps, 15360 tbn
      Metadata:
        encoder         : Lavc61.19.100 libx264
      Side data:
        cpb: bitrate max/min/avg: 0/0/0 buffer size: 0 vbv_delay: N/A
  Stream #0:1: Audio: aac (LC) (mp4a / 0x6134706D), 16000 Hz, mono, fltp, 69 kb/s
      Metadata:
        encoder         : Lavc61.19.100 aac
[out#0/mp4 @ 0x12162f2b0] video:505KiB audio:64KiB subtitle:0KiB other streams:0KiB global headers:0KiB muxing overhead: 0.899984%
frame=  204 fps=0.0 q=-1.0 Lsize=     574KiB time=00:00:06.73 bitrate= 698.8kbits/s speed=20.7x    
[libx264 @ 0x121633fb0] frame I:1     Avg QP:21.45  size: 21794
[libx264 @ 0x121633fb0] frame P:93    Avg QP:22.24  size:  4501
[libx264 @ 0x121633fb0] frame B:110   Avg QP:24.77  size:   693
[libx264 @ 0x121633fb0] consecutive B-frames: 13.7% 42.2%  2.9% 41.2%
[libx264 @ 0x121633fb0] mb I  I16..4: 16.7% 81.2%  2.1%
[libx264 @ 0x121633fb0] mb P  I16..4:  1.5%  4.5%  0.1%  P16..4: 41.3%  8.1%  4.9%  0.0%  0.0%    skip:39.7%
[libx264 @ 0x121633fb0] mb B  I16..4:  0.3%  1.0%  0.0%  B16..8: 25.5%  0.5%  0.0%  direct: 0.2%  skip:72.4%  L0:42.7% L1:56.2% BI: 1.0%
[libx264 @ 0x121633fb0] 8x8 transform intra:75.7% inter:82.4%
[libx264 @ 0x121633fb0] coded y,uvDC,uvAC intra: 42.9% 56.7% 4.9% inter: 7.1% 12.4% 0.1%
[libx264 @ 0x121633fb0] i16 v,h,dc,p: 28% 26% 23% 23%
[libx264 @ 0x121633fb0] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 29% 17% 43%  2%  2%  3%  2%  2%  1%
[libx264 @ 0x121633fb0] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 36% 27% 20%  2%  3%  4%  4%  2%  1%
[libx264 @ 0x121633fb0] i8c dc,h,v,p: 51% 22% 23%  4%
[libx264 @ 0x121633fb0] Weighted P-Frames: Y:0.0% UV:0.0%
[libx264 @ 0x121633fb0] ref P L0: 72.4%  8.4% 13.7%  5.5%
[libx264 @ 0x121633fb0] ref B L0: 85.0% 12.8%  2.2%
[libx264 @ 0x121633fb0] ref B L1: 98.2%  1.8%
[libx264 @ 0x121633fb0] kb/s:607.81
[aac @ 0x12163bbd0] Qavg: 7814.337

2025-03-02 21:34:45,597 - services.video_routes - INFO - [video_routes.py:674] - Wav2Lip process completed successfully. Output saved to temp/synced_video.mp4
2025-03-02 21:34:45,597 - services.video_routes - INFO - [video_routes.py:686] - Output file verified: temp/synced_video.mp4 (size: 588145 bytes)
2025-03-02 21:34:45,649 - services.video_routes - INFO - [video_routes.py:808] - Lip sync attempt completed in 160.18 seconds, success: True
2025-03-02 21:34:45,649 - services.video_routes - INFO - [video_routes.py:846] - Final video created: temp/synced_video.mp4 (size: 588145 bytes)
2025-03-02 21:34:45,650 - services.video_routes - INFO - [video_routes.py:860] - Encoded video data in 0.00 seconds (length: 784196 characters)
2025-03-02 21:34:45,653 - services.video_routes - INFO - [video_routes.py:866] - Total video processing completed in 177.73 seconds
2025-03-02 23:29:50,430 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.27MB
2025-03-02 23:29:50,431 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 0.00s
2025-03-02 23:29:50,433 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.youtube.com/watch?v=GqcSXt1CQOQ
2025-03-02 23:29:50,434 - services.audio_link_routes - INFO - [audio_link_routes.py:243] - Processing YouTube URL
2025-03-02 23:29:50,435 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp15rqu7xa/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True}
2025-03-02 23:29:54,909 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded youtube content
2025-03-02 23:29:54,910 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp15rqu7xa/output.wav
2025-03-02 23:29:54,971 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-03-02 23:29:54,972 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-03-02 23:29:54,973 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 4.54s, Memory Change: 137.22MB
2025-03-02 23:29:54,973 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 4.54s
2025-03-02 23:30:03,807 - services.model_manager - INFO - [model_manager.py:211] - Model inactive for too long, reloading...
2025-03-02 23:30:03,808 - services.model_manager - INFO - [model_manager.py:120] - Loading SeamlessM4T model: facebook/seamless-m4t-v2-large
2025-03-02 23:30:17,574 - services.model_manager - INFO - [model_manager.py:184] - Models loaded on CPU
2025-03-02 23:30:17,574 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 23:30:17,575 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 23:30:46,199 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 23:30:46,199 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 23:31:06,875 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 23:31:06,875 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 23:31:06,880 - services.model_manager - INFO - [model_manager.py:190] - Model initialization successful
2025-03-02 23:31:06,880 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 23:31:06,880 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 23:31:26,215 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 23:31:26,215 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 23:31:43,420 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 23:31:43,421 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 23:31:43,427 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 4675fb3f
2025-03-02 23:31:43,427 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 23:31:43,427 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 23:31:43,430 - services.translation_routes - INFO - [translation_routes.py:97] - Request 4675fb3f: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7fjywu_a.wav
2025-03-02 23:31:43,430 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 114.71 seconds
2025-03-02 23:31:43,431 - services.translation_routes - INFO - [translation_routes.py:112] - Request 4675fb3f: Beginning audio processing with diagnostics
2025-03-02 23:31:43,431 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7fjywu_a.wav
2025-03-02 23:31:43,431 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:31:43,436 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1835305]), Frequency: 16000Hz
2025-03-02 23:31:43,558 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:31:43,593 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 23:31:43,593 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for heb
2025-03-02 23:31:43,593 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for heb, using defaults
2025-03-02 23:31:43,738 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:31:43,926 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:43,926 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:43,969 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:43,969 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:44,007 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:44,008 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:44,052 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:44,052 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:46,950 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: heb
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 4675fb3f
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: heb
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: heb

Waveform Analysis:
--------------------
- Peak Amplitude: 0.895
- Avg Amplitude: 0.020
- Rms Level: 0.054
- Crest Factor: 16.494
- Zero Crossings: 707694.000
- Silence Percentage: 56.240
- Clipping Points: 0.000
- Dynamic Range: 5488079.645

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.072
  - Temporal Flatness: 0.024

- Volume Metrics:
  - Volume Stability: -0.610
  - Volume Range: 29136264.324
  - Volume Variations: 0.046

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0065812942754495
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled
2025-03-02 23:31:46,951 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-02 23:31:46,951 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp7fjywu_a.wav
2025-03-02 23:31:46,951 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:31:46,956 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 1835305]), Frequency: 16000Hz
2025-03-02 23:31:47,047 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:31:47,076 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 23:31:47,076 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for heb
2025-03-02 23:31:47,077 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for heb, using defaults
2025-03-02 23:31:47,218 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:31:47,418 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:47,418 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:47,456 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:47,457 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:47,497 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:47,497 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:47,535 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:31:47,535 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:31:50,407 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: heb
2025-03-02 23:31:50,408 - services.translation_routes - INFO - [translation_routes.py:153] - Request 4675fb3f: Background music analysis: {'has_background_music': True, 'music_confidence': 0.2807337500457735, 'feature_scores': {'spectral_flatness': 0.1498327791923642, 'rhythm_regularity': 0.02512562814070352, 'bass_presence': 0.057027693157767706, 'temporal_stability': 0.04874764955493807}, 'speech_vs_music': {'speech_prominence': 5.199623760877559, 'speech_band_energy': 5.338419839517883e-08, 'music_band_energy': 1.0166934849564768e-08}}
2025-03-02 23:31:50,408 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.2807337500457735)
2025-03-02 23:31:50,408 - services.translation_routes - INFO - [translation_routes.py:165] - Request 4675fb3f: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': True, 'confidence': 0.2807337500457735}}}
2025-03-02 23:31:50,408 - services.translation_routes - INFO - [translation_routes.py:167] - Request 4675fb3f: Audio processed successfully
2025-03-02 23:31:50,508 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-02 23:34:16,881 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: The dark side of the force is a pathway to many abilities some consider to be unnatural like what exactly the dark side can prevent padmay from dying anything else yes pick a card anakin and boom that's your card isn't it what you just jumped ahead like five steps dude holy shit hey shut your damn mouth i'm trying to enjoy the opera young sky waker ah perfect let me show you how to handle this woops sorry mace no worries man just don't hit me with lightning again anytime soon okay yeah won't happen again so no i reject it entirely the darkside poisons the intellect and enslaves the soul it's a parasite while stripping away reason and integrity oh is it possible to learn this power from a jedi
2025-03-02 23:36:47,329 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: הצד האפל של הפולס הוא נתיב להרבה יכולות, חלקם מחשיבים אותו כבלתי טבעי. כמו מה בדיוק? הצד האפל יכול למנוע מפדמי ממות. כן, קח קלף, אנאקין. ובום, זה הקלף שלך, לא? מה? אתה רק קפצת קדימה כמו חמישה צעדים, דוד? Holy shit, hey, shut your damn mouth. I'm trying to enjoy the opera young sky waker. Ah, perfect. תן לי להראות לך איך להתמודד עם זה. Woops, sorry, Mason. No worries, man. Just don't hit me with lightning again anytime soon. Okay. Yep, I reject it entirely. The dark side poisons the intellect and enslaves the soul. It's a parasite feeding through its deception and integrity. Oh, is it possible to learn this power from a Jedi?
2025-03-02 23:36:47,330 - services.translation_routes - ERROR - [translation_routes.py:282] - Translation error: `tgt_lang=heb` is not supported by this model.
                    Please specify a `tgt_lang` in arb,ben,cat,ces,cmn,cym,dan,deu,eng,est,fin,fra,hin,ind,ita,jpn,kan,kor,mlt,nld,pes,pol,por,ron,rus,slk,spa,swe,swh,tam,tel,tgl,tha,tur,ukr,urd,uzn,vie. Note that SeamlessM4Tv2 supports
                    more languages for text translation than for speech synthesis.
2025-03-02 23:36:47,333 - services.translation_routes - INFO - [translation_routes.py:375] - Request 4675fb3f completed in 303.91s
2025-03-02 23:36:47,337 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 303.91s, Memory Change: -7660.86MB
2025-03-02 23:36:47,337 - __main__ - INFO - [app.py:279] - Request to /translate took 403.53s
2025-03-02 23:54:51,043 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 0.00s, Memory Change: 0.03MB
2025-03-02 23:54:51,043 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 0.00s
2025-03-02 23:54:51,046 - services.audio_link_routes - INFO - [audio_link_routes.py:226] - Processing URL: https://www.youtube.com/shorts/qj_fqQDlboQ
2025-03-02 23:54:51,047 - services.audio_link_routes - INFO - [audio_link_routes.py:243] - Processing YouTube URL
2025-03-02 23:54:51,047 - services.audio_link_routes - INFO - [audio_link_routes.py:130] - Using options for youtube: {'format': 'bestaudio[ext=m4a]/bestaudio/best', 'outtmpl': '/var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpum45pgdx/output', 'quiet': False, 'no_warnings': True, 'keepvideo': True, 'postprocessors': [{'key': 'FFmpegExtractAudio', 'preferredcodec': 'wav', 'preferredquality': '192'}], 'concurrent_fragment_downloads': 8, 'http_headers': {'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/121.0.0.0 Safari/537.36', 'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8', 'Accept-Language': 'en-us,en;q=0.5', 'Accept-Encoding': 'gzip,deflate', 'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.7'}, 'nocheckcertificate': True, 'ignoreerrors': False, 'geo_bypass': True}
2025-03-02 23:54:54,099 - services.audio_link_routes - INFO - [audio_link_routes.py:143] - Successfully downloaded youtube content
2025-03-02 23:54:54,100 - services.audio_link_routes - INFO - [audio_link_routes.py:162] - Found audio file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpum45pgdx/output.wav
2025-03-02 23:54:54,126 - services.audio_link_routes - INFO - [audio_link_routes.py:174] - Successfully converted audio to WAV
2025-03-02 23:54:54,127 - services.audio_link_routes - INFO - [audio_link_routes.py:252] - Successfully processed audio
2025-03-02 23:54:54,127 - services.utils - INFO - [utils.py:57] - Performance - Function: process_audio_url, Duration: 3.08s, Memory Change: 34.39MB
2025-03-02 23:54:54,127 - __main__ - INFO - [app.py:279] - Request to /process-audio-url took 3.08s
2025-03-02 23:54:56,560 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 23:54:56,566 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 23:55:17,728 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 23:55:17,728 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 23:55:37,303 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 23:55:37,304 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 23:55:37,307 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 21b3fff1
2025-03-02 23:55:37,307 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 23:55:37,307 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 23:55:37,308 - services.translation_routes - INFO - [translation_routes.py:97] - Request 21b3fff1: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi8chkb7o.wav
2025-03-02 23:55:37,310 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 48.76 seconds
2025-03-02 23:55:37,310 - services.translation_routes - INFO - [translation_routes.py:112] - Request 21b3fff1: Beginning audio processing with diagnostics
2025-03-02 23:55:37,310 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi8chkb7o.wav
2025-03-02 23:55:37,311 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:55:37,315 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 780191]), Frequency: 16000Hz
2025-03-02 23:55:37,375 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:55:37,395 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:55:37,395 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for heb
2025-03-02 23:55:37,395 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for heb, using defaults
2025-03-02 23:55:37,467 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:55:37,556 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:37,559 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:37,578 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:37,579 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:37,598 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:37,598 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:37,617 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:37,617 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:39,023 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: heb
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 21b3fff1
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: heb
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: heb

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.060
- Crest Factor: 15.741
- Zero Crossings: 288458.000
- Silence Percentage: 46.391
- Clipping Points: 0.000
- Dynamic Range: 7076308.384

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.058
  - Temporal Flatness: 0.025

- Volume Metrics:
  - Volume Stability: -0.453
  - Volume Range: 29967057.705
  - Volume Variations: 0.050

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0076684026082603
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled
2025-03-02 23:55:39,023 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-02 23:55:39,023 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmpi8chkb7o.wav
2025-03-02 23:55:39,024 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:55:39,026 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 780191]), Frequency: 16000Hz
2025-03-02 23:55:39,063 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:55:39,076 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:55:39,077 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for heb
2025-03-02 23:55:39,077 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for heb, using defaults
2025-03-02 23:55:39,127 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:55:39,205 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:39,206 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:39,223 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:39,223 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:39,241 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:39,241 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:39,258 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:55:39,259 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:55:40,629 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: heb
2025-03-02 23:55:40,631 - services.translation_routes - INFO - [translation_routes.py:153] - Request 21b3fff1: Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:55:40,631 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.1656742750252733)
2025-03-02 23:55:40,631 - services.translation_routes - INFO - [translation_routes.py:165] - Request 21b3fff1: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.1656742750252733}}}
2025-03-02 23:55:40,631 - services.translation_routes - INFO - [translation_routes.py:167] - Request 21b3fff1: Audio processed successfully
2025-03-02 23:55:40,674 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-02 23:56:10,630 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: "I'm an Australian and I'm American, and today we're going to compare what we say: a boot, a trunk, a trousers, a sweater, a bottle of liquor, a rubber band, a dummy, a handkerchief, a napkin, a Soviet, a sidewalk, a walkway, a footpath."
2025-03-02 23:56:40,203 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: אני אוסטרלייה ואני אמריקאי היום אנחנו הולכים להשוות איך אנחנו אומרים זה עובד, מגפיים, גולגולת, ג'יס-טרינג, סוכריות, ממתק, דובדבן, כרית, מטען, סיגנל, משאית, צעיף, שטיח, רצועה, נתיב רגל.
2025-03-02 23:56:40,203 - services.translation_routes - ERROR - [translation_routes.py:282] - Translation error: `tgt_lang=heb` is not supported by this model.
                    Please specify a `tgt_lang` in arb,ben,cat,ces,cmn,cym,dan,deu,eng,est,fin,fra,hin,ind,ita,jpn,kan,kor,mlt,nld,pes,pol,por,ron,rus,slk,spa,swe,swh,tam,tel,tgl,tha,tur,ukr,urd,uzn,vie. Note that SeamlessM4Tv2 supports
                    more languages for text translation than for speech synthesis.
2025-03-02 23:56:40,203 - services.translation_routes - INFO - [translation_routes.py:375] - Request 21b3fff1 completed in 62.90s
2025-03-02 23:56:40,205 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 62.90s, Memory Change: 946.70MB
2025-03-02 23:56:40,205 - __main__ - INFO - [app.py:279] - Request to /translate took 103.65s
2025-03-02 23:58:03,432 - services.model_manager - INFO - [model_manager.py:52] - Starting enhanced model verification
2025-03-02 23:58:03,436 - services.model_manager - INFO - [model_manager.py:63] - Testing clean_speech
2025-03-02 23:58:22,637 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified clean_speech
2025-03-02 23:58:22,637 - services.model_manager - INFO - [model_manager.py:63] - Testing speech_with_music
2025-03-02 23:58:40,600 - services.model_manager - INFO - [model_manager.py:108] - Successfully verified speech_with_music
2025-03-02 23:58:40,600 - services.model_manager - INFO - [model_manager.py:110] - Model verification successful
2025-03-02 23:58:40,604 - services.translation_routes - INFO - [translation_routes.py:36] - Starting translation request 62006f22
2025-03-02 23:58:40,604 - services.diagnostics.spectral_analysis - INFO - [spectral_analysis.py:59] - Initialized SpectralAnalyzer with sample rate: 16000Hz
2025-03-02 23:58:40,605 - services.diagnostics.base - INFO - [base.py:75] - AudioDiagnostics initialized successfully
2025-03-02 23:58:40,606 - services.translation_routes - INFO - [translation_routes.py:97] - Request 62006f22: Saved input file: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8wxy4pd2.wav
2025-03-02 23:58:40,606 - services.audio_processor - INFO - [audio_processor.py:136] - Audio duration: 48.76 seconds
2025-03-02 23:58:40,606 - services.translation_routes - INFO - [translation_routes.py:112] - Request 62006f22: Beginning audio processing with diagnostics
2025-03-02 23:58:40,606 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8wxy4pd2.wav
2025-03-02 23:58:40,606 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:58:40,609 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 780191]), Frequency: 16000Hz
2025-03-02 23:58:40,654 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:58:40,666 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:58:40,666 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for rus
2025-03-02 23:58:40,666 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for rus, using defaults
2025-03-02 23:58:40,729 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:58:40,808 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:40,808 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:40,826 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:40,826 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:40,842 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:40,843 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:40,862 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:40,863 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:42,229 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: rus
2025-03-02 23:58:42,229 - services.translation_routes - INFO - [translation_routes.py:123] - 
==================================================
2025-03-02 23:58:42,229 - services.translation_routes - INFO - [translation_routes.py:124] - Input Audio Quality Report
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:125] - ==================================================
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:126] - Request ID: 62006f22
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:127] - Target Language: rus
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:128] - --------------------------------------------------
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:129] - Audio Quality Analysis Report
==============================

Target Language: rus

Waveform Analysis:
--------------------
- Peak Amplitude: 0.950
- Avg Amplitude: 0.026
- Rms Level: 0.060
- Crest Factor: 15.741
- Zero Crossings: 288458.000
- Silence Percentage: 46.391
- Clipping Points: 0.000
- Dynamic Range: 7076308.384

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.000
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.058
  - Temporal Flatness: 0.025

- Volume Metrics:
  - Volume Stability: -0.453
  - Volume Range: 29967057.705
  - Volume Variations: 0.050

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0076684026082603
- Background Noise: 5.0
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled
2025-03-02 23:58:42,230 - services.translation_routes - INFO - [translation_routes.py:130] - ==================================================

2025-03-02 23:58:42,230 - services.audio_processor - INFO - [audio_processor.py:280] - Loading audio from: /var/folders/x2/xbbstcms7ng3g13w2py4kwsc0000gn/T/tmp8wxy4pd2.wav
2025-03-02 23:58:42,230 - services.audio_processor - INFO - [audio_processor.py:282] - Audio info - Sample rate: 16000, Channels: 1
2025-03-02 23:58:42,232 - services.audio_processor - INFO - [audio_processor.py:291] - Original audio shape: torch.Size([1, 780191]), Frequency: 16000Hz
2025-03-02 23:58:42,279 - services.audio_processor - INFO - [audio_processor.py:449] - Base audio processing successful, proceeding with enhancement
2025-03-02 23:58:42,294 - services.audio_processor - INFO - [audio_processor.py:457] - Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:58:42,294 - services.audio_processor - INFO - [audio_processor.py:460] - Applying speech-optimized spectral enhancement for rus
2025-03-02 23:58:42,294 - services.audio_processor - WARNING - [audio_processor.py:365] - No specific parameters for rus, using defaults
2025-03-02 23:58:42,378 - services.audio_processor - INFO - [audio_processor.py:470] - Analyzing audio quality...
2025-03-02 23:58:42,459 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:42,460 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:42,476 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:42,477 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:42,498 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:42,499 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:42,517 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-02 23:58:42,517 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-02 23:58:43,892 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: rus
2025-03-02 23:58:43,894 - services.translation_routes - INFO - [translation_routes.py:153] - Request 62006f22: Background music analysis: {'has_background_music': False, 'music_confidence': 0.1656742750252733, 'feature_scores': {'spectral_flatness': 0.08825745743067673, 'rhythm_regularity': 0.02407894736842105, 'bass_presence': 0.0012133395501335899, 'temporal_stability': 0.05212453067604194}, 'speech_vs_music': {'speech_prominence': 169.38968857735097, 'speech_band_energy': 5.400754332640645e-08, 'music_band_energy': 2.1883607426165241e-10}}
2025-03-02 23:58:43,894 - services.translation_strategy - INFO - [translation_strategy.py:23] - Content Type: speech_with_music (Music confidence: 0.1656742750252733)
2025-03-02 23:58:43,894 - services.translation_routes - INFO - [translation_routes.py:165] - Request 62006f22: Audio characteristics heard: {'content_type': 'speech_with_music', 'heard_characteristics': {'music': {'detected': False, 'confidence': 0.1656742750252733}}}
2025-03-02 23:58:43,894 - services.translation_routes - INFO - [translation_routes.py:167] - Request 62006f22: Audio processed successfully
2025-03-02 23:58:43,934 - services.translation_routes - INFO - [translation_routes.py:184] - Input keys: dict_keys(['input_features', 'attention_mask'])
2025-03-02 23:59:14,045 - services.translation_routes - INFO - [translation_routes.py:223] - Source text: "I'm an Australian and I'm American, and today we're going to compare what we say: a boot, a trunk, a trousers, a sweater, a bottle of liquor, a rubber band, a dummy, a handkerchief, a napkin, a Soviet, a sidewalk, a walkway, a footpath."
2025-03-02 23:59:45,986 - services.translation_routes - INFO - [translation_routes.py:243] - Target text: "Я австралиец и я американец, и сегодня мы будем сравнивать, как мы говорим ""работает"": ботинки, трусы, флип-флопс, джинсы, конфеты, бутерброд, бутылка, резинка, марионетка, креветка, коляска, ножница, тротуар, пешеходная дорожка."
2025-03-03 00:00:28,646 - services.translation_routes - INFO - [translation_routes.py:267] - Processing tuple output from model
2025-03-03 00:00:28,676 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-03 00:00:28,676 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-03 00:00:28,688 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-03 00:00:28,688 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-03 00:00:28,698 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-03 00:00:28,698 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-03 00:00:28,707 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:363] - Visualization failed: module 'collections' has no attribute 'Iterable'
2025-03-03 00:00:28,708 - services.diagnostics.spectral_analysis - ERROR - [spectral_analysis.py:764] - Harmonic analysis failed: mean(): could not infer output dtype. Input dtype must be either a floating point or complex dtype. Got: Long
2025-03-03 00:00:29,008 - services.diagnostics.base - WARNING - [base.py:117] - No analyzer available for language: rus
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:294] - 
==================================================
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:295] - Translated Audio Quality Report
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:296] - ==================================================
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:297] - Request ID: 62006f22
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:298] - Target Language: rus
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:299] - --------------------------------------------------
2025-03-03 00:00:29,008 - services.translation_routes - INFO - [translation_routes.py:300] - Audio Quality Analysis Report
==============================

Target Language: rus

Waveform Analysis:
--------------------
- Peak Amplitude: 0.737
- Avg Amplitude: 0.059
- Rms Level: 0.099
- Crest Factor: 7.458
- Zero Crossings: 27201.000
- Silence Percentage: 16.753
- Clipping Points: 0.000
- Dynamic Range: 387.538

- Processing Metrics:
  - Compression Detected: 0.000
  - Over Compressed: 0.000
  - Compression Severity: 0.068
  - Dynamic Range Loss: 0.000

- Temporal Metrics:
  - Smoothing Detected: 1.000
  - Temporal Variation: 0.030
  - Temporal Flatness: 0.015

- Volume Metrics:
  - Volume Stability: 0.195
  - Volume Range: 1214.927
  - Volume Variations: 0.062

Spectral Analysis:
--------------------

Quality Metrics (1-5 scale):
--------------------
- Robotic Voice: 1.0
- Pronunciation: 1.0
- Audio Clarity: 3.0265099060463463
- Background Noise: 3.983323990241279
- Voice Consistency: 1.0
- Spectral Balance: 1.0

Detected Issues:
--------------------
- Muffled
2025-03-03 00:00:29,009 - services.translation_routes - INFO - [translation_routes.py:301] - ==================================================

2025-03-03 00:00:29,009 - services.translation_routes - INFO - [translation_routes.py:307] - Request 62006f22: Audio output processed successfully
2025-03-03 00:00:29,016 - services.translation_routes - INFO - [translation_routes.py:362] - Request 62006f22: Response prepared successfully
2025-03-03 00:00:29,016 - services.translation_routes - INFO - [translation_routes.py:375] - Request 62006f22 completed in 108.41s
2025-03-03 00:00:29,017 - services.utils - INFO - [utils.py:57] - Performance - Function: translate_audio_endpoint, Duration: 108.41s, Memory Change: 6747.86MB
2025-03-03 00:00:29,017 - __main__ - INFO - [app.py:279] - Request to /translate took 145.59s
